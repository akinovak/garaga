#[cfg(test)]
mod msm_tests {
    use garaga::ec_ops::{G1Point, FunctionFelt, u384, msm_g1};


    #[test]
    fn test_msm_BN254_1_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x12f18b13c59e6ad417ebd645,
                    limb1: 0x650a41fa7ba6adbed5fd894,
                    limb2: 0x603eecccdb9ace4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x79000dc201007acdf5da0923,
                    limb1: 0xf2df6f18768a80289f0797fc,
                    limb2: 0xef06a15f9b33fed,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x16408169a38d8afcfdd2ed7af97ccc57, high: 0xcacb12415ace7a1ceca2ee310da8a95
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xbbb94b0e7be6b97da862b2c8,
                limb1: 0xa5729d70894a8c134a5f6ea3,
                limb2: 0x2a7e6c63c551ae14,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xe4370e7ee3600f320963b8ef,
                limb1: 0xaeecdb33da18d05f00452a6e,
                limb2: 0x2329bc3e7dbbe245,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xa5ae11b3889d1b543e1b9c55,
                limb1: 0xe173d05dd4a8bc1edfc703f,
                limb2: 0x223e25bf4655a695,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x24e14ac3db62a75c76ee1887,
                limb1: 0x973bce308bb7c5ac44db2ecf,
                limb2: 0x1036a941458bf4fd,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x29bce4a18a0a0c0484b18513,
                limb1: 0x471fd77d1d5ed8a9589089a2,
                limb2: 0x1623ff73ebe44dc7,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x394a86bba3b898768c2f7f0f,
                limb1: 0x38b0dc08af917edd7e49b604,
                limb2: 0x2b96bd082f67a8a0,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x7470c0ce4d15320c408b617f,
                    limb1: 0x9692d38aa2e5f7b4d40d606,
                    limb2: 0x43d88bf5a945584,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6cda0b89bd865f2a07b7e4ca,
                    limb1: 0xb85045b68181585d89a246d2,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x8c6375ca8a259536f35980d,
                    limb1: 0xd15523ad1eac685b6ed24151,
                    limb2: 0x1078c9e22f7ba64,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x238bef836bbf3dbf0ab7181,
                    limb1: 0xc4dd49dcd1fdb9cbf7438deb,
                    limb2: 0x304641b52f57e55a,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x65e18d2b798bd3a3468c7d7f,
                    limb1: 0xa456ed6d533a94c0bda1d79d,
                    limb2: 0x1e0414ea1fdcb9f1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb42b4caec4b9318e0763d0d5,
                    limb1: 0x13f8f59768f928d330e7c4a7,
                    limb2: 0x23b79c898721e00f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe3cfaa840da73d8c740fe7b9,
                    limb1: 0x7b33e8024b6a9d9dbd6ebd01,
                    limb2: 0x167cf9d021eb6b9f,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x1a52a615f9e70bfa4da0c827,
                    limb1: 0x73ff6b075c0539124c76c3f3,
                    limb2: 0x316a5da68e72f2e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x35c6a7ce2bf2c366210859f5,
                    limb1: 0xddf7522972f67ca8b6c7d49e,
                    limb2: 0x300a2839cba46fbc,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x8c6375ca8a259536f35980d,
                    limb1: 0xd15523ad1eac685b6ed24151,
                    limb2: 0x1078c9e22f7ba64,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x238bef836bbf3dbf0ab7181,
                    limb1: 0xc4dd49dcd1fdb9cbf7438deb,
                    limb2: 0x304641b52f57e55a,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x2cf38f9cc6ca807471a6b738,
                    limb1: 0x59ce31c86ef595ecccc32ce6,
                    limb2: 0x211b29ce6aac9d83,
                    limb3: 0x0
                },
                u384 { limb0: 0xc4d2cbfff15b4c6fe8e8f8fb, limb1: 0x6081323, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x5e5e6a15d3dce3562aaa731e,
                    limb1: 0x736e6c88c753c33fac476b05,
                    limb2: 0xa8ade7b9dfade07,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xafd22dc5ede505ee82758aad,
                    limb1: 0xa3e86490fc7c61bfbc2521bd,
                    limb2: 0x82239e6cd224cb0,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xd9f9857df87d0dea56c4f47,
                    limb1: 0xf1df10ad6f24cbbe7787c682,
                    limb2: 0x125fd0018219e9bd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe17261d1a5c9c1a22114e5e4,
                    limb1: 0x1c9509faeecfe8e6e88e71d4,
                    limb2: 0x20b4c7dba0e90b76,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7db4f3480415dad4363f926,
                    limb1: 0xe2944181d15dd14e9e8f6c77,
                    limb2: 0x204e71d8ede8d755,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x1b1b3e417b96aa027fff595a,
                    limb1: 0x5a4b459a55fb49bf04d64110,
                    limb2: 0x1fa09b72d9f09a16,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf768951c9af11cb8760a007,
                    limb1: 0xebb92db2f575253f346f6539,
                    limb2: 0x1866adb46766e611,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x5e5e6a15d3dce3562aaa731e,
                    limb1: 0x736e6c88c753c33fac476b05,
                    limb2: 0xa8ade7b9dfade07,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xafd22dc5ede505ee82758aad,
                    limb1: 0xa3e86490fc7c61bfbc2521bd,
                    limb2: 0x82239e6cd224cb0,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xa35f814369e77a013973c567,
                    limb1: 0x8ed5841f2428f4d46ff2ad77,
                    limb2: 0x197cee3ba99f32e4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8bbd8e60fc1a1859e888a509,
                    limb1: 0xdc2822db40c0ac2e47c7fadc,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xba1922f60bb919514e80ec98,
                    limb1: 0x7a83596657ce1a33c01f6c2d,
                    limb2: 0x203f17ecc30fe860,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1789ec56599f0d4ee2cd926,
                    limb1: 0x1b6976ea08594c4fe875db41,
                    limb2: 0x286677b290294bf7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xb9c1e1a9cf8ca486468a7b,
                    limb1: 0x1319d526182203311f273cdc,
                    limb2: 0xf354af6c1f4ad31,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x74a0e6cee0eab9a7d7838114,
                    limb1: 0x47a007b2e5817af48f688d9e,
                    limb2: 0xfa87252f32a5d4b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x42ffc167ffd4321ec310a32d,
                    limb1: 0xceb89ab7151d0bcaa3f3a7d0,
                    limb2: 0x2e5e85c1251ae655,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xc5d99e54e70abfdd1305c881,
                    limb1: 0xb739c67c85e8f63da8dcd9f7,
                    limb2: 0x3058f95367fe18f7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x33864735b88cba51198c90e4,
                    limb1: 0xe19bd951160934348a5ebca0,
                    limb2: 0x186aca31ee18a391,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xba1922f60bb919514e80ec98,
                    limb1: 0x7a83596657ce1a33c01f6c2d,
                    limb2: 0x203f17ecc30fe860,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1789ec56599f0d4ee2cd926,
                    limb1: 0x1b6976ea08594c4fe875db41,
                    limb2: 0x286677b290294bf7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xd35adad811210b46566018e2,
            limb1: 0x4de145a8f21d3c941c7961f1,
            limb2: 0x17f7895fa27d11f8,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x14b80ef5fdb2934cd479e613,
                limb1: 0x6d839ce259e10392cff44fbc,
                limb2: 0x6fff4128505533f,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xbcc106643c44fda387bd0a94,
                    limb1: 0x488e12b7b8bea1a4b3071682,
                    limb2: 0x240a30ba4c01d04b,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x677788094626fe243931463c,
                    limb1: 0xf9f4245260e1d1f1932f5322,
                    limb2: 0xda536fb79a3ac5f,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_2_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x9798507c0098c86b8659aebf,
                    limb1: 0xc35ab1f45e371709ded66a5a,
                    limb2: 0x273f80d72028a868,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4ecac98c68cb91ccd2af021e,
                    limb1: 0x711183dfbff08da90adc628d,
                    limb2: 0xe74c54173eefd03,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x9798507c0098c86b8659aebf,
                    limb1: 0xc35ab1f45e371709ded66a5a,
                    limb2: 0x273f80d72028a868,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4ecac98c68cb91ccd2af021e,
                    limb1: 0x711183dfbff08da90adc628d,
                    limb2: 0xe74c54173eefd03,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xeb8f205672d3cc5d4a31b24384dd6da6, high: 0x2db8d57d95bb440dc9cd4af97d161f29
            },
            u256 {
                low: 0x2aa50f4ec6f0093395d1805142cb6d1d, high: 0x75c5cf95bc7fdeb31234efe6e648043
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xe0558d2eeed014439ad6f3c8,
                limb1: 0x6584fb6a2effc59307717024,
                limb2: 0x6f515f7b5918e26,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x566b081dd9268cccbfa47fd5,
                limb1: 0xbc64132159706ddabe2eb7ae,
                limb2: 0x188a6ad7aaae326a,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x12e17bb2cdb435be2fe7f8bc,
                limb1: 0xf385229b3aa37fd8363dcd3c,
                limb2: 0x209dc45c666ebeda,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xe0c7bb2b031864ac64d93b09,
                limb1: 0x1895604623247698c098a97,
                limb2: 0x207cce546cc1faba,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xe48f58fcf50deba565c4c8e4,
                limb1: 0xb8c6f9b45febfb90d727a97,
                limb2: 0x72fbd924020c130,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x253633dda1e0052d4984f2c8,
                limb1: 0x66165453038fd8a3cc5287a,
                limb2: 0x8bd27e8aec69dac,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x7b2d4170c363f0581aa73789,
                    limb1: 0x42aa3b4ec9aa286da214954f,
                    limb2: 0x1ddcbe111e1e9502,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2859445cdf540decaa215e2,
                    limb1: 0xb85045b68181585d1b2504dd,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xe16a2693a94179572bd8bcf5,
                    limb1: 0x3cbcc36452af8e0a343a2a55,
                    limb2: 0x15eca898bb7a07be,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf083ece24cb7af67b74c5ac0,
                    limb1: 0x8f709857f44a7bc0b1399011,
                    limb2: 0x22fb7a40b77699a,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xa9fa2b4b43c031e74fd4b3b1,
                    limb1: 0xdeffb17e5abc2463b19845fd,
                    limb2: 0x102f01910ed2bd04,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x155e9f9e1bebf0a6af5cb9ac,
                    limb1: 0xa8ab5c2a10370a6f6bd077c2,
                    limb2: 0x1812254fac862878,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb9952afc3a350e7fc00caad6,
                    limb1: 0x690cf4356e37f9a6938786be,
                    limb2: 0x1f58dc79af1900ad,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x3bcca92dbfa3dfeeab0d3998,
                    limb1: 0xfde60476768d51c1052d1470,
                    limb2: 0x1161ab57513c7710,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd18bc6a6e6270e3725e51040,
                    limb1: 0xae51c907dcdf734213acb035,
                    limb2: 0x68f26ec22663ccf,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xe16a2693a94179572bd8bcf5,
                    limb1: 0x3cbcc36452af8e0a343a2a55,
                    limb2: 0x15eca898bb7a07be,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf083ece24cb7af67b74c5ac0,
                    limb1: 0x8f709857f44a7bc0b1399011,
                    limb2: 0x22fb7a40b77699a,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x520c2af4abb05f5e5d843830,
                    limb1: 0xaeb91da3fdf63257179f6daf,
                    limb2: 0x1daac40432b5755c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb4a5b17fe0bc380b79f82e6e,
                    limb1: 0xdc2822db40c0ac2ec1a53048,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xdf295794c4470fe9f17e3e0f,
                    limb1: 0x15f9ec54d1535a45438dd41f,
                    limb2: 0x2364af43f2160dd0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2669c8eba9f41a03fab85313,
                    limb1: 0xb9c0b6dd6a2819d919ee9d8c,
                    limb2: 0x18eb57b23bcbd90f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xf41482657ef04ba74dedd056,
                    limb1: 0xc4cb1ef6af4951e334a741d9,
                    limb2: 0x290f3e62aad9bc12,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9f1c1306678b7563ab2098c9,
                    limb1: 0xd8cfdfa5f59c6f97823fa21e,
                    limb2: 0x2afa930e5fea42fa,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2d79eb2c177d0c52114bcd54,
                    limb1: 0x1eccef41a8af3e586e078f14,
                    limb2: 0x2f7cb3e987585852,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xcc9871a3d49417902380bf9f,
                    limb1: 0xd14d399170f75e149ba6a73c,
                    limb2: 0x96570e613dee91c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xacb9035c1bbc1f517abfbf2,
                    limb1: 0x74f1dee1bcf6f52db64a6e13,
                    limb2: 0x1a5db8a3d231eb05,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xdf295794c4470fe9f17e3e0f,
                    limb1: 0x15f9ec54d1535a45438dd41f,
                    limb2: 0x2364af43f2160dd0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2669c8eba9f41a03fab85313,
                    limb1: 0xb9c0b6dd6a2819d919ee9d8c,
                    limb2: 0x18eb57b23bcbd90f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x5f8023c1a5342d6eb861c450,
                    limb1: 0x7230dc552ccf386eadbbc02,
                    limb2: 0x16c9522ab4ede8e9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8bbd8e60fc1a1859e888a509,
                    limb1: 0xdc2822db40c0ac2e47c7fadc,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x4000cf7e4b85b1fb7633cf6a,
                    limb1: 0xde0c8e09423f9f8db1b73b08,
                    limb2: 0x184207339fe8c572,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7100f5dd795e6ab342d03ba7,
                    limb1: 0xb93eb38000df18cc53d122bd,
                    limb2: 0x896cc843aa2201e,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x4abb1c71cefc5f725138db56,
                    limb1: 0xe5e902f85169d06fe699d0fe,
                    limb2: 0x27f64394724939fd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x66b5150767fdf0f52a1aae9f,
                    limb1: 0xeb2a300d4ec1c1546c3685b2,
                    limb2: 0x29a97ff3c936100f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5962da94fd7f7808da0da0a,
                    limb1: 0x6b31b55d4bf6fa0a778bc4c2,
                    limb2: 0x1813f22e827e970e,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x5790a3eda67089db8a1e70f7,
                    limb1: 0xe1d56465453d864b7da44687,
                    limb2: 0x1861c727fe88b02e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5302e1986c1b4019c870b2f5,
                    limb1: 0x2bbc1a80029d4a64fb736838,
                    limb2: 0x19c4658cafe6605c,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x4000cf7e4b85b1fb7633cf6a,
                    limb1: 0xde0c8e09423f9f8db1b73b08,
                    limb2: 0x184207339fe8c572,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7100f5dd795e6ab342d03ba7,
                    limb1: 0xb93eb38000df18cc53d122bd,
                    limb2: 0x896cc843aa2201e,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xd8d93eb26cef3969b973654f,
            limb1: 0x2a82d1c7bfacd6b5e1ee7a26,
            limb2: 0xb391f8c4046f22d,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xf86bb08179c7d00c59c00161,
                    limb1: 0x909f4485300079806c64dd4,
                    limb2: 0x69e3543a41bbd16,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x92449c5cd119e63b82a3a7af,
                    limb1: 0xda8b1d2cd739bc16dcafb662,
                    limb2: 0x251948f1d7cf2a75,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_3_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x7f65b786b2230c9010e5f5ff,
                    limb1: 0x9abab1f3d8c6eb645449de5,
                    limb2: 0x2ece0df5dde6e6db,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb159fc2aa3b70abb5fd5d279,
                    limb1: 0x4a52ef447301db2079ea4d15,
                    limb2: 0x8017030f16878f7,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x7f65b786b2230c9010e5f5ff,
                    limb1: 0x9abab1f3d8c6eb645449de5,
                    limb2: 0x2ece0df5dde6e6db,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb159fc2aa3b70abb5fd5d279,
                    limb1: 0x4a52ef447301db2079ea4d15,
                    limb2: 0x8017030f16878f7,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x7f65b786b2230c9010e5f5ff,
                    limb1: 0x9abab1f3d8c6eb645449de5,
                    limb2: 0x2ece0df5dde6e6db,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb159fc2aa3b70abb5fd5d279,
                    limb1: 0x4a52ef447301db2079ea4d15,
                    limb2: 0x8017030f16878f7,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x33a1d1c2ad4ab155c09fcd8f739cd488, high: 0x106a29b865e049937f411fed1e70e799
            },
            u256 {
                low: 0xff3e0ba10ac728b4a41865bf350d278d, high: 0x27e608623744da64cc249558f2ad985f
            },
            u256 {
                low: 0x98a33736fd1ac7ce1ad0a6f226bdd974, high: 0x2417014e25fdacbe7ce71b48fba52e59
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x20bb7e72b86a2b376996ec30,
                limb1: 0xda53fa80e63c5dc32514c846,
                limb2: 0x300457c82a6bcb86,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x2bd34fe09867f22dbd3c2d8b,
                limb1: 0x79c81e15187be43dee584f5f,
                limb2: 0x21be36429bcc5b0,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x4beb43b19f2ee8dd7f945740,
                limb1: 0x9d37bbd5d79905c416dd1dbd,
                limb2: 0x7831f766e682478,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x4c3d025dff9af998189c1d29,
                limb1: 0x5cd531c08768705215cc2783,
                limb2: 0x42c95194641bb1f,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x2a9faf6a3307b3d7b496a9bf,
                limb1: 0x2bfe1295a5a6905f65ce2ba1,
                limb2: 0x7996ce5854bda38,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x37c432659114f9effe78b3ce,
                limb1: 0x5582864586b354f2129a0c8b,
                limb2: 0x64e9de3cf4bad12,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xa15628bad19b0e0b8df4dc1,
                    limb1: 0xebc86d8569a6a3ef87cae568,
                    limb2: 0xca61d93a6369f69,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7b85f0c44c507cc1d9831cba,
                    limb1: 0xb85045b68181585d28b1e434,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xc8475f41e837225f191c19ff,
                    limb1: 0x685b4405320f055fcce5ac9b,
                    limb2: 0x2b25cc527b9a6f2f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x30c25f210db3e066367d185f,
                    limb1: 0x8ca0e5ccdf39e441c4a96ef7,
                    limb2: 0x1f63727ba108df1,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xc6c4bb4f9a1b475278cf2274,
                    limb1: 0xd20042e6e35d596e703eaf2a,
                    limb2: 0x2eb4d89745957350,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xefbb9980ede5bc744875641a,
                    limb1: 0xc868ebeb9851c541c0f0f650,
                    limb2: 0x1e824afe1f485a3f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x79710ccb936a7b7ebee5e7ec,
                    limb1: 0x1e68fbec75f2fac76c498c9a,
                    limb2: 0x154c3e192834ac37,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x87f288ab40644eef9a5a536f,
                    limb1: 0xc87140a2932a5f6437ae30b0,
                    limb2: 0x20a8c811b06c0d3a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x92471d63291ba132a377491d,
                    limb1: 0xa5e2b1669dadacc54dfc4ce5,
                    limb2: 0x5e2a5772e31a9d4,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xc8475f41e837225f191c19ff,
                    limb1: 0x685b4405320f055fcce5ac9b,
                    limb2: 0x2b25cc527b9a6f2f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x30c25f210db3e066367d185f,
                    limb1: 0x8ca0e5ccdf39e441c4a96ef7,
                    limb2: 0x1f63727ba108df1,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xfa63b257b1f0d41985237329,
                    limb1: 0xbc1545e7006c3ebee18bd6d6,
                    limb2: 0x13fb2ad40ad4f134,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1a9f69da9b9169b25647b718,
                    limb1: 0xb85045b68181585d75a7ba30,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xeb32eb48b8e985770b6ccd4b,
                    limb1: 0xf599abd5cd51d7ec4a537f43,
                    limb2: 0x2192b154bc0147ab,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x59299e226ef22c0207fad4f,
                    limb1: 0xc9bd2477eddd3c40d2e11980,
                    limb2: 0x2a776f79761434ff,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x8a469c7667df1cb2b997d889,
                    limb1: 0xf5f66fc03a84add9ec7db91f,
                    limb2: 0x1aa7a7f9e70c0eb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xac8fdf1bb17a96f5e3ddc00c,
                    limb1: 0xb6e6df309f7af668d59c4ebc,
                    limb2: 0x13bb156b47d1d7e6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdc9f587a83ba0a1790ec03ca,
                    limb1: 0xa195f739b2903421e99267c6,
                    limb2: 0x2d86f81f0e5dadf7,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xf0b52cbfb27b7837714c6d53,
                    limb1: 0x702c781464f2d709aff7a8a8,
                    limb2: 0x3ef771871a096b0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3fd4388bfc8c5012b0850d5f,
                    limb1: 0xec96e1fac695040749a0775d,
                    limb2: 0x1e9db1869fd95eab,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xeb32eb48b8e985770b6ccd4b,
                    limb1: 0xf599abd5cd51d7ec4a537f43,
                    limb2: 0x2192b154bc0147ab,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x59299e226ef22c0207fad4f,
                    limb1: 0xc9bd2477eddd3c40d2e11980,
                    limb2: 0x2a776f79761434ff,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xd0afb09d675152624d15b98c,
                    limb1: 0x5f43a36789cdbfadd9c7424f,
                    limb2: 0x20967c8b5e816b34,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8bbd8e60fc1a1859e888a509,
                    limb1: 0xdc2822db40c0ac2e47c7fadc,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x45c9b13ff1fdb275ae9da90e,
                    limb1: 0x4ebabe250b5dfd3e47bdf3c1,
                    limb2: 0xce0d9c5e3174700,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf1e6d77169e9ef61a451fc48,
                    limb1: 0xef1a774b0441c23a1ad62132,
                    limb2: 0x2147c216ed7da178,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xcaca30c893780eec5e641497,
                    limb1: 0xfd43d49ba971e694d01260b9,
                    limb2: 0x171f21b43492bf40,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfd5c447ab678326367de17d1,
                    limb1: 0x2e9feabe12e0384201622efb,
                    limb2: 0x227454936b181da7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x34027ba4f17499c30ac4dcc8,
                    limb1: 0x185c798f4caa98a53fa1deec,
                    limb2: 0x171b24ad4e1fd2a,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xd15d13bfd5f917610bd8fb2a,
                    limb1: 0xec303a6f2219f7bad739db43,
                    limb2: 0x26a28d51a945d500,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4d0f139c57cb5f73bfbfa4a,
                    limb1: 0x5caeda7409c295f3217f8e76,
                    limb2: 0x30ea95f0615a417,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x45c9b13ff1fdb275ae9da90e,
                    limb1: 0x4ebabe250b5dfd3e47bdf3c1,
                    limb2: 0xce0d9c5e3174700,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf1e6d77169e9ef61a451fc48,
                    limb1: 0xef1a774b0441c23a1ad62132,
                    limb2: 0x2147c216ed7da178,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xdd0e6a906c69674c5c076d1a,
            limb1: 0x3c6c6fada5396a17fed4ec2b,
            limb2: 0x85b451e4a2e69e3,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xa6e4aca1de306d0728ee495a,
                    limb1: 0x9001bf7b4c954c2dd1bbb515,
                    limb2: 0x17f84c634154f05f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x99995fb0cfb27ecfc93db99b,
                    limb1: 0x1ceedbd6d2159ab43bcbf22f,
                    limb2: 0x2708ad9be3fa891d,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_4_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xaa87ac3a4e3226938b1b118d,
                    limb1: 0xf5c38cbf13bad29eee48016a,
                    limb2: 0x68981dffa5f191c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9b78b00ff95a5e7c86aa3775,
                    limb1: 0xecc953e1075f9f7553a0f579,
                    limb2: 0x1c87e428d0b9cdca,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xaa87ac3a4e3226938b1b118d,
                    limb1: 0xf5c38cbf13bad29eee48016a,
                    limb2: 0x68981dffa5f191c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9b78b00ff95a5e7c86aa3775,
                    limb1: 0xecc953e1075f9f7553a0f579,
                    limb2: 0x1c87e428d0b9cdca,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xaa87ac3a4e3226938b1b118d,
                    limb1: 0xf5c38cbf13bad29eee48016a,
                    limb2: 0x68981dffa5f191c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9b78b00ff95a5e7c86aa3775,
                    limb1: 0xecc953e1075f9f7553a0f579,
                    limb2: 0x1c87e428d0b9cdca,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xaa87ac3a4e3226938b1b118d,
                    limb1: 0xf5c38cbf13bad29eee48016a,
                    limb2: 0x68981dffa5f191c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9b78b00ff95a5e7c86aa3775,
                    limb1: 0xecc953e1075f9f7553a0f579,
                    limb2: 0x1c87e428d0b9cdca,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xd5627386528cc241e345ac72eac39204, high: 0x28a4e6ce7fa74d8aff88ec827f99d273
            },
            u256 {
                low: 0x8af5890333b5b3cedfec4623ab899605, high: 0x9f004f38018399ee6a8e2f9c19ed34
            },
            u256 {
                low: 0xbf3df0bbf66ac168b4a1ca795718ada2, high: 0x1498c76ed17034ce51797350e6256403
            },
            u256 {
                low: 0xdfde228125fb5f3d866d7002091472ad, high: 0x9fa5a78c8bf23fb9a431f7a41c30359
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xa896852c838cf946f53ccc58,
                limb1: 0x7972e64e7c531487ce4a9e4e,
                limb2: 0x16e593781d73841e,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xa353978352d40a8c10dc8d9a,
                limb1: 0x5e956fc2f3a43fb3a4ea9d90,
                limb2: 0x232ba798e391d223,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x21b6b2214db887faaec8af46,
                limb1: 0x4b390f963b9ddd4c67c58c4e,
                limb2: 0xd07ce9e54a26507,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x7ae6303ff692d229303b3a4e,
                limb1: 0xc6de9a72ab6e2ad4e49c1678,
                limb2: 0x2e361b768d435af9,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x402e99dc34355a1479838931,
                limb1: 0x4faf559f9ff71a5a35006559,
                limb2: 0x1e2006163b8b755f,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xe631ebc20d8c1b1659ea54e6,
                limb1: 0x1019444577ebfeaaa3049126,
                limb2: 0xf9ec06edfa36bed,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x9866344f22144abe40e6ae66,
                    limb1: 0xbaf66ddd0038ae9d26129c3a,
                    limb2: 0x17ee436d59e19dc3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd57581598a20084c8a05cb87,
                    limb1: 0xdc2822db40c0ac2d991cfdc0,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x994e9025e09d63064746b841,
                    limb1: 0x9effa3c2abb5b80c5480da28,
                    limb2: 0x1f33c6a3b98a3238,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x155399266a616c3c58251f62,
                    limb1: 0x4919d2a8f1737136daeecad8,
                    limb2: 0x12f5391ac95f02ee,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x3a0b2fe39d793de776bfea4d,
                    limb1: 0xcd066f3bf64989e1249f5b9,
                    limb2: 0xbeb53548bf4f77,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x128c89c80625efb2b9f29db3,
                    limb1: 0xf4f69a7ca7bd64adbd07480e,
                    limb2: 0x1cd2a9c2e5c66cd1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd9fcbb320d73294981b99780,
                    limb1: 0xb31e9503ed2299e7d2886374,
                    limb2: 0x104272167df102d,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x6379e5e465b79cfbfd572b7c,
                    limb1: 0x24aea591819fcfc7660123e8,
                    limb2: 0x2d3705784b6cf680,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd78900e60303b89e2ff260df,
                    limb1: 0x22fd324452d8fb46f94af5f6,
                    limb2: 0x87b5cdd7aeb68a1,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x994e9025e09d63064746b841,
                    limb1: 0x9effa3c2abb5b80c5480da28,
                    limb2: 0x1f33c6a3b98a3238,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x155399266a616c3c58251f62,
                    limb1: 0x4919d2a8f1737136daeecad8,
                    limb2: 0x12f5391ac95f02ee,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xecea493614495bad9785073,
                    limb1: 0x5a93252f2c298ce02a2c6af9,
                    limb2: 0x2c89548cfd35e547,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe20731c8bb71395b67a77e40,
                    limb1: 0xb85045b68181585d78d021e5,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x41ae92ee9ac3a118faaad344,
                    limb1: 0x4d89685555b128aee32bfc3a,
                    limb2: 0x301b6a4fecfba0c1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9c336c31a035dd889e993c74,
                    limb1: 0x7753a9613228a8724173dcd8,
                    limb2: 0x1cd2fdf492302205,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xfd64539cde73f1e6ce3eccca,
                    limb1: 0xff26a5cfc9af7c2a0e15b32d,
                    limb2: 0x20605103e259ed79,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd6ae2feb61df25bb8a4c9194,
                    limb1: 0x9382014a4b1d5d2984484214,
                    limb2: 0x1d376fff27fe72e0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x70d49228cc2ee94b331f6c6c,
                    limb1: 0xaf161fee4a4b275545fae73c,
                    limb2: 0x1dbe1b76604344ea,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xf42823b15809cb1d3f067f3e,
                    limb1: 0x77fbad92fe10c9517a811f8b,
                    limb2: 0x2f89a20a048fa1f0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6c287a07a4810c83034eb815,
                    limb1: 0xadaab66d14f8a0f92cda2bf8,
                    limb2: 0x2614ab6ad55ec5e6,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x41ae92ee9ac3a118faaad344,
                    limb1: 0x4d89685555b128aee32bfc3a,
                    limb2: 0x301b6a4fecfba0c1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9c336c31a035dd889e993c74,
                    limb1: 0x7753a9613228a8724173dcd8,
                    limb2: 0x1cd2fdf492302205,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x7615dbbaa284e0a0537d5106,
                    limb1: 0x9cf6ba564d2a1b077ebbbee4,
                    limb2: 0xae9c7fbf52d2b3d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8bbd8e60fc1a1859e888a509,
                    limb1: 0xdc2822db40c0ac2e47c7fadc,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x732d664baf7106171066bb8d,
                    limb1: 0x8424b981ccf0fd057b307a3e,
                    limb2: 0x170d33f3681fee07,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x68c7e8fba32aa07b030c4d0,
                    limb1: 0x1d67e080a5ec60b6fabb78ea,
                    limb2: 0x53c79be5103c5c3,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xf9ddce276a73b43c78f2835b,
                    limb1: 0xc58382e3f124ea6ae684e1bc,
                    limb2: 0x1854fde2c30f4346,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbe7143a8172e8c49187b12cc,
                    limb1: 0x93b97d2daac538baf4bb0310,
                    limb2: 0x51e24f7c26fdfa6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7b22037a7de5d84603ce78f1,
                    limb1: 0xff44c92f235029de2e35d3be,
                    limb2: 0x831a7b05c434e2e,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xf1166855d232862e58b73560,
                    limb1: 0xd41de6cee5519eb2da100429,
                    limb2: 0x14c34d67572e29ec,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x13a57baf2e97fe1710924e70,
                    limb1: 0x5837a181f1c52224f0326abe,
                    limb2: 0xfb56d3af30b5149,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x732d664baf7106171066bb8d,
                    limb1: 0x8424b981ccf0fd057b307a3e,
                    limb2: 0x170d33f3681fee07,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x68c7e8fba32aa07b030c4d0,
                    limb1: 0x1d67e080a5ec60b6fabb78ea,
                    limb2: 0x53c79be5103c5c3,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x74b758601106aa1ed0f56630,
            limb1: 0x3501b31dfff42fce9c50e3f6,
            limb2: 0x129a78b7c4a4f428,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0xf71856b8a8822697e4346bc5,
                limb1: 0x7246b3d82e057082fbf41349,
                limb2: 0x759c4d0ecb4ed60,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x5cc12ae5c9912a2dad66f61a,
                    limb1: 0x8cf8605fc3494f03db4462a6,
                    limb2: 0x2600d69fd0087532,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x8d54f174215b3312c6accea0,
                    limb1: 0x95544115d888239678f7a613,
                    limb2: 0xe0ba156c2d04f43,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_5_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x23eb9878a562052dd1dd1a67,
                    limb1: 0xd85777c12211fec2e40d11b5,
                    limb2: 0x1530f02b93657791,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2a294240c2c001a45493ec9a,
                    limb1: 0x35b35790ae6d66e7ab4b28e5,
                    limb2: 0x2285216f83f1e0a3,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x23eb9878a562052dd1dd1a67,
                    limb1: 0xd85777c12211fec2e40d11b5,
                    limb2: 0x1530f02b93657791,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2a294240c2c001a45493ec9a,
                    limb1: 0x35b35790ae6d66e7ab4b28e5,
                    limb2: 0x2285216f83f1e0a3,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x23eb9878a562052dd1dd1a67,
                    limb1: 0xd85777c12211fec2e40d11b5,
                    limb2: 0x1530f02b93657791,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2a294240c2c001a45493ec9a,
                    limb1: 0x35b35790ae6d66e7ab4b28e5,
                    limb2: 0x2285216f83f1e0a3,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x23eb9878a562052dd1dd1a67,
                    limb1: 0xd85777c12211fec2e40d11b5,
                    limb2: 0x1530f02b93657791,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2a294240c2c001a45493ec9a,
                    limb1: 0x35b35790ae6d66e7ab4b28e5,
                    limb2: 0x2285216f83f1e0a3,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x23eb9878a562052dd1dd1a67,
                    limb1: 0xd85777c12211fec2e40d11b5,
                    limb2: 0x1530f02b93657791,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2a294240c2c001a45493ec9a,
                    limb1: 0x35b35790ae6d66e7ab4b28e5,
                    limb2: 0x2285216f83f1e0a3,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x843b2a7d15ab2c21ccc93ff710fce97d, high: 0x43f27bb0a1727f7ea5f24b6de6fec4b
            },
            u256 {
                low: 0x4cea2df00a66dc4e21681081399f8a8f, high: 0x1cb5af08d80d6a1cc2472fd603e9ba02
            },
            u256 {
                low: 0xccf719ab2922fbd8dca5b35354a1d505, high: 0x1d7caf08a7f5195cde62d43f261908b9
            },
            u256 {
                low: 0x61d9fe398147a8f45f0ef320f7f60e7f, high: 0x226cc28809f292387a1798fe6addd9e
            },
            u256 {
                low: 0xcb4d18d6adb6da351734a26c92e94e89, high: 0x2668bb2cc202387b849b8a44ce1bb02a
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xdc26be5b5db048e050cf7f3f,
                limb1: 0xf8f39d431427158857c5750c,
                limb2: 0x28c591201d73c22,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x157bb47ab013b6e98555fa2c,
                limb1: 0xaf06ab171aba8bfd74f3f3f0,
                limb2: 0x2a8344f1a41abf6e,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x2251fe784c8be1582a1220ff,
                limb1: 0xa0aef5858453bf931b4b777f,
                limb2: 0x13d65d47e0ce1b44,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xf9167b75cd56cdd37dc27b19,
                limb1: 0xfa15b542092ed650f56d143f,
                limb2: 0x14603d7477ca9e2d,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xea21757f4bfa1248fb7c8580,
                limb1: 0x12c2021885ae913185771cf,
                limb2: 0x1a4999e1447dd3a8,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x27cf4cadc340ace25d85fc53,
                limb1: 0x4dd9bee6032b4543a53cad51,
                limb2: 0x1e350efffd4ec897,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xe0b5b855ecf4438d7ce9586f,
                    limb1: 0xd4dab573c7a4e01ee216b71f,
                    limb2: 0x2971a53d0f849b48,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcea6a5a2f78d92e6a545df6c,
                    limb1: 0xb85045b68181585d3aeb6217,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xcc1f0e97e3bbfd3a0336d6,
                    limb1: 0xdba203274c3a4cb2173ecbfc,
                    limb2: 0x282af85dc5a1ef1d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x685f73b9390e3e08b5d063a1,
                    limb1: 0xe70530b24b4844125baee3cf,
                    limb2: 0x18a705354bf4ec74,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xe28638908f141004ee17acad,
                    limb1: 0xfe352ebf615951b69f37f917,
                    limb2: 0xf9faa2a3731ea0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x39308db63c2b8e07732708ca,
                    limb1: 0xafcc50501abfb2929c5f5d5c,
                    limb2: 0x300ce45882db5727,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf7f9a706ef6f2f3c629c59e9,
                    limb1: 0xfb2486aea8ae911cd8b40953,
                    limb2: 0x2f02aaedf9f3c47d,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x3180c8114f6a1bc9fd0fa9f4,
                    limb1: 0x22457e08e1ac355b16b98ed1,
                    limb2: 0x17b84c338e828d06,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd0ac909e6f0a2e0348f42d9c,
                    limb1: 0xfcbf4c60605773d97b8b40dc,
                    limb2: 0x1990c12d02ad2534,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xcc1f0e97e3bbfd3a0336d6,
                    limb1: 0xdba203274c3a4cb2173ecbfc,
                    limb2: 0x282af85dc5a1ef1d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x685f73b9390e3e08b5d063a1,
                    limb1: 0xe70530b24b4844125baee3cf,
                    limb2: 0x18a705354bf4ec74,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x47d794fa5de91e787121a5cd,
                    limb1: 0x379c54f9087c3a42364961cc,
                    limb2: 0x119d672b25c655ba,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x714a1e5c1e5688dce3be040e,
                    limb1: 0xdc2822db40c0ac2e9971c142,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xaf78ffc1723d273b5552c9e6,
                    limb1: 0x386dbdb3b3cb43985a28de25,
                    limb2: 0xf85f600154577cc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2234339c4a32a590dc8dc1e1,
                    limb1: 0x3f49d86fdb1b9a079828e15d,
                    limb2: 0x75d00ff6cfe0d53,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x9f79e08c42425c1632428511,
                    limb1: 0xfab6861d474607d425f0a7a7,
                    limb2: 0x107461a9138ebe75,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe0eb66c81a9bb45f8853501c,
                    limb1: 0x373c7eb6842734e19d1ba34a,
                    limb2: 0x2d8b54a9fddf3c89,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x68b60e8da470838c6f1a78f1,
                    limb1: 0x835f144828bc86014ceee2c0,
                    limb2: 0x6ef7376bd8b3280,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xe6aff4456b775b1fff85db2,
                    limb1: 0xa949391b1b61cac90e7a9a71,
                    limb2: 0x2e91e2003fd06764,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x669c9ad4de97f0b295a945a3,
                    limb1: 0xbddd894f9152ce16c87aa417,
                    limb2: 0x161702fe46fa27f9,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xaf78ffc1723d273b5552c9e6,
                    limb1: 0x386dbdb3b3cb43985a28de25,
                    limb2: 0xf85f600154577cc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2234339c4a32a590dc8dc1e1,
                    limb1: 0x3f49d86fdb1b9a079828e15d,
                    limb2: 0x75d00ff6cfe0d53,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x203a926d14710c977e7a8355,
                    limb1: 0xa1df9b96eeb3beed09a20b81,
                    limb2: 0x11e4f832b5ee867c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8bbd8e60fc1a1859e888a509,
                    limb1: 0xdc2822db40c0ac2e47c7fadc,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x254fa52915a4bf1a2ba0d3c0,
                    limb1: 0x98709f303f3f1ed520624e64,
                    limb2: 0x96f545e1d2daaa3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5bfe5695a39a9875b2ee56c8,
                    limb1: 0x1675300f74d2afb763de8142,
                    limb2: 0x2445749bbe5b13d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xc45ad6fc59eb563ca03a2395,
                    limb1: 0xb2a6bd722ebb7141fe6f0021,
                    limb2: 0x2bc84809d3ad9cdb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xeb66775b0acec2a2f63c1ee,
                    limb1: 0x21d4ebed0f1810cb23df7aba,
                    limb2: 0x1281771963289491,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xab777735b54220ebdadb27dc,
                    limb1: 0x6359194cec606a49f5e2e69a,
                    limb2: 0x1a8fa94372bf068,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x6feeef7b40ee3d4e82e27b40,
                    limb1: 0xc951dd90bdbd5c7f6126eb2c,
                    limb2: 0x1c4dfd1a5788ffea,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x13fb03c0eacfc96118cb0458,
                    limb1: 0x435f902e5e780f262b9b83c7,
                    limb2: 0x6cd05dd33b113b7,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x254fa52915a4bf1a2ba0d3c0,
                    limb1: 0x98709f303f3f1ed520624e64,
                    limb2: 0x96f545e1d2daaa3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5bfe5695a39a9875b2ee56c8,
                    limb1: 0x1675300f74d2afb763de8142,
                    limb2: 0x2445749bbe5b13d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x5a0b5c7beb369d57ce5cb93b,
            limb1: 0x78ab75b50cf0f8891d3cbae,
            limb2: 0x1790b203ac8a384f,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x70e4e2d68b268c479448978c,
                limb1: 0x6e0283b9a8402dd45f47c092,
                limb2: 0x10b9e4c6905fb417,
                limb3: 0x0
            },
            u384 {
                limb0: 0xe4daf17d6b992638c7ba58a3,
                limb1: 0xe3141d918adfadcd61cb5bfc,
                limb2: 0x179dc0841940c596,
                limb3: 0x0
            },
            u384 {
                limb0: 0xa478e96ffda550ce5ff9d3b7,
                limb1: 0xacf312b064d5c04feb8560ba,
                limb2: 0x133ca8813a7244b1,
                limb3: 0x0
            },
            u384 {
                limb0: 0xf3c5825ef263a1159b14b9b4,
                limb1: 0x19f33ebab0f7e253a42f64c4,
                limb2: 0x76b38b400c3539a,
                limb3: 0x0
            },
            u384 {
                limb0: 0x649e058e6adf74178bfb5d4b,
                limb1: 0x9ab3340ad7754f38bdd05583,
                limb2: 0xe1b11d6a8a48ee4,
                limb3: 0x0
            },
            u384 {
                limb0: 0x1ca103298193711eea3b246d,
                limb1: 0xa7a8955f8bc6f1a9efb06860,
                limb2: 0x5293dc9c3631a73,
                limb3: 0x0
            },
            u384 {
                limb0: 0xdb0212805daf2e4f1fbdbd0c,
                limb1: 0xd67ec6e079371afacc67686,
                limb2: 0x28c2dd3484598e1,
                limb3: 0x0
            },
            u384 {
                limb0: 0x1a246f55239d9a71a1f224a2,
                limb1: 0xbe0a06dc8217dfcd264314c4,
                limb2: 0x63daa086e7b792a,
                limb3: 0x0
            },
            u384 {
                limb0: 0xe2f9b50ea02035d99633097d,
                limb1: 0x6f1ed9116f1d7ac007bdc14c,
                limb2: 0x16ccae350711b8c6,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xa9a86e33e193c90afcd954c5,
                    limb1: 0xc17469c283bacac4e8017a03,
                    limb2: 0x76101c61f045394,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4af96cc320d84601e29104b7,
                    limb1: 0xc6a7bf334b1972d61ec6efa6,
                    limb2: 0x10a1ed23b7b25ae2,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_6_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x921935b69355528c3ab71f2e,
                    limb1: 0x8f0a1ef004d4ee7dbddd3f19,
                    limb2: 0x74a9ec427077e0a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4d83d8e174d1eed793be558f,
                    limb1: 0x8f2c4f82b6073b98295b7f5c,
                    limb2: 0x48fdcbcd7184492,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x921935b69355528c3ab71f2e,
                    limb1: 0x8f0a1ef004d4ee7dbddd3f19,
                    limb2: 0x74a9ec427077e0a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4d83d8e174d1eed793be558f,
                    limb1: 0x8f2c4f82b6073b98295b7f5c,
                    limb2: 0x48fdcbcd7184492,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x921935b69355528c3ab71f2e,
                    limb1: 0x8f0a1ef004d4ee7dbddd3f19,
                    limb2: 0x74a9ec427077e0a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4d83d8e174d1eed793be558f,
                    limb1: 0x8f2c4f82b6073b98295b7f5c,
                    limb2: 0x48fdcbcd7184492,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x921935b69355528c3ab71f2e,
                    limb1: 0x8f0a1ef004d4ee7dbddd3f19,
                    limb2: 0x74a9ec427077e0a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4d83d8e174d1eed793be558f,
                    limb1: 0x8f2c4f82b6073b98295b7f5c,
                    limb2: 0x48fdcbcd7184492,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x921935b69355528c3ab71f2e,
                    limb1: 0x8f0a1ef004d4ee7dbddd3f19,
                    limb2: 0x74a9ec427077e0a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4d83d8e174d1eed793be558f,
                    limb1: 0x8f2c4f82b6073b98295b7f5c,
                    limb2: 0x48fdcbcd7184492,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x921935b69355528c3ab71f2e,
                    limb1: 0x8f0a1ef004d4ee7dbddd3f19,
                    limb2: 0x74a9ec427077e0a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4d83d8e174d1eed793be558f,
                    limb1: 0x8f2c4f82b6073b98295b7f5c,
                    limb2: 0x48fdcbcd7184492,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xe2a01335a83023ab053e4b42cc4da021, high: 0x135b35e02e9583eabda17da2000fc63d
            },
            u256 {
                low: 0x552ae5ca4124405b91fcfe8881c16e98, high: 0x10c4bb38dc2151e17e56ac3d10cc8711
            },
            u256 {
                low: 0xc5c142624d849ec5d334886ff164f9d8, high: 0x188e3428cf5e9ea362584ab368777bab
            },
            u256 {
                low: 0xef7e85eca417956f29ee7f3d0ff030b8, high: 0x2eaf51d1497e9f1a3d2bf042209818d1
            },
            u256 {
                low: 0xf11ddff70e3705265582a3bdd476fe38, high: 0x90495e76af944e07b38785b0932f5b6
            },
            u256 {
                low: 0x9a1a7d6fdd02e100e3d484087de8a234, high: 0x2cb77120ac6d5df814e5064cb799ae8e
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xf252d29ace401e445cc1eb14,
                limb1: 0x3bd2c939e8fe98148cadffc4,
                limb2: 0xab092e9805484f9,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x170b0b6c55cb8620df7ff3a0,
                limb1: 0x46cd60edb855ff5fa7bcec4a,
                limb2: 0x7d8df52d2f9a4a2,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x94d34750cea0f8f1a6e347b,
                limb1: 0x345ebf24382e4f0604c3228,
                limb2: 0x19e6276bf6f2ddac,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x8876f2617424c5d5989706fe,
                limb1: 0x152eed66881cc6aa8745605f,
                limb2: 0x279ce40d82d268f4,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xf01d6a0237aed3dcaaf49d03,
                limb1: 0x7cd7211299453bb6cbeef046,
                limb2: 0x9032ee8651b8a2e,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x5284726948caca75a2db6117,
                limb1: 0x9eadacd6fe449172b7a675fd,
                limb2: 0x207472f7118b8607,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x2ef24a962b215e0c98108901,
                    limb1: 0x4899571323245c9cc3455091,
                    limb2: 0x1d690239ee179edb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa39b54f83c0396c93a46087,
                    limb1: 0xb85045b68181585c11bdc8d2,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x8e54f5e5729a89263dde62e9,
                    limb1: 0x56311fc47798cccd32512f46,
                    limb2: 0x1a3d6cfd33c3ca04,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe405c23bda8b1b464103f305,
                    limb1: 0xed735d8c93add1cb4cf62bb2,
                    limb2: 0x1e691cc539d59d25,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x9a107dcbeb3892eae55c2ea2,
                    limb1: 0x67c005ec4649fd5af8b79930,
                    limb2: 0xd704fd9933256b8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfecf29d613d48955b66fb386,
                    limb1: 0xf89fe847b35ff23e53842a19,
                    limb2: 0x25d61c83a365c933,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf147750466c43bcd41fa45e1,
                    limb1: 0x947da31b6d014ccd25b73769,
                    limb2: 0x2d2a85a06f9e3835,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x428d17231baf0f5be11e2b74,
                    limb1: 0x4a431996e5490e09ff722342,
                    limb2: 0x1e53f884ba19bde3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x439f7c265380c5bbea8edbc8,
                    limb1: 0x1009d2ef39881d044f611887,
                    limb2: 0x2ad707dccc4f3748,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x8e54f5e5729a89263dde62e9,
                    limb1: 0x56311fc47798cccd32512f46,
                    limb2: 0x1a3d6cfd33c3ca04,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe405c23bda8b1b464103f305,
                    limb1: 0xed735d8c93add1cb4cf62bb2,
                    limb2: 0x1e691cc539d59d25,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xf7d5ed9a9cf1af465499a984,
                    limb1: 0xca8a0701c4f7168375c6b937,
                    limb2: 0x2d68f19cbaa13f41,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfb9e8310879ee2cef9808a17,
                    limb1: 0xdc2822db40c0ac2e9e2d776c,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x3d732d7d4987ff9463e847dd,
                    limb1: 0x440cef520268013a9f4fcdd8,
                    limb2: 0xe7bbe9391c6747e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcd0b60619be129fb8357a99e,
                    limb1: 0x26003ad4392984ef7957f94f,
                    limb2: 0xf338842c3374473,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xba7112689e40667f0a7250ae,
                    limb1: 0x1791dbd0cefb7db00cd8853c,
                    limb2: 0x27b321838feec9c7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdfb7a37574326d3bdb6f2eb3,
                    limb1: 0x8b8f509e29fff758091c17b2,
                    limb2: 0x2bdd12ca3134eab6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x24acf20904640cc3ea16e4bb,
                    limb1: 0x6e8619b1d29b10f4aa662351,
                    limb2: 0x19af8d677ed9953c,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xb8598877dc97febd2bb8d797,
                    limb1: 0xcc26cdf6073803afddef6988,
                    limb2: 0x2b733bbab5535d7a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x67222124d3a37df28a06fcda,
                    limb1: 0x7200b07cab7c8ece6c07ebef,
                    limb2: 0x2d9a98c849a5cd59,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x3d732d7d4987ff9463e847dd,
                    limb1: 0x440cef520268013a9f4fcdd8,
                    limb2: 0xe7bbe9391c6747e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcd0b60619be129fb8357a99e,
                    limb1: 0x26003ad4392984ef7957f94f,
                    limb2: 0xf338842c3374473,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x3ae1d5d1a4fb33a9a370f6ce,
                    limb1: 0x986768c2fef5558ebacba516,
                    limb2: 0x2cc7ee2fa2240543,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8bbd8e60fc1a1859e888a509,
                    limb1: 0xdc2822db40c0ac2e47c7fadc,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xca9270fa9b616d7c00368177,
                    limb1: 0x74e430691092a5ff3a1bc9b7,
                    limb2: 0x230a0a1f439f03da,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6f072c15f787a8ab131a2bc9,
                    limb1: 0x383338b1a4b937b66b464822,
                    limb2: 0xd7af81e8523384f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xc9ca1d33e7ee7d8d24925e08,
                    limb1: 0xeb376a8a3ab4738c0305c62a,
                    limb2: 0x2a9c489e25ed2a53,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8b917674d630b75dd9abcf2a,
                    limb1: 0xfc7abb091fee7515b76bc50d,
                    limb2: 0x1a4c06f7b2bd7423,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x65059ade411873d768fb26c3,
                    limb1: 0xa0c5003396fca426447079da,
                    limb2: 0x198a386d3f89950a,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x8ed3bdd559e330464fa989d7,
                    limb1: 0xee0c05ce2eb541427f508804,
                    limb2: 0x85581780879cb3b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4d158441e696fa01394e835b,
                    limb1: 0xa899aa14ee2ba72341d2d867,
                    limb2: 0x2870e85b8f69a8ed,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xca9270fa9b616d7c00368177,
                    limb1: 0x74e430691092a5ff3a1bc9b7,
                    limb2: 0x230a0a1f439f03da,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6f072c15f787a8ab131a2bc9,
                    limb1: 0x383338b1a4b937b66b464822,
                    limb2: 0xd7af81e8523384f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x23d596922cb0e61dd462837f,
            limb1: 0x5aa0515c2d2ccc20afb5a45f,
            limb2: 0x14e7dc760804aa12,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xe69eafab402e072b139bfa4f,
                    limb1: 0x1ab2330ea16d7d55faee2b75,
                    limb2: 0x24855deef94f0fcc,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe84650b3537f55e72003698a,
                    limb1: 0x7de6fb1f01e481395f67645f,
                    limb2: 0x214661c44c28c057,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_7_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xe33a0f97cf06c1b0baecdc03,
                    limb1: 0x375e65b1a95102a2b5790622,
                    limb2: 0x16f34508e84dc559,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xcac94dce4d3c4a559d313bde,
                    limb1: 0x8f676e6e16888ef65d3de69,
                    limb2: 0x1ed38af41a5d19da,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xe33a0f97cf06c1b0baecdc03,
                    limb1: 0x375e65b1a95102a2b5790622,
                    limb2: 0x16f34508e84dc559,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xcac94dce4d3c4a559d313bde,
                    limb1: 0x8f676e6e16888ef65d3de69,
                    limb2: 0x1ed38af41a5d19da,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xe33a0f97cf06c1b0baecdc03,
                    limb1: 0x375e65b1a95102a2b5790622,
                    limb2: 0x16f34508e84dc559,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xcac94dce4d3c4a559d313bde,
                    limb1: 0x8f676e6e16888ef65d3de69,
                    limb2: 0x1ed38af41a5d19da,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xe33a0f97cf06c1b0baecdc03,
                    limb1: 0x375e65b1a95102a2b5790622,
                    limb2: 0x16f34508e84dc559,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xcac94dce4d3c4a559d313bde,
                    limb1: 0x8f676e6e16888ef65d3de69,
                    limb2: 0x1ed38af41a5d19da,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xe33a0f97cf06c1b0baecdc03,
                    limb1: 0x375e65b1a95102a2b5790622,
                    limb2: 0x16f34508e84dc559,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xcac94dce4d3c4a559d313bde,
                    limb1: 0x8f676e6e16888ef65d3de69,
                    limb2: 0x1ed38af41a5d19da,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xe33a0f97cf06c1b0baecdc03,
                    limb1: 0x375e65b1a95102a2b5790622,
                    limb2: 0x16f34508e84dc559,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xcac94dce4d3c4a559d313bde,
                    limb1: 0x8f676e6e16888ef65d3de69,
                    limb2: 0x1ed38af41a5d19da,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xe33a0f97cf06c1b0baecdc03,
                    limb1: 0x375e65b1a95102a2b5790622,
                    limb2: 0x16f34508e84dc559,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xcac94dce4d3c4a559d313bde,
                    limb1: 0x8f676e6e16888ef65d3de69,
                    limb2: 0x1ed38af41a5d19da,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x19faa06e0c0a59677579501a62fda854, high: 0x14b6ab426c00984c734bb05788c31f6
            },
            u256 {
                low: 0x21f8c1569e0df45b992a34a1084fa819, high: 0x2cce1b0f1af4787f52ebdac5a1457899
            },
            u256 {
                low: 0xf66b32de19b58371c6a4b5e7d859725, high: 0x2751324f7799a8e2b368c5539c30ceaa
            },
            u256 {
                low: 0xa6855857567e5862ef151673a1df3da7, high: 0x2dabe62caeba42d0f83032491fd3af07
            },
            u256 {
                low: 0xd960af85c9df7e444bdffa7d9f3dd894, high: 0x18cf2fdee96aa1aff55e3aa2208a393e
            },
            u256 {
                low: 0xdc45488d84dda9b91f1e0ee9cf6c9992, high: 0x2719d05306aa871feef71cbc915d113
            },
            u256 {
                low: 0x5f1ff97c71cff814645bd776c838a145, high: 0x16d1c7107499b28c30c32323c1b199c4
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x9b5360c4493e024b3a589a44,
                limb1: 0x7a07777672f74620e8650e25,
                limb2: 0xc37fcdea36030fc,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x59ff1469e7013a789699784d,
                limb1: 0x7e72d235e79eb2d2e6958dfd,
                limb2: 0x14abab6cc92cb604,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xcfb11f2e6261eb538607b69b,
                limb1: 0x2cd4254a53535822a73b54bd,
                limb2: 0x26de52b863573773,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x2cce3b8a336c49ccae7c722d,
                limb1: 0x3f48e34a989770b5a4c3d34f,
                limb2: 0xcfa8da01e838e19,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xf94f5c651dae91d26490722b,
                limb1: 0xb7de257ef5632001ddd291fc,
                limb2: 0x842eb5f8f0cd8ca,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xd8125876c935632f7c13b02,
                limb1: 0x1053c386279db2d40c44708e,
                limb2: 0x726af544bb21ad5,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x67b09d89ab26deaeb11b774f,
                    limb1: 0xc8b29dbc5058a7e364dc304a,
                    limb2: 0x29d4308c3deb3d9a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5a587ec8362dde5c159af1ad,
                    limb1: 0xdc2822db40c0ac2e34412eb4,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xca9f7f90172d31f885b0d605,
                    limb1: 0x422872108635b722a28e4448,
                    limb2: 0x2d24ecfab85308e8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe9e45a3123dbc81ae3378700,
                    limb1: 0x6ea688e65390f99f9a35648,
                    limb2: 0xd390c8b5583a9d4,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x612c331c5a73508ac3414069,
                    limb1: 0xfe0e190345eae5eeb374b145,
                    limb2: 0x1605d967f7d3c17f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x471e763e7eaa89a7e1c1042f,
                    limb1: 0x244c6360e2c821515b5f13f5,
                    limb2: 0x36705a0e678180,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x39ea4b8396231c3966a861a2,
                    limb1: 0xdf19b3742234348445b29c7,
                    limb2: 0x21bcd642a92c2d2d,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x8efae995cd467dbbe0188781,
                    limb1: 0x55d8cac48f9e74acb8a7f7b7,
                    limb2: 0x26a62a0a6695da65,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbdad0e936b935850a9a69500,
                    limb1: 0x14bf39ab2fab2ecdecea02da,
                    limb2: 0x27ab25a2008afd7c,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xca9f7f90172d31f885b0d605,
                    limb1: 0x422872108635b722a28e4448,
                    limb2: 0x2d24ecfab85308e8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe9e45a3123dbc81ae3378700,
                    limb1: 0x6ea688e65390f99f9a35648,
                    limb2: 0xd390c8b5583a9d4,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xbee5020c99867b034c89c324,
                    limb1: 0x419ff3c3ea8146347022ad31,
                    limb2: 0x16a65a22d53279a3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4377a28bab2d9c39ed22309b,
                    limb1: 0xb85045b68181585d4d18269d,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x55517c757b9d68303226031f,
                    limb1: 0xd69c0845950807b36dbe6bd4,
                    limb2: 0x9f620cc440d9e25,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1df8665446d86b29700567f0,
                    limb1: 0xc6e0071065e55f5d24e7a42,
                    limb2: 0x22f7052476be4387,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xc8d2a6df840eec1f98d14fcb,
                    limb1: 0x2f0951f30b8527b8c2c7a298,
                    limb2: 0x576cc28b80f6dba,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbb592e0d1cbd2126cc4cdc87,
                    limb1: 0x55244eb63bde94f47f896aa3,
                    limb2: 0x2d0e8fd3b08854b1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x28c117b69757d354ea5008d,
                    limb1: 0x6154163eeb96b656393f94b0,
                    limb2: 0x2cf8dd873c039f96,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xfff4756072d838909672095d,
                    limb1: 0x83d418d0bf18171a493b437c,
                    limb2: 0x1de26264cc28da71,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x89059de25c48294e9f163d42,
                    limb1: 0xb4a975e61018512647e899a3,
                    limb2: 0x81c7287a1d78a41,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x55517c757b9d68303226031f,
                    limb1: 0xd69c0845950807b36dbe6bd4,
                    limb2: 0x9f620cc440d9e25,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1df8665446d86b29700567f0,
                    limb1: 0xc6e0071065e55f5d24e7a42,
                    limb2: 0x22f7052476be4387,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x5bd7e7780315dc85723b97c1,
                    limb1: 0x6bda74f58d59ebfc43f819f0,
                    limb2: 0x1923971894309799,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8bbd8e60fc1a1859e888a509,
                    limb1: 0xdc2822db40c0ac2e47c7fadc,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x252857339d51df6cea9ebedc,
                    limb1: 0x733fce171f626014b0a70173,
                    limb2: 0xd820524a80b91ea,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9f714ef9bc100ef0ede4d481,
                    limb1: 0xd39dfaed38cae039127383d6,
                    limb2: 0x143105aeecd8feb,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xb9b0788a3056ea622c790cb8,
                    limb1: 0x6f3348f6a535d325d4472b02,
                    limb2: 0x158217d493f5dd60,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2673ff8283f9df1243004894,
                    limb1: 0xdabdbd1586fcc778c1306e5b,
                    limb2: 0x2d178e9c7452fb18,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xaafa7c34aa0805c45fdf771b,
                    limb1: 0xd75cca78387d9557773af001,
                    limb2: 0x206f92013c3c6c12,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x6f79059ad7f59e46bfdc3c94,
                    limb1: 0x59bf6a455e27203e11f50459,
                    limb2: 0x28860f6df822b5bf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xde53eced34302cd2c9ae7d83,
                    limb1: 0x7ad9f0c7aa60a0ab375a8b83,
                    limb2: 0x3c93110cc68afc3,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x252857339d51df6cea9ebedc,
                    limb1: 0x733fce171f626014b0a70173,
                    limb2: 0xd820524a80b91ea,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9f714ef9bc100ef0ede4d481,
                    limb1: 0xd39dfaed38cae039127383d6,
                    limb2: 0x143105aeecd8feb,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x9633bc8cf2afb5f13b0a320,
            limb1: 0xe609c1ca085ea537399a1c4e,
            limb2: 0x1084a211f057234f,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x2348083229c087c1c0c7c77d,
                limb1: 0x38c541eb58319f82fddc4ce1,
                limb2: 0x17ff4c1d3221de8b,
                limb3: 0x0
            },
            u384 {
                limb0: 0xeafaa2e45cbc4b7a44630319,
                limb1: 0x32c3d3a43803b1bbe97caf59,
                limb2: 0x13185375c893fd5f,
                limb3: 0x0
            },
            u384 {
                limb0: 0x65dde7bf3c74d3762ef66516,
                limb1: 0xe8a03385d172cd9a8d76f02a,
                limb2: 0x15b67c0bbd373f64,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x64968eed674813e85e07a8f9,
                    limb1: 0xba466a983904413df9eb17f7,
                    limb2: 0x27e737e7e4bf81e5,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x6f37af7acddbc20f1df52c27,
                    limb1: 0x28e496324afabad8f2368f92,
                    limb2: 0x53dc1abb1cfe6c6,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_8_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xab956e546a9bff16f2d43292,
                    limb1: 0x5aa7988f0d0366d3a95b40a,
                    limb2: 0x19c2b17d997846e1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc64545ec0dce6974bbe70cab,
                    limb1: 0x66fc5b06ca6de17f8183c00e,
                    limb2: 0x2dc09e4cfc729310,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xab956e546a9bff16f2d43292,
                    limb1: 0x5aa7988f0d0366d3a95b40a,
                    limb2: 0x19c2b17d997846e1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc64545ec0dce6974bbe70cab,
                    limb1: 0x66fc5b06ca6de17f8183c00e,
                    limb2: 0x2dc09e4cfc729310,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xab956e546a9bff16f2d43292,
                    limb1: 0x5aa7988f0d0366d3a95b40a,
                    limb2: 0x19c2b17d997846e1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc64545ec0dce6974bbe70cab,
                    limb1: 0x66fc5b06ca6de17f8183c00e,
                    limb2: 0x2dc09e4cfc729310,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xab956e546a9bff16f2d43292,
                    limb1: 0x5aa7988f0d0366d3a95b40a,
                    limb2: 0x19c2b17d997846e1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc64545ec0dce6974bbe70cab,
                    limb1: 0x66fc5b06ca6de17f8183c00e,
                    limb2: 0x2dc09e4cfc729310,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xab956e546a9bff16f2d43292,
                    limb1: 0x5aa7988f0d0366d3a95b40a,
                    limb2: 0x19c2b17d997846e1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc64545ec0dce6974bbe70cab,
                    limb1: 0x66fc5b06ca6de17f8183c00e,
                    limb2: 0x2dc09e4cfc729310,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xab956e546a9bff16f2d43292,
                    limb1: 0x5aa7988f0d0366d3a95b40a,
                    limb2: 0x19c2b17d997846e1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc64545ec0dce6974bbe70cab,
                    limb1: 0x66fc5b06ca6de17f8183c00e,
                    limb2: 0x2dc09e4cfc729310,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xab956e546a9bff16f2d43292,
                    limb1: 0x5aa7988f0d0366d3a95b40a,
                    limb2: 0x19c2b17d997846e1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc64545ec0dce6974bbe70cab,
                    limb1: 0x66fc5b06ca6de17f8183c00e,
                    limb2: 0x2dc09e4cfc729310,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xab956e546a9bff16f2d43292,
                    limb1: 0x5aa7988f0d0366d3a95b40a,
                    limb2: 0x19c2b17d997846e1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc64545ec0dce6974bbe70cab,
                    limb1: 0x66fc5b06ca6de17f8183c00e,
                    limb2: 0x2dc09e4cfc729310,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x6d2ed7ce6ac9d8a4160ff927c7550f2, high: 0x246eb3e0aaa079968522dc4ef1dd50bf
            },
            u256 {
                low: 0x809e2109c7867a38a09f1aede38690e7, high: 0x20746fc16b8c66f28611f583b2d10e3d
            },
            u256 {
                low: 0x254bf7ae1d0ab994f20b575d4e28e674, high: 0x1b02f95790e639e1e44fc3a96d0c62c3
            },
            u256 {
                low: 0x1ad1daaaef8d9ff015831feeec41e6f6, high: 0x1a9201501965e435101bb5fa6a677623
            },
            u256 {
                low: 0xf45da406bbf9bb0127f9e728c618fc1e, high: 0x1b96eb08725c2675ca9571e407dc02b1
            },
            u256 {
                low: 0x7f22cd1207b6e08e6ac1ca75afb918c8, high: 0x14c497fff655860bdd32e231eb561699
            },
            u256 {
                low: 0x5a3da367141b1a1b40a978bfb8f8903b, high: 0x2c460b485bf806761f12a0e912011caa
            },
            u256 {
                low: 0x2d8b5b41590e83da586f1721078548d7, high: 0xec067f2f96d4403d48c93f3028d042b
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x7b13d06d84500909f076f5ca,
                limb1: 0xceebb31c5f993808f7a9c17,
                limb2: 0x51a066c30e36433,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xb6b641bd037159d383adaddb,
                limb1: 0x823b1ff3de675b100314a4de,
                limb2: 0x1e8e30259042fc18,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x7552f8aa4293f9e47199e495,
                limb1: 0x497270a7439194807b264d76,
                limb2: 0xf6a59c20587501e,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xe4304c5709aa913df4a70fc8,
                limb1: 0xac04486952aa6164d65e65b2,
                limb2: 0x1666fd2d131d74b3,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x1e38bc1bbee399b84c4579a9,
                limb1: 0xd9b5ae85e70b75c70dac2193,
                limb2: 0x111e38fcc0f82fe2,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x39b671e2549a3bb732b9c100,
                limb1: 0x67ba9677de027380cf2e9eeb,
                limb2: 0x7b7049629c0cb30,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x37eea3756ba0a16409dec1f5,
                    limb1: 0x7da5cc1d52d52bedbeb0e30f,
                    limb2: 0x2b188a1a1bb82b76,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd1ee9c83bcf3d64a32f57e86,
                    limb1: 0xb85045b68181585d90e37af4,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x6c784aa3dea59b2d554e69a6,
                    limb1: 0x1f44d0a38bc0b6b14931451c,
                    limb2: 0x1fa78b3441b3127d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x41c88bcb4d3483f5f531d4eb,
                    limb1: 0xa5b710fbcab78e6fcd711a6f,
                    limb2: 0x1187968916d5f515,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x1d5dcd2af0c1fa9288f79394,
                    limb1: 0x891cf77f179df263e34d779b,
                    limb2: 0x2603da551053ec28,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3a4097b626d64f2e1ad3262b,
                    limb1: 0x72d906ffa5e021ade5832c,
                    limb2: 0x1fd04ca4f5a83c5a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe0e1867a22be789fd9c9aeb7,
                    limb1: 0xe92e42cec4177eefa8a51471,
                    limb2: 0x40fd43d92158711,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xdcf7155e5fd04571276e3fab,
                    limb1: 0xa57e2c3421c0cbb6441264c3,
                    limb2: 0x2e925329e3e7974d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5ce7d8d4ab7cffcb0718817a,
                    limb1: 0x38d4ed3cdea552f1d0d1e4bc,
                    limb2: 0x432752863503f17,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x6c784aa3dea59b2d554e69a6,
                    limb1: 0x1f44d0a38bc0b6b14931451c,
                    limb2: 0x1fa78b3441b3127d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x41c88bcb4d3483f5f531d4eb,
                    limb1: 0xa5b710fbcab78e6fcd711a6f,
                    limb2: 0x1187968916d5f515,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x6e1e7165ec6465e9334fde11,
                    limb1: 0xf8c0a3e374ae1006650863e0,
                    limb2: 0xd73cc4c7ef9576d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7b388e08a455cba51ba04897,
                    limb1: 0xb85045b68181585d30de4173,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x68297f092aaeb29a305da0d,
                    limb1: 0x9b08537d2520cd0a60f4838c,
                    limb2: 0x1740a03331e0465e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4789638e8ef0931b740ee620,
                    limb1: 0x69335b864d1f8d6fe1c56910,
                    limb2: 0x73743334232092a,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xa1aa322c28b7d6a3b91a5aef,
                    limb1: 0x8600df2218a60efdef22d311,
                    limb2: 0xc5e2f1f9724a713,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x193e0162e3a3383143b5a69a,
                    limb1: 0xb3502e64df4fbee4f0b04699,
                    limb2: 0x8e8781856c303fe,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xaa8f240310ec32f10e96485c,
                    limb1: 0xb82e5eaa06c3a460dff195ef,
                    limb2: 0x1c00613771e568f4,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xab15fd447be03566109490e0,
                    limb1: 0x18c8b4c0ede10ec18b5c2012,
                    limb2: 0x155d9226b46f32f2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd69c2aabacd1b9525c2cb260,
                    limb1: 0x3b9a1292e75ea84fa5503b30,
                    limb2: 0x15a5c999c6961b7f,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x68297f092aaeb29a305da0d,
                    limb1: 0x9b08537d2520cd0a60f4838c,
                    limb2: 0x1740a03331e0465e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4789638e8ef0931b740ee620,
                    limb1: 0x69335b864d1f8d6fe1c56910,
                    limb2: 0x73743334232092a,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x8b4aaadc187e48e627ddbee2,
                    limb1: 0x76d176e5ab63f28f1397f741,
                    limb2: 0x5d2103d0a279b77,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8bbd8e60fc1a1859e888a509,
                    limb1: 0xdc2822db40c0ac2e47c7fadc,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x88a7d4e7c896cadefefd1bda,
                    limb1: 0x3395ea8eff72fbb25a4a4650,
                    limb2: 0xe80de252504ded8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd4e615c73aa8f87a1a9d9f09,
                    limb1: 0x9528268956e44e160eaefb87,
                    limb2: 0xfdbbbb41ab22028,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x1bb25043cfa04a2135fe00e,
                    limb1: 0x142c2950fe66306993fd08e8,
                    limb2: 0x1f2fa24f8deb553e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb776a3bd857f2c35aee46b63,
                    limb1: 0x48a7ef0c623ef1f85be0abe4,
                    limb2: 0x4b1d7dfbf5d5377,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3bc3f207cec0c4f3ee51c97f,
                    limb1: 0x76ebd20131fd80cfcb33b0df,
                    limb2: 0x288475a2b8846d01,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x99f77eb759c4609cfcf7538e,
                    limb1: 0x9ac1bfacfe58f3170eded2f1,
                    limb2: 0x2b829a6f6f0e9c88,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7eb24155affae96e4fd8dd1b,
                    limb1: 0xbf78739c04acea422c0cf297,
                    limb2: 0x2f93331c50166079,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x88a7d4e7c896cadefefd1bda,
                    limb1: 0x3395ea8eff72fbb25a4a4650,
                    limb2: 0xe80de252504ded8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd4e615c73aa8f87a1a9d9f09,
                    limb1: 0x9528268956e44e160eaefb87,
                    limb2: 0xfdbbbb41ab22028,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xf87b99dac765f9aee7ff9729,
            limb1: 0xfa1f9dbf4bf671818606a41d,
            limb2: 0x685bb3baea0dd8a,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x63b48458caa0c248456fdda6,
                    limb1: 0xa784049a0533681115e0431a,
                    limb2: 0x208dc4bb829574c0,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb42ace65e48a9fae35df1c2a,
                    limb1: 0x2003556fe0b91333657f205e,
                    limb2: 0x1fd542e288e97ae3,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_1_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x80b92361ac46c7fa92bd5d0,
                    limb1: 0xd27527f9ccd8b23576b2de69,
                    limb2: 0x796bce8b7f9966556c628685,
                    limb3: 0xc30519120a6e99c1aae46ea
                },
                y: u384 {
                    limb0: 0x5375baa2ec44e4170b5a6d81,
                    limb1: 0x237384d99c783796710ea4c0,
                    limb2: 0x696008c5ef1883033a27156c,
                    limb3: 0x41990adc64c4b7615f9b9ea
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xbb6b0095ac7b7ab2a8b56f85346d2b7e, high: 0x5fbdb4571f8941b6e6a1a40bf031f4b9
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x8c2ec8dd7e4d8e7a11f204ae,
                limb1: 0xf8ab79d3cde8cc6390a44bf7,
                limb2: 0x880e8fa96b959e3d476e1b41,
                limb3: 0x360c47ca872596c0a46bba4
            },
            y: u384 {
                limb0: 0x41c7ab390dad9fd4cc19f63c,
                limb1: 0xf709695a5db66f6e64eb32f4,
                limb2: 0x80b243aa5eac87833394d52e,
                limb3: 0x182cb287562cb0acb1f07f9d
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x372fb66628b141dbab2af8cc,
                limb1: 0xbf3d57c5c8caad214fa6178a,
                limb2: 0xb924d308c45db2d4e0764acf,
                limb3: 0x3e991866f9d572301494a4e
            },
            y: u384 {
                limb0: 0x16b48a444a02ad9b4bc3e98e,
                limb1: 0x77d9adda69667bced85e7054,
                limb2: 0x815d2908d7f048ad33be9b6c,
                limb3: 0xeab4001711ddcb783701620
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x76d50a65e0bbcf91bb8f871f,
                limb1: 0x980a134a19ccb3f97489760c,
                limb2: 0x3d751caaef6698c96e92e464,
                limb3: 0x11bd593c71b961f26ec1241c
            },
            y: u384 {
                limb0: 0xef332ac442da90e88625e3de,
                limb1: 0xc04599b0ec0bdc6a81e9fcc7,
                limb2: 0x1ed79c8495fcaebdefa717d7,
                limb3: 0x228a4680566ab261aa18987
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xcf3b36585dd5bfd346831617,
                    limb1: 0xc2eee508a4bc6c921ccb0fa6,
                    limb2: 0x56e97a05ede84ce16dbda186,
                    limb3: 0x8d6f26eaff888445f70ab27
                },
                u384 {
                    limb0: 0x1b3937baf42f7cf35f2b6e29,
                    limb1: 0xb39869507b587b118c0dd53d,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xbec3101ddd6e383c03473f56,
                    limb1: 0x9016d094a7cd03b780d6c0e5,
                    limb2: 0x7707ec5687800f46ae346924,
                    limb3: 0x10963ee24d9593773a8c7a6c
                },
                u384 {
                    limb0: 0x1d19a4ec20ed050644e1d02d,
                    limb1: 0x9c1030d35bef778b1754d59e,
                    limb2: 0x41d14ea2794846f23fb470f7,
                    limb3: 0xa6ffbdc7066a3922626a527
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x6a8614173d2f91bf1aac8389,
                    limb1: 0xc89863c56ab8b0357c67b764,
                    limb2: 0xc2c2dde24dadb32b0792e15d,
                    limb3: 0x72ff486b30f3c637d89957c
                },
                u384 {
                    limb0: 0xe6a0eab6f62ecde679de8a75,
                    limb1: 0x8ffa84e1afe1217033ede091,
                    limb2: 0x23b78c26b96b3449c69863c5,
                    limb3: 0x19e0e518da02e87ec8b6c114
                },
                u384 {
                    limb0: 0x6477021bdcd73cd71d2e6299,
                    limb1: 0x1d54384b59afa6e710e71575,
                    limb2: 0xee56bcc8fff30a5712fe027b,
                    limb3: 0xfb944e01b6e488d61681cb3
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x9864407801bae0f00d1da802,
                    limb1: 0x71f99d10b1d22295c6030399,
                    limb2: 0x558857ab5511a610d1c77f13,
                    limb3: 0xe56d7b4c35680a853fa9a45
                },
                u384 {
                    limb0: 0xc31293b0c9b5141913879609,
                    limb1: 0x90ff0ac790ce8083ea75679,
                    limb2: 0xc3f98db280a9d0440b4cb11f,
                    limb3: 0xfbedd87881aa7ae4d7eece6
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xbec3101ddd6e383c03473f56,
                    limb1: 0x9016d094a7cd03b780d6c0e5,
                    limb2: 0x7707ec5687800f46ae346924,
                    limb3: 0x10963ee24d9593773a8c7a6c
                },
                u384 {
                    limb0: 0x1d19a4ec20ed050644e1d02d,
                    limb1: 0x9c1030d35bef778b1754d59e,
                    limb2: 0x41d14ea2794846f23fb470f7,
                    limb3: 0xa6ffbdc7066a3922626a527
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x81a5d40d32952cc5efbaf0fa,
                    limb1: 0x1fe76423b06a5ff02fc4389a,
                    limb2: 0x42f91f4d2ae6c83035f70199,
                    limb3: 0x626b41ceca3898fe9b9e0d6
                },
                u384 {
                    limb0: 0x9cb28e122d778e3c3e2b3005, limb1: 0x3c3a2655, limb2: 0x0, limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xebecd70e4ad3f26f2a55c30c,
                    limb1: 0xe4cf7021bdc88f32296d8c5,
                    limb2: 0xe9a41b98f7e6be845f285ed9,
                    limb3: 0xeff2760ffc4046df39d74d5
                },
                u384 {
                    limb0: 0x7218b763768951a4aba8dc0f,
                    limb1: 0xd57e52e1610d96cd58530a0b,
                    limb2: 0x10bb0b432080325aa6ac4169,
                    limb3: 0x9e72ed2a93ba5db2f24167d
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xe7eb2026e7be3128052a0387,
                    limb1: 0xa56c623591d9d9d769107a85,
                    limb2: 0x67d3c852987c3b67a31cec1c,
                    limb3: 0x1723a5e9d29814877509314b
                },
                u384 {
                    limb0: 0xe3e04a414df8411c70f1bd3a,
                    limb1: 0xb648157ec61f0d8a7928fd8c,
                    limb2: 0x70ef39764196df6cbf80ed27,
                    limb3: 0x150e80271473ae2b577849d8
                },
                u384 {
                    limb0: 0x6e4bc59edc150a2e950daf31,
                    limb1: 0x722f45cc38a93f452a4c1ad6,
                    limb2: 0x10310a8b38bde453cf0313cc,
                    limb3: 0x2712c8b6bebe3e3e1b5b561
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x4d0b5c39b751c9bca957b6da,
                    limb1: 0x6ad236c6821037844d03631a,
                    limb2: 0x1ff914b516ac6307959755e5,
                    limb3: 0x7fa79af8c104483383e83eb
                },
                u384 {
                    limb0: 0x170edd8e20264692aea3c591,
                    limb1: 0xeec878e48d85651142a0282f,
                    limb2: 0xffa080351d897de5a72bf2e7,
                    limb3: 0xd9ba9606b6eb0d27174b23d
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xebecd70e4ad3f26f2a55c30c,
                    limb1: 0xe4cf7021bdc88f32296d8c5,
                    limb2: 0xe9a41b98f7e6be845f285ed9,
                    limb3: 0xeff2760ffc4046df39d74d5
                },
                u384 {
                    limb0: 0x7218b763768951a4aba8dc0f,
                    limb1: 0xd57e52e1610d96cd58530a0b,
                    limb2: 0x10bb0b432080325aa6ac4169,
                    limb3: 0x9e72ed2a93ba5db2f24167d
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xa2b5295f30ab4dc986c7c90c,
                    limb1: 0xa5d480d5b63f770a400d2977,
                    limb2: 0x5138c1b60051529ccc878771,
                    limb3: 0xb9be0f5db93fc4eee6792a7
                },
                u384 {
                    limb0: 0x302ea91a3b09524e7c49fbbb,
                    limb1: 0xb39869507b587b118b5d4593,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xc5fffe8e82472687b554d621,
                    limb1: 0xb40b81c254807ccb16cf24d5,
                    limb2: 0xc19bdc566b6c703fdd04683e,
                    limb3: 0xa599b544da1f01b260dcc89
                },
                u384 {
                    limb0: 0x34f3f33b091ee9299452ac0,
                    limb1: 0xfe96791141995095a7c7268,
                    limb2: 0x4cb1bd23b0b2ffe6a47be38b,
                    limb3: 0x45a272758292d84db11394b
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x7362ef9de800103c2f1f5322,
                    limb1: 0x6b64b9cadafa0c71cb5ad234,
                    limb2: 0xfd03a51e6dfa7c68a8a80802,
                    limb3: 0x16b0b0433abc25292c63fc0
                },
                u384 {
                    limb0: 0xf07c078a05b31e459cbb11f3,
                    limb1: 0xf67f65cc6d57c57b034221c,
                    limb2: 0xa788aed11626b414cc1e94f1,
                    limb3: 0x6e1582a1953dc8b459cbf86
                },
                u384 {
                    limb0: 0x501470e2685a548854686a99,
                    limb1: 0x11d012f4076e824ed3cb5aee,
                    limb2: 0x5831bae6e369a375f7ea029a,
                    limb3: 0x299750cdebd915cbd74c0df
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x66abfa3a4f1d9a1ed553add9,
                    limb1: 0x68fd34685b50fd083c909358,
                    limb2: 0xc323c482493a757a808c8e3b,
                    limb3: 0xf655b66fd07d9d24d1b8a70
                },
                u384 {
                    limb0: 0xd3cfccec247ba4a6514ab00,
                    limb1: 0x3fa59e445066542569f1c9a0,
                    limb2: 0x32c6f48ec2cbff9a91ef8e2c,
                    limb3: 0x11689c9d60a4b6136c44e52d
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xc5fffe8e82472687b554d621,
                    limb1: 0xb40b81c254807ccb16cf24d5,
                    limb2: 0xc19bdc566b6c703fdd04683e,
                    limb3: 0xa599b544da1f01b260dcc89
                },
                u384 {
                    limb0: 0x34f3f33b091ee9299452ac0,
                    limb1: 0xfe96791141995095a7c7268,
                    limb2: 0x4cb1bd23b0b2ffe6a47be38b,
                    limb3: 0x45a272758292d84db11394b
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x51a2fe6da5a616e91eb38057,
            limb1: 0xa58f041d025c73b26e74afc9,
            limb2: 0x136c8a0e673ca55d18e23b2c,
            limb3: 0x6562f1875272671396bf5eb
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xe174cf42dd0abff3d99b8b76,
                    limb1: 0xbb9fcb1dae7b100e560f75d6,
                    limb2: 0x5a40e0988fe2469eb24a82cc,
                    limb3: 0x96d72a967d851a4c91e9640
                },
                y: u384 {
                    limb0: 0x2ee475e03ec369cd5a3eb8e1,
                    limb1: 0xca9a99d169dd7fb7f6b9c10e,
                    limb2: 0x406c126285ca29afc9211b1d,
                    limb3: 0xcbca971f0d12424eb6fdc5a
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_2_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x707161b8a2572260d39985af,
                    limb1: 0x2e5c096fe086310963963c5f,
                    limb2: 0x71d91a5f33667bb1d420a49a,
                    limb3: 0x1015285ba84004d7abcc08cb
                },
                y: u384 {
                    limb0: 0x6d2525138a67a65a2d0057fc,
                    limb1: 0x95b8eb391253f63e9135e3ae,
                    limb2: 0x9587c5cf13d7837d435ffcc,
                    limb3: 0x54c09fcd0327afd56fb82e0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x707161b8a2572260d39985af,
                    limb1: 0x2e5c096fe086310963963c5f,
                    limb2: 0x71d91a5f33667bb1d420a49a,
                    limb3: 0x1015285ba84004d7abcc08cb
                },
                y: u384 {
                    limb0: 0x6d2525138a67a65a2d0057fc,
                    limb1: 0x95b8eb391253f63e9135e3ae,
                    limb2: 0x9587c5cf13d7837d435ffcc,
                    limb3: 0x54c09fcd0327afd56fb82e0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x743c7e9d2fdeb0352452bc39dbf2eed1, high: 0x5a8eb86c582dd9727a089ca81cc5a8a0
            },
            u256 {
                low: 0x726d44a215203c7421aa15ef58c43ce, high: 0x2ae1b61e5cbbc08035475c5ef76dce6e
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xe7abd2664b0670c434fa159b,
                limb1: 0x700a9cfb6206098ab27ee337,
                limb2: 0x7270fb9fea5c1f315b8b284,
                limb3: 0x18547f92f9d5f123362bf7eb
            },
            y: u384 {
                limb0: 0x8c403c1bdd86eea33b50ad7d,
                limb1: 0xac4b2c0a9524f22c3097fea0,
                limb2: 0x40287c8e24289f8cf2a958b7,
                limb3: 0x18015c68d76f6eca6ca2fafb
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x9215958a20ff3fde6d2e4521,
                limb1: 0x16a25f7fc4c77f81daae4a60,
                limb2: 0x4e97d253f51dab8925bbaed2,
                limb3: 0x18eafade6109da94004a56e0
            },
            y: u384 {
                limb0: 0x2ec42cfab604a5cc4845a7ca,
                limb1: 0x6ba7c2a93fe254fbb8beabd3,
                limb2: 0x4a6e2ea6b361a64815e88ee7,
                limb3: 0x1419170bf73093389b3683b3
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x15985644a3952d77a9e581cb,
                limb1: 0xa538106086eefef235f19261,
                limb2: 0xfe30072eb3f156dec1fe43fc,
                limb3: 0x711e608cfc4f924cfb185d7
            },
            y: u384 {
                limb0: 0x14c5505e495141fdc1c2d973,
                limb1: 0x59dd2f8d38f89e5be3e4bfb5,
                limb2: 0xcdf715362659f4989224d694,
                limb3: 0x3f10a02239c1913646a0932
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x8b10c981db14d6c608b819d5,
                    limb1: 0x264876228553777d4c5e89f,
                    limb2: 0x54facc2f4906a3db09c9fc0d,
                    limb3: 0x1963afa7d295b80f13c9aef6
                },
                u384 {
                    limb0: 0xa03c1e16cf744979ad9734d9, limb1: 0x3aa814b0, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x5d1fe28e902cbaf8a29e6dec,
                    limb1: 0x7aa3c873be5e3f7e444f545a,
                    limb2: 0xc2e63ace474b413813c398ff,
                    limb3: 0x261439b5c96907f4b528c28
                },
                u384 {
                    limb0: 0xa8acbe086a06cdaf76bba0c,
                    limb1: 0x2ffafed6aad5b1b42742e066,
                    limb2: 0xd972f9596e25964fd30ce60,
                    limb3: 0xb987be5d0e9d739b43f4eb6
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xc043c001832d2b634d68a811,
                    limb1: 0xab0fd869968bfb6095e78fad,
                    limb2: 0x6a65c02ecbc5b92a8c0d3d84,
                    limb3: 0xfa638d4efe431ec2950136a
                },
                u384 {
                    limb0: 0xca6d4064c8adc4e784f15759,
                    limb1: 0x3fa122d29b1354b967c502c6,
                    limb2: 0x5f4cbbac83e68d21c39ea52a,
                    limb3: 0x14caec5837c9cc79fa57db85
                },
                u384 {
                    limb0: 0x8912d5091ab5a598adad5a0a,
                    limb1: 0x281dbadfa745ee220a98118a,
                    limb2: 0x9306ac5dc0d71fde52192b21,
                    limb3: 0x53098ee40d143d561d4e20b
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x747f8a3a40b2ebe28a79b7b0,
                    limb1: 0xea8f21cef978fdf9113d5169,
                    limb2: 0xb98eb391d2d04e04f0e63fd,
                    limb3: 0x9850e6d725a41fd2d4a30a3
                },
                u384 {
                    limb0: 0x78d72f826082b36bddaf3d85,
                    limb1: 0x58bb28b9b4a5d0ac7e5f8199,
                    limb2: 0xf311117ef7121a0f013e26c1,
                    limb3: 0x1460ddad0a27764c85e19321
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x5d1fe28e902cbaf8a29e6dec,
                    limb1: 0x7aa3c873be5e3f7e444f545a,
                    limb2: 0xc2e63ace474b413813c398ff,
                    limb3: 0x261439b5c96907f4b528c28
                },
                u384 {
                    limb0: 0xa8acbe086a06cdaf76bba0c,
                    limb1: 0x2ffafed6aad5b1b42742e066,
                    limb2: 0xd972f9596e25964fd30ce60,
                    limb3: 0xb987be5d0e9d739b43f4eb6
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x51b39b9f85624cffadd63eae,
                    limb1: 0xe71a5b945536a78a92537adb,
                    limb2: 0x4c94091717e4cccfe38b8774,
                    limb3: 0x16e62aff104219c46381c6be
                },
                u384 {
                    limb0: 0x8ffa97e0f80e2ea1eb28b47a,
                    limb1: 0xb39869507b587b12247281e8,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xd9ca7cdef430c4afcea90124,
                    limb1: 0x55cebc31888b0b1e2d650b6b,
                    limb2: 0xb461442a15ea8cf84b99b04c,
                    limb3: 0x9c2b948bb308b3ac9a78df9
                },
                u384 {
                    limb0: 0x602108bcb0a79dc0bf378a86,
                    limb1: 0x89633c5248143bbcff13793d,
                    limb2: 0xc6266cfba06a6fceed2dd212,
                    limb3: 0xb02009a69b5edc8ea20efc0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xa6bedbef39b87a356b869f0a,
                    limb1: 0x7390374bd397c875895fb8dc,
                    limb2: 0x9c3fd1836e557f8e152f016f,
                    limb3: 0xccc3b24edb0991aa2473609
                },
                u384 {
                    limb0: 0xabe263a4cacc196ab7975f8d,
                    limb1: 0x6c0e1505f6d9158e45671c3e,
                    limb2: 0xb72991f1a713a02fe88e2adc,
                    limb3: 0x134b645d17ae75c4245934a7
                },
                u384 {
                    limb0: 0x416e003557663e1bc164c3cd,
                    limb1: 0xa557dd9341e5257d155fa5dc,
                    limb2: 0x834e32414f64c7b2d284644c,
                    limb3: 0x27264c21bf3f73321a40e93
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xb5d5f37c16c412bf3aa459e5,
                    limb1: 0xf00a1e252b7b365496e82db0,
                    limb2: 0x8e3963d0f332e85c3ae1ae71,
                    limb3: 0xd09d338b3424650db829030
                },
                u384 {
                    limb0: 0xcf3022f3089f7702fcde7f6d,
                    limb1: 0xbe5c1ea8299ff8cfdda1e4f6,
                    limb2: 0xd54e07171d3273b6c132358a,
                    limb3: 0x1206f07f6d57d0895d68174c
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xd9ca7cdef430c4afcea90124,
                    limb1: 0x55cebc31888b0b1e2d650b6b,
                    limb2: 0xb461442a15ea8cf84b99b04c,
                    limb3: 0x9c2b948bb308b3ac9a78df9
                },
                u384 {
                    limb0: 0x602108bcb0a79dc0bf378a86,
                    limb1: 0x89633c5248143bbcff13793d,
                    limb2: 0xc6266cfba06a6fceed2dd212,
                    limb3: 0xb02009a69b5edc8ea20efc0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x8c1d60326d3d64d3ebd0e32,
                    limb1: 0x2d373e6819e1d4ffb79e7216,
                    limb2: 0xe53802e4a5971002453e1cce,
                    limb3: 0x1904646df9ae9dbc5484d3e4
                },
                u384 {
                    limb0: 0x302ea91a3b09524e7c49fbbb,
                    limb1: 0xb39869507b587b118b5d4593,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x67816ef06d264756f358b258,
                    limb1: 0x604012d599c1dd14bd09ce64,
                    limb2: 0x65d64e860f30740507329f57,
                    limb3: 0x1723851b6050498c6bb916a
                },
                u384 {
                    limb0: 0xbafa1430af6992a9e8eb8e6a,
                    limb1: 0x12873561a1ab6dd42cb8233b,
                    limb2: 0x39cf802c1fdf94a1ff5032b0,
                    limb3: 0x140542ed4230f97bc63b72b4
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x8997ee1364d5d0fb769629e6,
                    limb1: 0xc8f6a14eaba2657f5ee1d126,
                    limb2: 0xe80d70eb38840b77b59eeedd,
                    limb3: 0x9c2f6d00471d3641dbc6603
                },
                u384 {
                    limb0: 0xf55d8033e751334a7a1e7be8,
                    limb1: 0x169c76c5bfea4d3eb0eaf761,
                    limb2: 0xc8c39ed81bbc70518d665d17,
                    limb3: 0x489452cda6dbd44df8a0e7b
                },
                u384 {
                    limb0: 0x7c84f5bb3bdecfd973b08a88,
                    limb1: 0x58c2e9210507d12d59f52d54,
                    limb2: 0xb7c8ad198588dd71d367aa57,
                    limb3: 0x37536c8fe742fd50d34eaca
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x9e05bbc1b4991d5bcd62c960,
                    limb1: 0x81004b5667077452f4273991,
                    limb2: 0x97593a183cc1d0141cca7d5d,
                    limb3: 0x5c8e146d81412631aee45a9
                },
                u384 {
                    limb0: 0xd7ec50c38fa94aa7a3af39a7,
                    limb1: 0x148a5da3a29ad4e456dc8cf2,
                    limb2: 0x1d5afa2a52186ff922b19282,
                    limb3: 0x211d5f65c443220379ad3ae
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x67816ef06d264756f358b258,
                    limb1: 0x604012d599c1dd14bd09ce64,
                    limb2: 0x65d64e860f30740507329f57,
                    limb3: 0x1723851b6050498c6bb916a
                },
                u384 {
                    limb0: 0xbafa1430af6992a9e8eb8e6a,
                    limb1: 0x12873561a1ab6dd42cb8233b,
                    limb2: 0x39cf802c1fdf94a1ff5032b0,
                    limb3: 0x140542ed4230f97bc63b72b4
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x9088905cd2a5002a77cc7524,
            limb1: 0xfbae36d79aea6fac3064ddf1,
            limb2: 0x724e840346be2b99a7110e47,
            limb3: 0x993420e9809837476fe4ae
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xf0e9f924354997e9a4ddd622,
                    limb1: 0xb945ff85d905b6c42eb1fbb2,
                    limb2: 0xd8b954de6591bcace77dfdb7,
                    limb3: 0x110bbcc3d816a16915d15cac
                },
                y: u384 {
                    limb0: 0x312daa6c31185b6c8a9d8c2b,
                    limb1: 0xfe5f5fa21fa40607ceaa6708,
                    limb2: 0x395fdee31ef3931a9af51693,
                    limb3: 0xafc629101e4657adb01811f
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_3_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xb0a323617abed46b7f793a0,
                    limb1: 0x48f35d164ef58cadd8e50c24,
                    limb2: 0x1d8e0382667c745b737aee36,
                    limb3: 0x37efd410b14c307a27a0f99
                },
                y: u384 {
                    limb0: 0x14a6803581054691613b094d,
                    limb1: 0xae7f8b2153c7cdd524dbe25c,
                    limb2: 0x40fc051f890b3920efcd063e,
                    limb3: 0x14f16040e2ee320345fa6464
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb0a323617abed46b7f793a0,
                    limb1: 0x48f35d164ef58cadd8e50c24,
                    limb2: 0x1d8e0382667c745b737aee36,
                    limb3: 0x37efd410b14c307a27a0f99
                },
                y: u384 {
                    limb0: 0x14a6803581054691613b094d,
                    limb1: 0xae7f8b2153c7cdd524dbe25c,
                    limb2: 0x40fc051f890b3920efcd063e,
                    limb3: 0x14f16040e2ee320345fa6464
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb0a323617abed46b7f793a0,
                    limb1: 0x48f35d164ef58cadd8e50c24,
                    limb2: 0x1d8e0382667c745b737aee36,
                    limb3: 0x37efd410b14c307a27a0f99
                },
                y: u384 {
                    limb0: 0x14a6803581054691613b094d,
                    limb1: 0xae7f8b2153c7cdd524dbe25c,
                    limb2: 0x40fc051f890b3920efcd063e,
                    limb3: 0x14f16040e2ee320345fa6464
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x97d01e702f1d9bef53b53b92a2cb5f38, high: 0x4440cfa11a42b62914afe646fe3216bd
            },
            u256 {
                low: 0x606821d6280a07ee4ec985ff94b28b9d, high: 0x1007bba9f217faac259cff81e5ce0ca6
            },
            u256 {
                low: 0x8222134550de4292390a9016cdec85da, high: 0x178b7da8c13e66af3c9590d33e2aad3e
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x29253eb108a6c6af74ffa091,
                limb1: 0x7b9fd016f0f1c238c791a309,
                limb2: 0xf00d938d0ba94a30ec25cf22,
                limb3: 0x15e3691f74b066e98396a05
            },
            y: u384 {
                limb0: 0x65a6c8488231e2910ddebda6,
                limb1: 0xaa8b1891da4d7025d2ded0ab,
                limb2: 0x22c45d572e84b5fb20b25ddb,
                limb3: 0x19d3edd0c68f30ed3c8930c6
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xa4a06590a1b6a5da5a1d0e3a,
                limb1: 0xdffa865baaa36f414f7bc17e,
                limb2: 0xfcfe4658509b6f8c4d0941e8,
                limb3: 0x1823baa4164d56ad411000f8
            },
            y: u384 {
                limb0: 0x9574eb95b57a34b79f6a3b5,
                limb1: 0x6c91e7edc1f679e4b8813f8a,
                limb2: 0x2d679d336446cdd105f6c042,
                limb3: 0x92f95dddbcaa5bd93390a9
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xf8d5157b8bb1f800d3c546f,
                limb1: 0x9f0965b529482df936c4ae41,
                limb2: 0x6d498e5f88021f664baf35a0,
                limb3: 0xc95da1017b3198393eb30c3
            },
            y: u384 {
                limb0: 0xd8222735aeccafc2cebb1cfa,
                limb1: 0x40d33369e639364d1a9b5798,
                limb2: 0x53764f2cdd5e529722aafa81,
                limb3: 0x7b6cd002333cfe58fb1d77e
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x25cf776db106776b1bc257db,
                    limb1: 0x51fd19dbc2040ac823e3f580,
                    limb2: 0x34c62aaaf084d28e4bb0429,
                    limb3: 0x11b1242a219c945d2ed2d5fb
                },
                u384 {
                    limb0: 0x517d8246d3da165104771015, limb1: 0x88d00e49, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xe76b33d62ae1709a530f267d,
                    limb1: 0xc5c1965f612d146d21dbbc71,
                    limb2: 0xff4669c5457c7047424baa89,
                    limb3: 0x4f84fe993d1eea323cae624
                },
                u384 {
                    limb0: 0x7d248f1899ac4c09d308767a,
                    limb1: 0xa29da573b6c9a73d7e3550d1,
                    limb2: 0x35b015c7f2518cf893e45566,
                    limb3: 0x1523de1737201d2410682e17
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xc74d3c328be74e9b85985179,
                    limb1: 0x94ea18c43968e8d7a56b0124,
                    limb2: 0x4eaebe9d0ce3c5cf58e32833,
                    limb3: 0x1505ab62eb70e678e5e2ccef
                },
                u384 {
                    limb0: 0xde19a85d68646b6a21c696c8,
                    limb1: 0xfb73ecf821992babca0bcdea,
                    limb2: 0xdcacffb98175279d90eaa70e,
                    limb3: 0x11dcd683aa0da13ddeba8dce
                },
                u384 {
                    limb0: 0xf690914a17ff357e368b4d84,
                    limb1: 0x1986311d2acaa8d42442a9ef,
                    limb2: 0x3889dc5e70aafb15abadffd4,
                    limb3: 0x1d60f8151da8f02eddd692f
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x9daccf58ab85c2694c3c99f4,
                    limb1: 0x1706597d84b451b4876ef1c7,
                    limb2: 0xfd19a71515f1c11d092eaa27,
                    limb3: 0x13e13fa64f47ba8c8f2b9893
                },
                u384 {
                    limb0: 0xe0963c6338b430274c22d9e7,
                    limb1: 0x54e41debf713ba899cd14349,
                    limb2: 0xcdd50999be0515375021d5c,
                    limb3: 0x68c429e3000c0c1604dc13a
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xe76b33d62ae1709a530f267d,
                    limb1: 0xc5c1965f612d146d21dbbc71,
                    limb2: 0xff4669c5457c7047424baa89,
                    limb3: 0x4f84fe993d1eea323cae624
                },
                u384 {
                    limb0: 0x7d248f1899ac4c09d308767a,
                    limb1: 0xa29da573b6c9a73d7e3550d1,
                    limb2: 0x35b015c7f2518cf893e45566,
                    limb3: 0x1523de1737201d2410682e17
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x3907823420bc96240aee83ce,
                    limb1: 0x4eacafd490c5e637814d0758,
                    limb2: 0xa18f856e26fe0a281cb9aa86,
                    limb3: 0x6a15b09bd580141d0db4b90
                },
                u384 {
                    limb0: 0x69b1c9b68391cd6d5f113773, limb1: 0x1bb97198, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x8079c435f6ea989b915131c,
                    limb1: 0x7080d68b639a703ff6b30a1d,
                    limb2: 0x800617e50bac450d3a0a1c26,
                    limb3: 0x18fc591abf897fc050226074
                },
                u384 {
                    limb0: 0xb2fd6838ba9b6cdeedeab37c,
                    limb1: 0xa573c1cff3c8f05914f7325a,
                    limb2: 0x6c0b0fd411d6b3222685f55f,
                    limb3: 0x185f6bef519db37fb2ad3eda
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x347bbf9e3f3f2aaf23c723d7,
                    limb1: 0x4566f4aaf0ab2057f7e528ed,
                    limb2: 0x2dd77cb2c11540091f0784b8,
                    limb3: 0x1836c1606db6d07b6def7a61
                },
                u384 {
                    limb0: 0xb16b8799691e175126599ff9,
                    limb1: 0x7639752c45a92aecb1b1c25,
                    limb2: 0x43193342fffccbe3401c3113,
                    limb3: 0x184202c1dd28144185f3c7d1
                },
                u384 {
                    limb0: 0x72b33e11171024222d1d0664,
                    limb1: 0x79a088964ffaa563868cc9ca,
                    limb2: 0x9761ffebcf7530f5597260c7,
                    limb3: 0x1514608b0911e7664b22581a
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xc22710e4fbda626e4554c6f,
                    limb1: 0x8c70e24aaa56de937ec82878,
                    limb2: 0x3635590e014b31a60d99385b,
                    limb3: 0x15ee2eac51a64b325f368aaf
                },
                u384 {
                    limb0: 0xb7f9a0e3bc70b37bb7abcdef,
                    limb1: 0x603c8f5ceb10def7f7d8c96e,
                    limb2: 0xe64938ca19f4e9f9bf889d40,
                    limb3: 0x137a79fe99f71a2fe9620446
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x8079c435f6ea989b915131c,
                    limb1: 0x7080d68b639a703ff6b30a1d,
                    limb2: 0x800617e50bac450d3a0a1c26,
                    limb3: 0x18fc591abf897fc050226074
                },
                u384 {
                    limb0: 0xb2fd6838ba9b6cdeedeab37c,
                    limb1: 0xa573c1cff3c8f05914f7325a,
                    limb2: 0x6c0b0fd411d6b3222685f55f,
                    limb3: 0x185f6bef519db37fb2ad3eda
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xc514ba24d5f0f208a1f1d88f,
                    limb1: 0x60cd717801ae9d9751cfd7f5,
                    limb2: 0x8ccef32ec2f0750bf94d82bf,
                    limb3: 0x17506a1a5c990c4b9409aaf6
                },
                u384 {
                    limb0: 0x302ea91a3b09524e7c49fbbb,
                    limb1: 0xb39869507b587b118b5d4593,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xa6b01d87b2d234da67f63d,
                    limb1: 0x712e2665ce5a31e13636b748,
                    limb2: 0xc7c858712b0ca73bfc81f52d,
                    limb3: 0xefa39bb095000bc1bc522a3
                },
                u384 {
                    limb0: 0xae7a4917198c3aa598a5f2ad,
                    limb1: 0x4f5db93119764f0db717903d,
                    limb2: 0x1c4f84f6f05108174e51adf5,
                    limb3: 0xf488f2044ff5d03c13c1db0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xb14ce121568bd5fca602dab3,
                    limb1: 0xadcc536e6235dd53d0fdf78c,
                    limb2: 0xb1f902f105d93b6c5ccea57,
                    limb3: 0x149f2d5339f792ab22a7089
                },
                u384 {
                    limb0: 0x22b62ecd8c8f98c57d880d80,
                    limb1: 0x2cce760b74a09484370c8349,
                    limb2: 0x180a524e1a0fc97f8bdf32a2,
                    limb3: 0x196b593b0454fc1e58a24fd8
                },
                u384 {
                    limb0: 0xe41c53aeca3b289329391dab,
                    limb1: 0x5959ffeac19969f5c885aede,
                    limb2: 0xf21e72e770d26830447d5e8a,
                    limb3: 0x10e235ba17f8678c7b927ad7
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x9ff2c076aacd48d369a0839e,
                    limb1: 0xf656f4554c06db3c9b82dd22,
                    limb2: 0x988a0815e34405e60afdaf36,
                    limb3: 0x7e6c317b24035bbd8dd3b22
                },
                u384 {
                    limb0: 0x5741245cf232ea966298755e,
                    limb1: 0x6f153f8278774fee9f0640f9,
                    limb2: 0xeaa6ba2cf8558953523c9256,
                    limb3: 0x92018aca0fda6da6eb92753
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xa6b01d87b2d234da67f63d,
                    limb1: 0x712e2665ce5a31e13636b748,
                    limb2: 0xc7c858712b0ca73bfc81f52d,
                    limb3: 0xefa39bb095000bc1bc522a3
                },
                u384 {
                    limb0: 0xae7a4917198c3aa598a5f2ad,
                    limb1: 0x4f5db93119764f0db717903d,
                    limb2: 0x1c4f84f6f05108174e51adf5,
                    limb3: 0xf488f2044ff5d03c13c1db0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xda84658e9ab2fa0756689118,
            limb1: 0x177a385338ec9fdf0392ecc1,
            limb2: 0xe41fbdd6f06be73cebe79851,
            limb3: 0xbf298584b2387dfd0dbb579
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x12ae0b76e7fb7a69ddad8579,
                limb1: 0xf9423aeca07a2068b516532d,
                limb2: 0x1244e568523f044671657073,
                limb3: 0x1094c075da646001e6a03a2
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xd58e5faa8cfba86caad081d7,
                    limb1: 0x6e9fd348d9de32bed2a2225c,
                    limb2: 0x97b1317bb1ce82555932434d,
                    limb3: 0x132c67a8cd9a9668bea35760
                },
                y: u384 {
                    limb0: 0x69556834954a02b1518548b1,
                    limb1: 0xe3d4101c31c4480ea28067bf,
                    limb2: 0x6bd20c83ce82634cbe72926d,
                    limb3: 0x46cbcb07eac70b32e923422
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_4_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x1a70d12bff3886ebf534226d,
                    limb1: 0x245166fa57de7175d52e5ed3,
                    limb2: 0xfad40d9e7f010421f715bc86,
                    limb3: 0xf05c5216be92926615d62f4
                },
                y: u384 {
                    limb0: 0x830ce7d43a55f0b894a63210,
                    limb1: 0x5dfdf619de7a41da7910aa7b,
                    limb2: 0x76270319bce9083767076a4d,
                    limb3: 0x24b975179b3d0b5cd3b96a2
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1a70d12bff3886ebf534226d,
                    limb1: 0x245166fa57de7175d52e5ed3,
                    limb2: 0xfad40d9e7f010421f715bc86,
                    limb3: 0xf05c5216be92926615d62f4
                },
                y: u384 {
                    limb0: 0x830ce7d43a55f0b894a63210,
                    limb1: 0x5dfdf619de7a41da7910aa7b,
                    limb2: 0x76270319bce9083767076a4d,
                    limb3: 0x24b975179b3d0b5cd3b96a2
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1a70d12bff3886ebf534226d,
                    limb1: 0x245166fa57de7175d52e5ed3,
                    limb2: 0xfad40d9e7f010421f715bc86,
                    limb3: 0xf05c5216be92926615d62f4
                },
                y: u384 {
                    limb0: 0x830ce7d43a55f0b894a63210,
                    limb1: 0x5dfdf619de7a41da7910aa7b,
                    limb2: 0x76270319bce9083767076a4d,
                    limb3: 0x24b975179b3d0b5cd3b96a2
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1a70d12bff3886ebf534226d,
                    limb1: 0x245166fa57de7175d52e5ed3,
                    limb2: 0xfad40d9e7f010421f715bc86,
                    limb3: 0xf05c5216be92926615d62f4
                },
                y: u384 {
                    limb0: 0x830ce7d43a55f0b894a63210,
                    limb1: 0x5dfdf619de7a41da7910aa7b,
                    limb2: 0x76270319bce9083767076a4d,
                    limb3: 0x24b975179b3d0b5cd3b96a2
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xb3c161c313f2a37c64d027590542bd75, high: 0x26524d576b944e0921cc14b312bdf75f
            },
            u256 {
                low: 0xed28508dbdaa3bfa6ab015638cffbbb1, high: 0x2625c8ff6c148fc69750ca7e246cb09c
            },
            u256 {
                low: 0x3f80c31f15a5712c5ac4b6c7a31034dd, high: 0x518aaca05e87905aa1fdcdf171df24d9
            },
            u256 {
                low: 0x2f7a304ff344c911174f7a54788c161e, high: 0xe5b37b346e785ad1bce35d8cbe88a3f
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x74c50ba729f00ad0d6d70fe8,
                limb1: 0xb481f1c7d8380f1e890bed7a,
                limb2: 0xbc9f23f0502873f1d0c26b2c,
                limb3: 0x10aae250cd89710d38ed5b61
            },
            y: u384 {
                limb0: 0x80b1926d089db1f8b38c1e33,
                limb1: 0x6518bba509f50ceaefb12775,
                limb2: 0x95ff98ad5d4543e73a616313,
                limb3: 0x16ed3618ea9254be814cee8f
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xfbb550e9c73076e776ad97c8,
                limb1: 0xb4a1a547260693be55ba8df,
                limb2: 0xd80168a0638d375199157f1d,
                limb3: 0x33eb21846de4b73e073ca88
            },
            y: u384 {
                limb0: 0x1d7fde9b213f00476601edb3,
                limb1: 0x7a8012f6e48f6882abc9404,
                limb2: 0x8dc9c88d0e16fd242053d671,
                limb3: 0x1241570917a429862c0ac22a
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x1b7454598cb7455f123e280b,
                limb1: 0x6fd473d63cba40c148a8e4a3,
                limb2: 0x3a19ad364f1464349a133645,
                limb3: 0xcc0e1f55ac991be8e5b9235
            },
            y: u384 {
                limb0: 0x6fac336e3637b0ab986f784e,
                limb1: 0xbfe475dcc2e1a7a1d26829b,
                limb2: 0xd19b772530a10829efaf4c56,
                limb3: 0xf8feccf679b9044e3146bc1
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x10ae4cfbc00df26fc462776e,
                    limb1: 0x5d80f9615d61069569663210,
                    limb2: 0x21d27588669efa2fea1ee29d,
                    limb3: 0x1d6ee890b1e8b3cf8ef9871
                },
                u384 {
                    limb0: 0x4d106973e98f49ce8036ba21,
                    limb1: 0x6730d2a0f6b0f62350f9220c,
                    limb2: 0x434bacd764774b84f38512bf,
                    limb3: 0x1a0111ea397fe69a4b1ba7b6
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x5818c333e00d28f96bbf6fca,
                    limb1: 0xed326a734f02da4a6b60e6ef,
                    limb2: 0xb74e13af2773e3dae7cf95,
                    limb3: 0x17a41cc4b32e5a0f1d1be1fd
                },
                u384 {
                    limb0: 0xd372232c4ad56e4333f42301,
                    limb1: 0xf58e4c7fbd4b6bb3df1db3af,
                    limb2: 0xcf24281ff9c51ef61f31fdcb,
                    limb3: 0x14517c62398d3300fbec9115
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x24abebc9c59729ac9a4bf8a2,
                    limb1: 0x298a57ee2fd68bbde3c5072,
                    limb2: 0xdc2b0de10708d461739f58aa,
                    limb3: 0x13d903aed37ed2ab74e1ca05
                },
                u384 {
                    limb0: 0xe57d12db82fb4996a2b832e1,
                    limb1: 0xb6c3d80f7edf6955f9d648b2,
                    limb2: 0xb5a59b59ce65f0d054905388,
                    limb3: 0x2b740f34598099aaf689713
                },
                u384 {
                    limb0: 0x1c004829fb52f453c26b526d,
                    limb1: 0x48a11eab1afd4d6789a72f88,
                    limb2: 0xe2e03f9df18b38499dad41d9,
                    limb3: 0xcca012aee4f248b90c1be4
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x4c670cd05237a3e5aefebf27,
                    limb1: 0x7f3731ea57f886bd517f9bc1,
                    limb2: 0x38fa31c88f37ed0091100619,
                    limb3: 0x108d3d542039b46d931c90d1
                },
                u384 {
                    limb0: 0x39cc8cb1fd58b90ccfd18c03,
                    limb1: 0xa0a6ba1c111acc632072cec3,
                    limb2: 0x72ad99f9b9ae9949a238bef1,
                    limb3: 0x342bbca39b518350e5f4d34
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x5818c333e00d28f96bbf6fca,
                    limb1: 0xed326a734f02da4a6b60e6ef,
                    limb2: 0xb74e13af2773e3dae7cf95,
                    limb3: 0x17a41cc4b32e5a0f1d1be1fd
                },
                u384 {
                    limb0: 0xd372232c4ad56e4333f42301,
                    limb1: 0xf58e4c7fbd4b6bb3df1db3af,
                    limb2: 0xcf24281ff9c51ef61f31fdcb,
                    limb3: 0x14517c62398d3300fbec9115
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xf72bd06d5e3e2be5e3c8a382,
                    limb1: 0x1a9424d835b4eaca5fe452c6,
                    limb2: 0xa0bf45acad2b642ed0b7768d,
                    limb3: 0x92045bcf09d270d9328d1e0
                },
                u384 {
                    limb0: 0xaf592c3b9e0b636801285595, limb1: 0xca4bc12, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x72bb2d34e3cfbbc81150d6ec,
                    limb1: 0xf9135ee6e67be332a2babe06,
                    limb2: 0x2fdb6c085ab8302dee864e07,
                    limb3: 0x5f2fb6f60db32efab41464b
                },
                u384 {
                    limb0: 0x9b2ddde9f396022c941df076,
                    limb1: 0x379551522c721b726421f84b,
                    limb2: 0x7076369881e910116359d71c,
                    limb3: 0x7bc9ab086b87200094a7a38
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xed45901e751ec5f7c5f0e556,
                    limb1: 0xdfdcfd19993a4ccfa2693620,
                    limb2: 0xccc8c05a645ca7f4a0b528a9,
                    limb3: 0x1499bcadf5576382eb87c276
                },
                u384 {
                    limb0: 0x549f57298b2d561a969b441a,
                    limb1: 0xb6c5ce8fddeb3abd26c5c3b3,
                    limb2: 0x167bab736a9ef42ddb4084a1,
                    limb3: 0x7086a94cf2520345ddfa5b6
                },
                u384 {
                    limb0: 0xe4c832b7a8443449660b9081,
                    limb1: 0xf189ab004a2ec7b0e6165437,
                    limb2: 0xb31ed079fa384c6319a15843,
                    limb3: 0x5bed638d631309973b4c9c6
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xcaecb4d38f3eef2045435bb0,
                    limb1: 0xe44d7b9b99ef8cca8aeaf819,
                    limb2: 0xbf6db0216ae0c0b7ba19381f,
                    limb3: 0x17cbedbd836ccbbead05192c
                },
                u384 {
                    limb0: 0xbb6377a8145908b25078172d,
                    limb1: 0x772472a7bb1777a571dbe12f,
                    limb2: 0x7e8d2d8aa32cf4c099e249b1,
                    limb3: 0x4f158d7e161e165da0e412b
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x72bb2d34e3cfbbc81150d6ec,
                    limb1: 0xf9135ee6e67be332a2babe06,
                    limb2: 0x2fdb6c085ab8302dee864e07,
                    limb3: 0x5f2fb6f60db32efab41464b
                },
                u384 {
                    limb0: 0x9b2ddde9f396022c941df076,
                    limb1: 0x379551522c721b726421f84b,
                    limb2: 0x7076369881e910116359d71c,
                    limb3: 0x7bc9ab086b87200094a7a38
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xdcb756f1c7fb4626365c1bf2,
                    limb1: 0x7deba292441b733cf827050a,
                    limb2: 0xb92d648e85b25934d7dd7ec9,
                    limb3: 0x738701b8e33c768304fc38b
                },
                u384 {
                    limb0: 0x302ea91a3b09524e7c49fbbb,
                    limb1: 0xb39869507b587b118b5d4593,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xc824d48aad4e2151490a817b,
                    limb1: 0x3b5910122bcbd7ab632cc46,
                    limb2: 0xc9bb9d63e2fd75591f0d3d27,
                    limb3: 0x823a1010a35786bbf50ad72
                },
                u384 {
                    limb0: 0x9a2a5abc661743b97713ead8,
                    limb1: 0xec12447647964c26f0a7727b,
                    limb2: 0x31309700b1d5affec05c5d5c,
                    limb3: 0xa017ddc97d80967dc4c4af8
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x9b8994b08d7bf33f664b0607,
                    limb1: 0x5f57dbe3b4a04dd21fb4422e,
                    limb2: 0xcf9f2348030af33438a35c98,
                    limb3: 0x1796de9ffe284ab01a644fb0
                },
                u384 {
                    limb0: 0x76dd30fde4a237b70f277231,
                    limb1: 0x5d6d6117fb65fcddd0621ae0,
                    limb2: 0x5e5cafc40afc416f13ed9e1,
                    limb3: 0x194ebd14426d8b1db8fa79a2
                },
                u384 {
                    limb0: 0xbc849038ac23d60c089a5fa8,
                    limb1: 0x8de1893103459ace6ab6274b,
                    limb2: 0xd772ca90fb50371cf3c39339,
                    limb3: 0x14f18edecbdc3c1e9f0fcb5e
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x6f3f522afb398545242a5b41,
                    limb1: 0xa7a571639441ffc6ba1f311c,
                    limb2: 0xe3a2c8b8277e89df88afe1dc,
                    limb3: 0x68d7219ef55fb14b2270e14
                },
                u384 {
                    limb0: 0xb7556af1de5e0ee5dc5000b5,
                    limb1: 0x49183f3827a83a77a3f1c9ef,
                    limb2: 0x8176af2b62df74760dec62b4,
                    limb3: 0xe04e58825e03f052615842a
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xc824d48aad4e2151490a817b,
                    limb1: 0x3b5910122bcbd7ab632cc46,
                    limb2: 0xc9bb9d63e2fd75591f0d3d27,
                    limb3: 0x823a1010a35786bbf50ad72
                },
                u384 {
                    limb0: 0x9a2a5abc661743b97713ead8,
                    limb1: 0xec12447647964c26f0a7727b,
                    limb2: 0x31309700b1d5affec05c5d5c,
                    limb3: 0xa017ddc97d80967dc4c4af8
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xa4356ba862e5d5724f37248d,
            limb1: 0xb08a44c42ed5a1b10f970dfa,
            limb2: 0x24963b9b0bd1b4630fc501a,
            limb3: 0x8a6f4c46de3a957f416ba84
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x7f055b485837b19a68a5cb5c,
                    limb1: 0x964db58421025475ab50a436,
                    limb2: 0xfd0e386c0a48b718eab7189d,
                    limb3: 0x1342d8678ce7873ceac805cb
                },
                y: u384 {
                    limb0: 0xb443e5ae1559a4930156a4a6,
                    limb1: 0xf58852d3cc2fb6ec33a2d66a,
                    limb2: 0xe10f91177110d3ee3c8df748,
                    limb3: 0x1722b14f03874eed829f5002
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_5_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x7397e7075b3f149cd66c7ce5,
                    limb1: 0xdfd1850ae799a982943762a4,
                    limb2: 0x6889ae8a61fcb982e7a3f651,
                    limb3: 0x957f483c214a50f986efa50
                },
                y: u384 {
                    limb0: 0x1616287ec2e30c29995d07b4,
                    limb1: 0x3c8560674f2fbc38b1e67c50,
                    limb2: 0xf1769d59b828957cd12b1c1a,
                    limb3: 0x181b0a6fef26681711ebab85
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x7397e7075b3f149cd66c7ce5,
                    limb1: 0xdfd1850ae799a982943762a4,
                    limb2: 0x6889ae8a61fcb982e7a3f651,
                    limb3: 0x957f483c214a50f986efa50
                },
                y: u384 {
                    limb0: 0x1616287ec2e30c29995d07b4,
                    limb1: 0x3c8560674f2fbc38b1e67c50,
                    limb2: 0xf1769d59b828957cd12b1c1a,
                    limb3: 0x181b0a6fef26681711ebab85
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x7397e7075b3f149cd66c7ce5,
                    limb1: 0xdfd1850ae799a982943762a4,
                    limb2: 0x6889ae8a61fcb982e7a3f651,
                    limb3: 0x957f483c214a50f986efa50
                },
                y: u384 {
                    limb0: 0x1616287ec2e30c29995d07b4,
                    limb1: 0x3c8560674f2fbc38b1e67c50,
                    limb2: 0xf1769d59b828957cd12b1c1a,
                    limb3: 0x181b0a6fef26681711ebab85
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x7397e7075b3f149cd66c7ce5,
                    limb1: 0xdfd1850ae799a982943762a4,
                    limb2: 0x6889ae8a61fcb982e7a3f651,
                    limb3: 0x957f483c214a50f986efa50
                },
                y: u384 {
                    limb0: 0x1616287ec2e30c29995d07b4,
                    limb1: 0x3c8560674f2fbc38b1e67c50,
                    limb2: 0xf1769d59b828957cd12b1c1a,
                    limb3: 0x181b0a6fef26681711ebab85
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x7397e7075b3f149cd66c7ce5,
                    limb1: 0xdfd1850ae799a982943762a4,
                    limb2: 0x6889ae8a61fcb982e7a3f651,
                    limb3: 0x957f483c214a50f986efa50
                },
                y: u384 {
                    limb0: 0x1616287ec2e30c29995d07b4,
                    limb1: 0x3c8560674f2fbc38b1e67c50,
                    limb2: 0xf1769d59b828957cd12b1c1a,
                    limb3: 0x181b0a6fef26681711ebab85
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xc149fa8e7bb8c2f11624d318a32652e8, high: 0x6a4322410078cb124b7350d13421beaf
            },
            u256 {
                low: 0x764657ca9e65736c72f774b1b2f11ef9, high: 0xea688c04c6e6fbb37fef6b501fda698
            },
            u256 {
                low: 0x4d18c103a100ed14fa92cd28c4c536fb, high: 0x364c7b9e27fe1b4b9bf1f1d18b92c247
            },
            u256 {
                low: 0x67c21355c3121af68b32992a3b7c1f9a, high: 0x2c46c8efbe86a8ea1cf0d1d47b3df41
            },
            u256 {
                low: 0xab2212c9e23b580e4523dbbb1eeed219, high: 0x32ffb56e41aef3f7001098240a614be3
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xb69f2a4636b181f41cb3907b,
                limb1: 0x128673a8943a640d66a588f2,
                limb2: 0x51531003ce91559e5745644,
                limb3: 0x434620d1d7f767b45960a85
            },
            y: u384 {
                limb0: 0xd6cae2db4c47f98ff709f584,
                limb1: 0xdef0d5ade93c8aa268294ed4,
                limb2: 0x56ba0ce06f665daaeec22f4a,
                limb3: 0x196fcce6b20ef52644612af8
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x283af6a8c12cea64c66d6c1e,
                limb1: 0x995b46805b40d910e6402147,
                limb2: 0xf6064ff3e0a64d9ad43c527f,
                limb3: 0x17600fe00a98f73a5c55e628
            },
            y: u384 {
                limb0: 0xe90eb41779c38d0b07f43ca2,
                limb1: 0x9a1557b58f93d408248f9cb4,
                limb2: 0xf4a6ae6e968e91865bccf80c,
                limb3: 0x13175488ae9f11006bb9784e
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xb68a558b9b2c4ced03dc2d72,
                limb1: 0xf9d1120c2477e25e6911a35e,
                limb2: 0x59f3aadde448a338bd019a59,
                limb3: 0x1167dff0092a05dd2bb942aa
            },
            y: u384 {
                limb0: 0xda309b77b085bc5b2d3e2dee,
                limb1: 0x17e038bc5bd059b008311f91,
                limb2: 0xb3f67d26f3690a2f1ba5f24f,
                limb3: 0x186c3eb71400e60b92ddab81
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xbd8ddf113be000e47326f3b6,
                    limb1: 0x595a46cf88f625ab91bd8130,
                    limb2: 0x96e83a7e1cc304e7e4121596,
                    limb3: 0x56537096a0943e0dc462d4e
                },
                u384 {
                    limb0: 0x986d687da5a35b99e9f28588,
                    limb1: 0x6730d2a0f6b0f623c2435057,
                    limb2: 0x434bacd764774b84f38512bf,
                    limb3: 0x1a0111ea397fe69a4b1ba7b6
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xa58c0064d711acd7e16da49f,
                    limb1: 0x9246c1e26ed85e87569ff8f8,
                    limb2: 0xcec0401b643b6e82e44dde64,
                    limb3: 0xb4b3f55d3ab921fd818c139
                },
                u384 {
                    limb0: 0x871ceeb2280e696f0cdf9d4b,
                    limb1: 0x74d8d9ed7adce89423cf1467,
                    limb2: 0xd5accd4cc5917ca8266cc629,
                    limb3: 0xc74bb5959ebcb0f6d16a2e0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x9e3ec435c7dedc92a61492ad,
                    limb1: 0x777b369c9fbd13248329502b,
                    limb2: 0xe0823e87e311dfc9b3843f67,
                    limb3: 0x432cb50a85b893340a37f2c
                },
                u384 {
                    limb0: 0xcf7bf55ce08638866c2eed16,
                    limb1: 0x12ead548805e9872881b936e,
                    limb2: 0xb7b0badf8179fb9fb8876267,
                    limb3: 0x1706e9a20ddca9fd025a53ae
                },
                u384 {
                    limb0: 0x716aee213fd448d1ca424bd4,
                    limb1: 0x9470ab741c7f99549235346a,
                    limb2: 0xd1e7df30352f5bd00db350fe,
                    limb3: 0x202b5fadfaaedba86699fd0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xe4dc0193a247b35f85b6e7d1,
                    limb1: 0xe1ea34e8c4b083f93bd3e3e3,
                    limb2: 0xf7b553962c766e869db266d2,
                    limb3: 0x132beb6d152e61e515475d30
                },
                u384 {
                    limb0: 0x6b1fbac8e63aa5bc337eca81,
                    limb1: 0x6c329514f4c2ac2c7090519f,
                    limb2: 0x1367885bb1cea71ba62e05e6,
                    limb3: 0x17d1db7b2e2f45a3693ee3cd
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xa58c0064d711acd7e16da49f,
                    limb1: 0x9246c1e26ed85e87569ff8f8,
                    limb2: 0xcec0401b643b6e82e44dde64,
                    limb3: 0xb4b3f55d3ab921fd818c139
                },
                u384 {
                    limb0: 0x871ceeb2280e696f0cdf9d4b,
                    limb1: 0x74d8d9ed7adce89423cf1467,
                    limb2: 0xd5accd4cc5917ca8266cc629,
                    limb3: 0xc74bb5959ebcb0f6d16a2e0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x1504d8fa092dcb558c488379,
                    limb1: 0x3c03c7eb8a02eefba4d5da5b,
                    limb2: 0x26f0bf16865e66dbc7fa6a9b,
                    limb3: 0xcc5ac6badbae50453d01aad
                },
                u384 {
                    limb0: 0xe770f549d7d3d16191a5fc45,
                    limb1: 0xb39869507b587b122f16760c,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x3a3fab67d588b88f52bd3210,
                    limb1: 0x74aae145e1625de9073e6ebf,
                    limb2: 0x404bbc50afe90179ad41bc3c,
                    limb3: 0x751a141f3a406195f14ff67
                },
                u384 {
                    limb0: 0xc6d5224f579200fe63256c53,
                    limb1: 0x5534d9b6aa8769b4c2e07c11,
                    limb2: 0x28075b30864b8fec2b29dcad,
                    limb3: 0x134a1f70a65230eaa1726ef3
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x8d3a059914f6e747aa8f9bde,
                    limb1: 0x7688a957bfd9f26c57b6761b,
                    limb2: 0x7ac6943ad1c42e7672e7b89f,
                    limb3: 0x13052139782652994a1d9617
                },
                u384 {
                    limb0: 0x8760bf22ec8d5778fb41a18e,
                    limb1: 0x26ecd268aec7994e2f89c60b,
                    limb2: 0xba15c632a92e18856e969d55,
                    limb3: 0x18cc8c37138cc94aeb4be35d
                },
                u384 {
                    limb0: 0xada90f4cd86f58e1a7508798,
                    limb1: 0xb9619949dd161020b295c9b3,
                    limb2: 0xc114cd961a05af98748dfeed,
                    limb3: 0x778540436a463483b122003
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x37aaad9f9c23e23d4af51d95,
                    limb1: 0x6b7ab2768ed8817ffe4dbafe,
                    limb2: 0xbde3446b5b2cba61c181de32,
                    limb3: 0x345731d951031cb313855e6
                },
                u384 {
                    limb0: 0xb8ac893dea4a03f98c965bf6,
                    limb1: 0x8671c198bcbbba8ace29f049,
                    limb2: 0x19861313503fa8a6c59d4d36,
                    limb3: 0x192659ee2648f675ef926c60
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x3a3fab67d588b88f52bd3210,
                    limb1: 0x74aae145e1625de9073e6ebf,
                    limb2: 0x404bbc50afe90179ad41bc3c,
                    limb3: 0x751a141f3a406195f14ff67
                },
                u384 {
                    limb0: 0xc6d5224f579200fe63256c53,
                    limb1: 0x5534d9b6aa8769b4c2e07c11,
                    limb2: 0x28075b30864b8fec2b29dcad,
                    limb3: 0x134a1f70a65230eaa1726ef3
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xbcab70efa38fad9e0a8868bf,
                    limb1: 0x8c43fe5a27eef98573f5e6c,
                    limb2: 0xa5fe40ede021d5cae0179026,
                    limb3: 0x183650f38d8e6a8fe401bc2
                },
                u384 {
                    limb0: 0x302ea91a3b09524e7c49fbbb,
                    limb1: 0xb39869507b587b118b5d4593,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x4544d84e1cf6bcd241181cd8,
                    limb1: 0xa733e7fd17fd8aedb3eb6741,
                    limb2: 0x134267058111537396827167,
                    limb3: 0x19154c57484c263bcd4e3b8d
                },
                u384 {
                    limb0: 0x83e2b3cb17a4c8ae35b5bbc6,
                    limb1: 0x3b354cb56da930d8ee063b57,
                    limb2: 0x369d5edd03ffa63655cc38a5,
                    limb3: 0xb3a34045f3cd01d0e282699
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x857aa76d8abe796d75ef32a1,
                    limb1: 0xe0683e68cec3b75d08c80c6e,
                    limb2: 0x3d19215345bf92d825d75c4c,
                    limb3: 0xbfe11a2ece931a676d886f3
                },
                u384 {
                    limb0: 0xfd879ca5a9c84245c3ae079e,
                    limb1: 0xe38510bf74c3035dd92f1366,
                    limb2: 0x77303dbc2210bad09ecc3329,
                    limb3: 0x12d064475743e9f5067e0867
                },
                u384 {
                    limb0: 0x5fa2fc1d6d395cce4a91fb55,
                    limb1: 0xeabdd44baa31b60ac7a66825,
                    limb2: 0x5539e1731b0f25be2a52a569,
                    limb3: 0x18e008b2cb63470de0bc8e87
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x117613945ddf3490461735f,
                    limb1: 0x673d28117be3494a73a99d09,
                    limb2: 0x8326958fd6df6b3f7f7a8d60,
                    limb3: 0x1651fb9e74b0e52053e5f711
                },
                u384 {
                    limb0: 0x5e36cf2ca49422b8d6d7446d,
                    limb1: 0x85a46034bff3cd3f996ced5f,
                    limb2: 0x9729ce9cab874d5463abcfd5,
                    limb3: 0x12e7be27437359d9ed84f2ae
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x4544d84e1cf6bcd241181cd8,
                    limb1: 0xa733e7fd17fd8aedb3eb6741,
                    limb2: 0x134267058111537396827167,
                    limb3: 0x19154c57484c263bcd4e3b8d
                },
                u384 {
                    limb0: 0x83e2b3cb17a4c8ae35b5bbc6,
                    limb1: 0x3b354cb56da930d8ee063b57,
                    limb2: 0x369d5edd03ffa63655cc38a5,
                    limb3: 0xb3a34045f3cd01d0e282699
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x5e41793566d5a77ae44e0096,
            limb1: 0xde3152912a189147255c9471,
            limb2: 0xb2b52500cb2e3c6598eaff21,
            limb3: 0xcfa63f4ed882de2442e6768
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x923860cda58de4afde99899d,
                limb1: 0xa9ac4dae5a9e496e81e49533,
                limb2: 0x4198c0fc4a8afc82dbe1fd61,
                limb3: 0x743586d34b9aec3de0a4510
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xb2f62e589579a89cadafcad7,
                    limb1: 0x29d607e8999cb05a3ed25271,
                    limb2: 0xbb6ee766d9e94beeeaca08fd,
                    limb3: 0x4213d4c531a088b81419ddf
                },
                y: u384 {
                    limb0: 0x6222825cfd393e1cb6ab7d44,
                    limb1: 0xe1447bfb63e8d046e5aacced,
                    limb2: 0xd541e42ef94210f0690c6231,
                    limb3: 0x5bbe40e54016d8bac081cdf
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_6_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x239000264ee57165a8063237,
                    limb1: 0x4b68386661726329d0714422,
                    limb2: 0x42c006e33cc8e97d1e781248,
                    limb3: 0x5f945e99855447c85f5638c
                },
                y: u384 {
                    limb0: 0xb0efbf0cfcfb8679fc94d713,
                    limb1: 0xfccc3dc4043415b49ff1c2c5,
                    limb2: 0xb939350a60cf3d8d4d350bc8,
                    limb3: 0x4c10df6a979f5a47be0cd07
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x239000264ee57165a8063237,
                    limb1: 0x4b68386661726329d0714422,
                    limb2: 0x42c006e33cc8e97d1e781248,
                    limb3: 0x5f945e99855447c85f5638c
                },
                y: u384 {
                    limb0: 0xb0efbf0cfcfb8679fc94d713,
                    limb1: 0xfccc3dc4043415b49ff1c2c5,
                    limb2: 0xb939350a60cf3d8d4d350bc8,
                    limb3: 0x4c10df6a979f5a47be0cd07
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x239000264ee57165a8063237,
                    limb1: 0x4b68386661726329d0714422,
                    limb2: 0x42c006e33cc8e97d1e781248,
                    limb3: 0x5f945e99855447c85f5638c
                },
                y: u384 {
                    limb0: 0xb0efbf0cfcfb8679fc94d713,
                    limb1: 0xfccc3dc4043415b49ff1c2c5,
                    limb2: 0xb939350a60cf3d8d4d350bc8,
                    limb3: 0x4c10df6a979f5a47be0cd07
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x239000264ee57165a8063237,
                    limb1: 0x4b68386661726329d0714422,
                    limb2: 0x42c006e33cc8e97d1e781248,
                    limb3: 0x5f945e99855447c85f5638c
                },
                y: u384 {
                    limb0: 0xb0efbf0cfcfb8679fc94d713,
                    limb1: 0xfccc3dc4043415b49ff1c2c5,
                    limb2: 0xb939350a60cf3d8d4d350bc8,
                    limb3: 0x4c10df6a979f5a47be0cd07
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x239000264ee57165a8063237,
                    limb1: 0x4b68386661726329d0714422,
                    limb2: 0x42c006e33cc8e97d1e781248,
                    limb3: 0x5f945e99855447c85f5638c
                },
                y: u384 {
                    limb0: 0xb0efbf0cfcfb8679fc94d713,
                    limb1: 0xfccc3dc4043415b49ff1c2c5,
                    limb2: 0xb939350a60cf3d8d4d350bc8,
                    limb3: 0x4c10df6a979f5a47be0cd07
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x239000264ee57165a8063237,
                    limb1: 0x4b68386661726329d0714422,
                    limb2: 0x42c006e33cc8e97d1e781248,
                    limb3: 0x5f945e99855447c85f5638c
                },
                y: u384 {
                    limb0: 0xb0efbf0cfcfb8679fc94d713,
                    limb1: 0xfccc3dc4043415b49ff1c2c5,
                    limb2: 0xb939350a60cf3d8d4d350bc8,
                    limb3: 0x4c10df6a979f5a47be0cd07
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xdf0d6301488cac4e5a9414b840aaec7a, high: 0x19178a4ce8a56f31ac2c10d0c15648ff
            },
            u256 {
                low: 0x120961ea0913508715d38ca9986cc8d5, high: 0x444e45714e3c0f2d4332559dcad00273
            },
            u256 {
                low: 0xdc0520a487ba3b901e415c4e57030ede, high: 0x61893bfeeb83af16e404d8083fc18c00
            },
            u256 {
                low: 0xdc66a27b6a325333116e8a6429deb984, high: 0x1134b1138513d91e48622a674a294067
            },
            u256 {
                low: 0xbdce29ef674610eb8b279c29a274c0d7, high: 0x23a9a4a9c9c5fef1e76f8a76c74f11cd
            },
            u256 {
                low: 0x9177b6d45f2e9167713eceb14ad12b4c, high: 0xfc83c6a2835bcdb2347b24fa0f9c074
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x21464e0af20adcae67608e08,
                limb1: 0xa3f73f7924147f0b12b6b1e8,
                limb2: 0x24f4fae6b3bf889cdf54269,
                limb3: 0x9dc03bb17fccc271899116
            },
            y: u384 {
                limb0: 0x4f3b29935058e6e62295c943,
                limb1: 0x56f742027bacb2dd80cc5e13,
                limb2: 0x8d2e88d3552a3380691a29fa,
                limb3: 0x151dd00f508bbe9fde0f2ba
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xaa7d3bcb4a3a023c62ba438,
                limb1: 0xbf528581a0a426f78d8aaee7,
                limb2: 0x1623c349c5859e1a41ef24be,
                limb3: 0xbc8ff347fa4d3bc09dc4d1
            },
            y: u384 {
                limb0: 0x99034506dab09529098c6895,
                limb1: 0x1b0370ab92fd1c52f2cdc535,
                limb2: 0xa88c31acfd3b089ce3bdf5d9,
                limb3: 0x46e5b67f7656d7d3bfab04
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xf8dcef697aebfb6b0d2e6966,
                limb1: 0x405985e863588fcd1c48c270,
                limb2: 0x1cb8dd1e195a138390449565,
                limb3: 0x4138794a1bbf2543c43cfea
            },
            y: u384 {
                limb0: 0x67ab396f602d2c8511b409ea,
                limb1: 0xc65374bd5ec73f84e632b1b7,
                limb2: 0x9af4563ea698d5c8e5a846f,
                limb3: 0x1667f2bee6a4d514d7a1914c
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xc6451cf8541324aeeec8c4a4,
                    limb1: 0xb1ab8ba099ec154a24ba04ef,
                    limb2: 0xc45d34f4abfd6338ea5293a5,
                    limb3: 0xdff4b7acd1999b38d52b9b2
                },
                u384 {
                    limb0: 0xda75d0bb5b9196f50574c2ea,
                    limb1: 0xb39869507b587b10651d7f9f,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x6da40212d58515d9fd3abfc5,
                    limb1: 0xca29e04744f393d753f5da80,
                    limb2: 0x742d1726ecd2f0c041a3ca4d,
                    limb3: 0x14486756e51f07e889e9fcbb
                },
                u384 {
                    limb0: 0x6c7db1ce790eb1ebf098ea6c,
                    limb1: 0x77d15ac1712a13ef3b8409f4,
                    limb2: 0xfe3c5645bc72697e0717be0d,
                    limb3: 0x136a0bc4efaad55b539cb313
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xb725b2f7da331fd0711f64b9,
                    limb1: 0xb7bbf3399fd8f12b68ab2a39,
                    limb2: 0x7e2b59f65e83c678d0dda884,
                    limb3: 0x2e76f4717ccae0683260663
                },
                u384 {
                    limb0: 0x9597b6555608f7fc144b2ac5,
                    limb1: 0x44a4154766ba28e51ea0d442,
                    limb2: 0x51402a88d2e114b9b381cbb9,
                    limb3: 0x17054e95949e099724eadcc2
                },
                u384 {
                    limb0: 0xb506170cc568824c586508bd,
                    limb1: 0x971786b8807b616216291863,
                    limb2: 0x5ab544eba25ff56b67e4371a,
                    limb3: 0x15d8490a85aa90298a8f4cb2
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xa294084c28175767f4ebff13,
                    limb1: 0xf315093a2fbb6cf0f3d36a05,
                    limb2: 0x6d1561585e5e0722bfff0f8,
                    limb3: 0x31e679ce7fc6bd34654fbcb
                },
                u384 {
                    limb0: 0x4f4ec73a703cc7afc264545a,
                    limb1: 0x10e3c5c3d7466374b0b827d4,
                    limb2: 0x7259ff6828db0eee3554d2b7,
                    limb3: 0x19a60b3f4bab8838b83b7ce3
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x6da40212d58515d9fd3abfc5,
                    limb1: 0xca29e04744f393d753f5da80,
                    limb2: 0x742d1726ecd2f0c041a3ca4d,
                    limb3: 0x14486756e51f07e889e9fcbb
                },
                u384 {
                    limb0: 0x6c7db1ce790eb1ebf098ea6c,
                    limb1: 0x77d15ac1712a13ef3b8409f4,
                    limb2: 0xfe3c5645bc72697e0717be0d,
                    limb3: 0x136a0bc4efaad55b539cb313
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x5f28ff1de79b3c52c23394e0,
                    limb1: 0x589a10ea51f66bf595a711af,
                    limb2: 0xf3b54d8bda1b69faa3fe68c2,
                    limb3: 0xc8e2e133bb16f5c2384b541
                },
                u384 {
                    limb0: 0x1143c606efdbb06954f7b0e2,
                    limb1: 0xb39869507b587b125c2db24b,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xe8f9ef1f472cd7e1867d62b0,
                    limb1: 0x5811dfecb9599ec5e4016049,
                    limb2: 0x297389a0bc4f9e8f330f84d4,
                    limb3: 0x331864b2ae415f7ba5cbffd
                },
                u384 {
                    limb0: 0x831c2c1cb675ee7691cdd43c,
                    limb1: 0x5c7614b8f49a6c02c0b00cf5,
                    limb2: 0xea67e2aa6228c3ed931ddbb8,
                    limb3: 0x134b3c0d593054e204887f58
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xfee29f6948a982556276e4b0,
                    limb1: 0xd5ed491a7758e6535ab1d4a4,
                    limb2: 0xf0830850d14f546c0fc14877,
                    limb3: 0x5d0b269b5eb028e880b4518
                },
                u384 {
                    limb0: 0x4bffa12446fee0e63010eb0a,
                    limb1: 0x2bcb09421e911dbc0e0e2d5,
                    limb2: 0xaa790991116ca8b5f8beeecd,
                    limb3: 0x1504128c78975e5a0f2346ce
                },
                u384 {
                    limb0: 0x2a3ffc5867ea8cf41ac69fd0,
                    limb1: 0x76f15c9ca080c4d85201b718,
                    limb2: 0xce5af5b8e6eaf145b9f4bce3,
                    limb3: 0x59ee91478efa15fd9eed383
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xa3e7bc7d1cb35f8619f58ac0,
                    limb1: 0x60477fb2e5667b1790058127,
                    limb2: 0xa5ce2682f13e7a3ccc3e1351,
                    limb3: 0xcc6192cab9057dee972fff4
                },
                u384 {
                    limb0: 0xa9c8b07365d9b9da4737fb9a,
                    limb1: 0xa376ada1e507c3c2c56833d8,
                    limb2: 0x230830fabfb478ac656d4962,
                    limb3: 0x192acc60f1c186537beaadf7
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xe8f9ef1f472cd7e1867d62b0,
                    limb1: 0x5811dfecb9599ec5e4016049,
                    limb2: 0x297389a0bc4f9e8f330f84d4,
                    limb3: 0x331864b2ae415f7ba5cbffd
                },
                u384 {
                    limb0: 0x831c2c1cb675ee7691cdd43c,
                    limb1: 0x5c7614b8f49a6c02c0b00cf5,
                    limb2: 0xea67e2aa6228c3ed931ddbb8,
                    limb3: 0x134b3c0d593054e204887f58
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x7aecf79680af652c2989bab7,
                    limb1: 0xa8b97ecb6be9f2d630b8d994,
                    limb2: 0xb7731cf414d6c1da60487f37,
                    limb3: 0x65f9ce5f62e8d79a352cea8
                },
                u384 {
                    limb0: 0x302ea91a3b09524e7c49fbbb,
                    limb1: 0xb39869507b587b118b5d4593,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xe756247d0e34b32f04ad615f,
                    limb1: 0x451bc7973ca3c976650ea6d6,
                    limb2: 0xbd936ff3a9444d06ba21e092,
                    limb3: 0x6621dcb98610b936a215b35
                },
                u384 {
                    limb0: 0xadcf3cd98a6f64712ca59d0d,
                    limb1: 0x6784c736f2b43f5f74d88ea6,
                    limb2: 0x106f0c6f859799e72151589b,
                    limb3: 0x1530fa624fc9a70a4e3a12fb
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x2c85372e90e4c61d953322bb,
                    limb1: 0xb04346c095621ee0594cc237,
                    limb2: 0x591b246aeac7bb99acfb16dc,
                    limb3: 0xd18fa4253b2bad688138824
                },
                u384 {
                    limb0: 0xd5f7dd6eb4ebaf4072cfef2,
                    limb1: 0x9fd947166aafb424f9c833a7,
                    limb2: 0x7a42105259b9287156d8804f,
                    limb3: 0xc744e7c6b4e7a127eb512e6
                },
                u384 {
                    limb0: 0x8c5ccc74537f927485acd1fa,
                    limb1: 0x4e75dea2404e9fd4e4e79616,
                    limb2: 0xed6c506ef83753408862ded6,
                    limb3: 0x17fa7f9356d5bbd856a6ea16
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x9d5891f438d2ccbc12b5857c,
                    limb1: 0x146f1e5cf28f25d9943a9b5b,
                    limb2: 0xf64dbfcea511341ae8878249,
                    limb3: 0x1988772e61842e4da8856cd6
                },
                u384 {
                    limb0: 0xa340f366fbc091c4b2977433,
                    limb1: 0x6880a4f8e6be1b11775e3a9e,
                    limb2: 0x77d92b37e8f8850daab62a2f,
                    limb3: 0x6c0b3ca92a6e85a579554c9
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xe756247d0e34b32f04ad615f,
                    limb1: 0x451bc7973ca3c976650ea6d6,
                    limb2: 0xbd936ff3a9444d06ba21e092,
                    limb3: 0x6621dcb98610b936a215b35
                },
                u384 {
                    limb0: 0xadcf3cd98a6f64712ca59d0d,
                    limb1: 0x6784c736f2b43f5f74d88ea6,
                    limb2: 0x106f0c6f859799e72151589b,
                    limb3: 0x1530fa624fc9a70a4e3a12fb
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x7dc1de8818f531f94adb9a23,
            limb1: 0xf30801cd172cd8d8fa64fa64,
            limb2: 0x580c94af72b38211f2cab3,
            limb3: 0xa9a1e37b509d1317dcecc7c
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x7ca32a07727b10c78edca13c,
                    limb1: 0xa0a55ea63eed0b3ab286ca60,
                    limb2: 0x5541d55591002cae6e74e3e0,
                    limb3: 0x37997e5273a798c20766c78
                },
                y: u384 {
                    limb0: 0x3fc24e4bcdf4efa560cad9d8,
                    limb1: 0xc97397161276eab5229a731f,
                    limb2: 0x53ae4b52f0e19d10acc85ace,
                    limb3: 0x2e6831d476465dbea127815
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_7_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x888c7d5930049fcb4caf74d8,
                    limb1: 0xdfb36d5be8f11be9a561ddd4,
                    limb2: 0x61a3932a88ddf701ca978256,
                    limb3: 0x1825c0a7cbe4778ca87156cb
                },
                y: u384 {
                    limb0: 0x688b9c389c72628bb4a75c05,
                    limb1: 0x4c564ec83401b6120cd1e6a1,
                    limb2: 0x46922ec0e65b03ca8230d85c,
                    limb3: 0x544221fbeadbaa22a0d5621
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x888c7d5930049fcb4caf74d8,
                    limb1: 0xdfb36d5be8f11be9a561ddd4,
                    limb2: 0x61a3932a88ddf701ca978256,
                    limb3: 0x1825c0a7cbe4778ca87156cb
                },
                y: u384 {
                    limb0: 0x688b9c389c72628bb4a75c05,
                    limb1: 0x4c564ec83401b6120cd1e6a1,
                    limb2: 0x46922ec0e65b03ca8230d85c,
                    limb3: 0x544221fbeadbaa22a0d5621
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x888c7d5930049fcb4caf74d8,
                    limb1: 0xdfb36d5be8f11be9a561ddd4,
                    limb2: 0x61a3932a88ddf701ca978256,
                    limb3: 0x1825c0a7cbe4778ca87156cb
                },
                y: u384 {
                    limb0: 0x688b9c389c72628bb4a75c05,
                    limb1: 0x4c564ec83401b6120cd1e6a1,
                    limb2: 0x46922ec0e65b03ca8230d85c,
                    limb3: 0x544221fbeadbaa22a0d5621
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x888c7d5930049fcb4caf74d8,
                    limb1: 0xdfb36d5be8f11be9a561ddd4,
                    limb2: 0x61a3932a88ddf701ca978256,
                    limb3: 0x1825c0a7cbe4778ca87156cb
                },
                y: u384 {
                    limb0: 0x688b9c389c72628bb4a75c05,
                    limb1: 0x4c564ec83401b6120cd1e6a1,
                    limb2: 0x46922ec0e65b03ca8230d85c,
                    limb3: 0x544221fbeadbaa22a0d5621
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x888c7d5930049fcb4caf74d8,
                    limb1: 0xdfb36d5be8f11be9a561ddd4,
                    limb2: 0x61a3932a88ddf701ca978256,
                    limb3: 0x1825c0a7cbe4778ca87156cb
                },
                y: u384 {
                    limb0: 0x688b9c389c72628bb4a75c05,
                    limb1: 0x4c564ec83401b6120cd1e6a1,
                    limb2: 0x46922ec0e65b03ca8230d85c,
                    limb3: 0x544221fbeadbaa22a0d5621
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x888c7d5930049fcb4caf74d8,
                    limb1: 0xdfb36d5be8f11be9a561ddd4,
                    limb2: 0x61a3932a88ddf701ca978256,
                    limb3: 0x1825c0a7cbe4778ca87156cb
                },
                y: u384 {
                    limb0: 0x688b9c389c72628bb4a75c05,
                    limb1: 0x4c564ec83401b6120cd1e6a1,
                    limb2: 0x46922ec0e65b03ca8230d85c,
                    limb3: 0x544221fbeadbaa22a0d5621
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x888c7d5930049fcb4caf74d8,
                    limb1: 0xdfb36d5be8f11be9a561ddd4,
                    limb2: 0x61a3932a88ddf701ca978256,
                    limb3: 0x1825c0a7cbe4778ca87156cb
                },
                y: u384 {
                    limb0: 0x688b9c389c72628bb4a75c05,
                    limb1: 0x4c564ec83401b6120cd1e6a1,
                    limb2: 0x46922ec0e65b03ca8230d85c,
                    limb3: 0x544221fbeadbaa22a0d5621
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xa1d20ebc5aa3892a4c88b9d8ab12fb53, high: 0x1be7c0126a447a90be0a5a5679009c61
            },
            u256 {
                low: 0x248f4a254cd8ef2471a8c9c60f6ab75b, high: 0x719433690d6a78b07eda9ab9bec60ffe
            },
            u256 {
                low: 0xfa999f9b86de3365d8a230de02969326, high: 0xa6a6d6bddfae808afd8643211035083
            },
            u256 {
                low: 0xecb3d561bdf0b015f305ee95afb120f4, high: 0x2e3e5e3101a4f7a165264961ab4414ae
            },
            u256 {
                low: 0xf520f49ef1c8461dbc24fd0a8aa1e4, high: 0x51f7c017df8693ce453432cdffeb5d5f
            },
            u256 {
                low: 0xe695f8baba2338fe4ae302f3b31e9be8, high: 0x495328ebc069c542240397213a082921
            },
            u256 {
                low: 0x6f1bdd071aff71ae30f2c48549b564fb, high: 0x312b2d4a5487b5c3b7626f4975fd3537
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xf6e8263aa2876a7cc7c43732,
                limb1: 0xf3b33f22f9bd9de0bfb09dd,
                limb2: 0xe84a7aee42f73a7ba499d781,
                limb3: 0xc0868ef01420ca66636501a
            },
            y: u384 {
                limb0: 0xd0d6d4150e50aa5228249c77,
                limb1: 0x4dfa9a3fd52bf8150cbd26e1,
                limb2: 0x71189912160bd8560e5548e7,
                limb3: 0x101ed1ef5b886b5a12c94713
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xe1620b357fa4e9ba61694a36,
                limb1: 0x8426557f9a825488f3636a13,
                limb2: 0x210740f0a334e6a60aca6e48,
                limb3: 0x104116b2b5f3aef66dc04495
            },
            y: u384 {
                limb0: 0x9c8b8833060970609a90f5fb,
                limb1: 0x3c427588b6ba54bc9024b605,
                limb2: 0xbc316aa0ca0046eafcfa64b8,
                limb3: 0xd5216c424339e09c7ada8b3
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xf9a26973537151c19383a296,
                limb1: 0x5dc600b7447505b2825052e5,
                limb2: 0xd02770835d1352889a49f008,
                limb3: 0x10af1412ae467e936a5e5b74
            },
            y: u384 {
                limb0: 0xba66710f31b0cb0259215f4f,
                limb1: 0x673e92ee8955fde5c8aeb911,
                limb2: 0xdf93e48c8dd8e71e3805edd3,
                limb3: 0x77a0892785d534893bfe1b2
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x80fbc64c6a9734875d813162,
                    limb1: 0x864e79e8113346fc42cb39c8,
                    limb2: 0xeea01de051dda61edd1acb61,
                    limb3: 0xe0aa07865406e327097a7a
                },
                u384 {
                    limb0: 0x6b757f3bdd5bd302f580a15b,
                    limb1: 0x6730d2a0f6b0f6231ea06843,
                    limb2: 0x434bacd764774b84f38512bf,
                    limb3: 0x1a0111ea397fe69a4b1ba7b6
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x29fa609608369c5ae0737c51,
                    limb1: 0x72edf4d4b175da56ed9bcd16,
                    limb2: 0x4b2b23d072a905edb239690b,
                    limb3: 0xe0bdb8d20af66088ebc3bf1
                },
                u384 {
                    limb0: 0xe3335c6ba171f5b7eb8ba94c,
                    limb1: 0xdf7303f3d4d4f6808bfb184a,
                    limb2: 0x3ca94b95fd19658c77d8cba6,
                    limb3: 0xfd3fa3da5d94901878fa886
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xf10acf182dc1a27927572dd1,
                    limb1: 0x76f6e249b8bc760307d1b7ce,
                    limb2: 0x528f34d825b540503e0835af,
                    limb3: 0xf36dc8ce13e6729cb404c20
                },
                u384 {
                    limb0: 0xc85a40e38e6718d91dbf4de6,
                    limb1: 0x7eacf8b2c742b5adfa6f94b,
                    limb2: 0x37fe405c6c10ad67e1b67bde,
                    limb3: 0x1123115a95292619a7c29d98
                },
                u384 {
                    limb0: 0x21456fb93d6bc4c32b844e89,
                    limb1: 0xfa986e4d593535e004333221,
                    limb2: 0x4231c3b9b5aeec66552cceff,
                    limb3: 0x5ecc06e77873bb90d8a2188
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x45418258acdc716b81ce9bee,
                    limb1: 0xfd562e10d8757d137917345b,
                    limb2: 0xa615359301b580ace1db7eae,
                    limb3: 0x42d4a600fbdcaeda4b9a058
                },
                u384 {
                    limb0: 0x2a2571af11c9d6dfae2f4fda,
                    limb1: 0xaf6a6a8d65f1edb9f294612e,
                    limb2: 0x6c0dd4a92b76ff27f859091c,
                    limb3: 0xb4dc522246556d1880752ac
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x29fa609608369c5ae0737c51,
                    limb1: 0x72edf4d4b175da56ed9bcd16,
                    limb2: 0x4b2b23d072a905edb239690b,
                    limb3: 0xe0bdb8d20af66088ebc3bf1
                },
                u384 {
                    limb0: 0xe3335c6ba171f5b7eb8ba94c,
                    limb1: 0xdf7303f3d4d4f6808bfb184a,
                    limb2: 0x3ca94b95fd19658c77d8cba6,
                    limb3: 0xfd3fa3da5d94901878fa886
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xc8b7f8374bc35758fba2a0b6,
                    limb1: 0x7292b987558adcb3b85795a8,
                    limb2: 0xa4504c43845c3f75b73862df,
                    limb3: 0x2470584b8f466bf294509d
                },
                u384 {
                    limb0: 0xb184bc53457a74e036e5d20a, limb1: 0x62cdf411, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x2c9407defe69558b90682e8c,
                    limb1: 0xc5cc35e8038526f7f6d266d5,
                    limb2: 0xb7d5fedcf310d422bc56c33c,
                    limb3: 0x10779049860dbe8ebd781f82
                },
                u384 {
                    limb0: 0xf8b97770c454767a51e69648,
                    limb1: 0x6a87e26669ee7bd5a492b814,
                    limb2: 0x3ec85939cdbb96211a834df,
                    limb3: 0xb9b4c79f127a6b18005b40c
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x66350e8661ebe4ddf35d8d83,
                    limb1: 0x356894f213989545971fc137,
                    limb2: 0x2d6b706da40fd8a992d371a5,
                    limb3: 0xeeb5810cc4f93147c0a5248
                },
                u384 {
                    limb0: 0x59bbcee76dbd8305ec97fa65,
                    limb1: 0xc104bfda81f313e8f0146cbf,
                    limb2: 0x8c7cf8b2b22d79c5127693be,
                    limb3: 0x44e25df414ca1280cdd2360
                },
                u384 {
                    limb0: 0xf3c1c52144dbf1cb1a65f1c9,
                    limb1: 0x184b72b3e02e8562bb816f05,
                    limb2: 0xf767d6dd246818ad6f087ce5,
                    limb3: 0x9f51caf5c4b64c6dbe64d4c
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x4fa81f7c85a7562e41a164da,
                    limb1: 0x48cf325e20b2af979df19b57,
                    limb2: 0x58c0a1c50354b9810a50e774,
                    limb3: 0xddc1d51a5372d065fa92e9e
                },
                u384 {
                    limb0: 0x3191ddc35752d9e9479aae75,
                    limb1: 0x42eeb6f8b108f932739ee055,
                    limb2: 0xcc6669770ef79a03531bc0be,
                    limb3: 0x146c1ffd8b1eb42bb4fb2879
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x2c9407defe69558b90682e8c,
                    limb1: 0xc5cc35e8038526f7f6d266d5,
                    limb2: 0xb7d5fedcf310d422bc56c33c,
                    limb3: 0x10779049860dbe8ebd781f82
                },
                u384 {
                    limb0: 0xf8b97770c454767a51e69648,
                    limb1: 0x6a87e26669ee7bd5a492b814,
                    limb2: 0x3ec85939cdbb96211a834df,
                    limb3: 0xb9b4c79f127a6b18005b40c
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xe7cd0057c5e79bac851d98a4,
                    limb1: 0xa2169e3bc4ac0b14fc1de1e5,
                    limb2: 0xa000d04c3e8a594e8b3d7313,
                    limb3: 0x8ce119c266600e7c4bef8d7
                },
                u384 {
                    limb0: 0x302ea91a3b09524e7c49fbbb,
                    limb1: 0xb39869507b587b118b5d4593,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x56e48b62bbc995b1e85ed0d1,
                    limb1: 0x6e6f7a0fe42f03d9a0e22053,
                    limb2: 0x241a36779518d3f046045eff,
                    limb3: 0x78c2311013107df732c8e6b
                },
                u384 {
                    limb0: 0x87a38b56a0e7c4840b12688a,
                    limb1: 0xec754f0b0e6a920cc7a44303,
                    limb2: 0x9568a83ac8a65ddb41f5c72d,
                    limb3: 0x1311f90f0ec59faabe18af62
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x2aaa1d26c3127cce0b9c5628,
                    limb1: 0xb447743e459125ec8d9dc145,
                    limb2: 0x2725737c6875aaecaf231587,
                    limb3: 0xf19aeef1f54e69b18702f2
                },
                u384 {
                    limb0: 0xcd3340dfc5c7d743a5d169a2,
                    limb1: 0xeda40463e4019e11290ea913,
                    limb2: 0x871da10b73b319429b24a2b5,
                    limb3: 0xf2813a643b26a52884310d4
                },
                u384 {
                    limb0: 0x70aea18ecd479fa9e90b27b6,
                    limb1: 0xce6c72bb36ecd5b725e3985c,
                    limb2: 0x386af49c376985a5b82810c3,
                    limb3: 0x1e292e351f2468345a24359
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xaa3e2d8b352756c7a17b9899,
                    limb1: 0x528d159e9a0b194264dc814e,
                    limb2: 0x4d1d2d06efec043c248c693e,
                    limb3: 0x42f7a59cb4438e3819691f6
                },
                u384 {
                    limb0: 0xbbe62d5b0fa112102c4a4cd2,
                    limb1: 0xe37396ea4c485beae1390c10,
                    limb2: 0xcf0b473c59aae06320ccf738,
                    limb3: 0x1845c067c816b176622b6e1d
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x56e48b62bbc995b1e85ed0d1,
                    limb1: 0x6e6f7a0fe42f03d9a0e22053,
                    limb2: 0x241a36779518d3f046045eff,
                    limb3: 0x78c2311013107df732c8e6b
                },
                u384 {
                    limb0: 0x87a38b56a0e7c4840b12688a,
                    limb1: 0xec754f0b0e6a920cc7a44303,
                    limb2: 0x9568a83ac8a65ddb41f5c72d,
                    limb3: 0x1311f90f0ec59faabe18af62
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xa254eac63a892ee37d223123,
            limb1: 0xa1087f4e19f5498713eb2a57,
            limb2: 0xd572a17dbbc78a38408ddf1f,
            limb3: 0xb52aedc94febd3aff4f756c
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x17f8770f1c2eb2770b843f8a,
                limb1: 0x548a732a12ddba47d93a424b,
                limb2: 0x20180d689b6d17bb207f114f,
                limb3: 0xac414210ccc7b3a7e2994e
            },
            u384 {
                limb0: 0xcfc830854fca6d21f4a7b001,
                limb1: 0xaf69d496e5ec93ae42cad392,
                limb2: 0xe8643ba958e16e72ac9e9c9,
                limb3: 0xc874bfb4bee27275035d392
            },
            u384 {
                limb0: 0xa08eedfa592b475c39d51051,
                limb1: 0x5c1c9035a3295a577ac7b4e1,
                limb2: 0x79c1d6785cd409301fd21fdc,
                limb3: 0x21146d11ea22f312b739d3d
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x8eec597ac01d5b1af11a57ce,
                    limb1: 0x1f02fbd7b503c52f302c63d0,
                    limb2: 0xfe5ec6ef31e844b792aa4606,
                    limb3: 0x12bbd4a6fa4a6c30cfdf46c0
                },
                y: u384 {
                    limb0: 0x8a06fbf8404b4e2fc912c6bd,
                    limb1: 0x92e17cb5b55304183b3c3747,
                    limb2: 0xf17335eba65a63ea10281d83,
                    limb3: 0xd7012e0b4122ac1148b0966
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_8_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x90ae5ec475dfad2f54c4d73c,
                    limb1: 0xe4e1dce2e5dd186725513b53,
                    limb2: 0x6ab2435a9209c67f79de0474,
                    limb3: 0x79f7ea111ce28a77c0b051b
                },
                y: u384 {
                    limb0: 0xe042559d975f37f741fdd752,
                    limb1: 0x505fbfd56d2f613085e0511b,
                    limb2: 0x2a8f034ff88eb3911a45df4d,
                    limb3: 0x9cbcae2ca9d06fb13932394
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x90ae5ec475dfad2f54c4d73c,
                    limb1: 0xe4e1dce2e5dd186725513b53,
                    limb2: 0x6ab2435a9209c67f79de0474,
                    limb3: 0x79f7ea111ce28a77c0b051b
                },
                y: u384 {
                    limb0: 0xe042559d975f37f741fdd752,
                    limb1: 0x505fbfd56d2f613085e0511b,
                    limb2: 0x2a8f034ff88eb3911a45df4d,
                    limb3: 0x9cbcae2ca9d06fb13932394
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x90ae5ec475dfad2f54c4d73c,
                    limb1: 0xe4e1dce2e5dd186725513b53,
                    limb2: 0x6ab2435a9209c67f79de0474,
                    limb3: 0x79f7ea111ce28a77c0b051b
                },
                y: u384 {
                    limb0: 0xe042559d975f37f741fdd752,
                    limb1: 0x505fbfd56d2f613085e0511b,
                    limb2: 0x2a8f034ff88eb3911a45df4d,
                    limb3: 0x9cbcae2ca9d06fb13932394
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x90ae5ec475dfad2f54c4d73c,
                    limb1: 0xe4e1dce2e5dd186725513b53,
                    limb2: 0x6ab2435a9209c67f79de0474,
                    limb3: 0x79f7ea111ce28a77c0b051b
                },
                y: u384 {
                    limb0: 0xe042559d975f37f741fdd752,
                    limb1: 0x505fbfd56d2f613085e0511b,
                    limb2: 0x2a8f034ff88eb3911a45df4d,
                    limb3: 0x9cbcae2ca9d06fb13932394
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x90ae5ec475dfad2f54c4d73c,
                    limb1: 0xe4e1dce2e5dd186725513b53,
                    limb2: 0x6ab2435a9209c67f79de0474,
                    limb3: 0x79f7ea111ce28a77c0b051b
                },
                y: u384 {
                    limb0: 0xe042559d975f37f741fdd752,
                    limb1: 0x505fbfd56d2f613085e0511b,
                    limb2: 0x2a8f034ff88eb3911a45df4d,
                    limb3: 0x9cbcae2ca9d06fb13932394
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x90ae5ec475dfad2f54c4d73c,
                    limb1: 0xe4e1dce2e5dd186725513b53,
                    limb2: 0x6ab2435a9209c67f79de0474,
                    limb3: 0x79f7ea111ce28a77c0b051b
                },
                y: u384 {
                    limb0: 0xe042559d975f37f741fdd752,
                    limb1: 0x505fbfd56d2f613085e0511b,
                    limb2: 0x2a8f034ff88eb3911a45df4d,
                    limb3: 0x9cbcae2ca9d06fb13932394
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x90ae5ec475dfad2f54c4d73c,
                    limb1: 0xe4e1dce2e5dd186725513b53,
                    limb2: 0x6ab2435a9209c67f79de0474,
                    limb3: 0x79f7ea111ce28a77c0b051b
                },
                y: u384 {
                    limb0: 0xe042559d975f37f741fdd752,
                    limb1: 0x505fbfd56d2f613085e0511b,
                    limb2: 0x2a8f034ff88eb3911a45df4d,
                    limb3: 0x9cbcae2ca9d06fb13932394
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x90ae5ec475dfad2f54c4d73c,
                    limb1: 0xe4e1dce2e5dd186725513b53,
                    limb2: 0x6ab2435a9209c67f79de0474,
                    limb3: 0x79f7ea111ce28a77c0b051b
                },
                y: u384 {
                    limb0: 0xe042559d975f37f741fdd752,
                    limb1: 0x505fbfd56d2f613085e0511b,
                    limb2: 0x2a8f034ff88eb3911a45df4d,
                    limb3: 0x9cbcae2ca9d06fb13932394
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x25c29b6ab575bc6eeee84bcb7281b8a9, high: 0x1abc1fb32114c2d650ea1324862f78e1
            },
            u256 {
                low: 0x596305b371b221e42fd3b9f2e90f79f8, high: 0x36b17206638d521afbc59e92ca1209ad
            },
            u256 {
                low: 0xbad3116b63b8a8977df0fe6bce8d75f2, high: 0x383a10ea3239d04bcbab5b51385c5fdc
            },
            u256 {
                low: 0xb5c25d429626d8c4344af454f0a61c5e, high: 0x4427e8b636abf8ce7e3f52c0cbf404d
            },
            u256 {
                low: 0xdefa786415ac15c3a217cf253be95767, high: 0x5f1ff57e0e96ed9b5d158e442fcf3b87
            },
            u256 {
                low: 0x3baa17f92c623ac3ad7027cfa358cb1d, high: 0xb16ae399ccd3e1f4c2abdaa9c5c11eb
            },
            u256 {
                low: 0xc061c99b831a352ade6c8762b475e15e, high: 0x71048fa4e0a10d2bc57c799848d002be
            },
            u256 {
                low: 0xdcf035b7552c6e86953a1155a62ddc4, high: 0x55335a328420b8d9b261d0d2a1c2d9bf
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x4768b216a032e7da06347cf,
                limb1: 0x92ad0785451207554b28657d,
                limb2: 0x7854e7d91c063ca945914ce3,
                limb3: 0xa8f93e354c4442a6fc7c5be
            },
            y: u384 {
                limb0: 0x8d4b752b802654b1752e28ef,
                limb1: 0x9fd188a1f2b5c5ca11d6672f,
                limb2: 0xe285ca66bb61e70d0c27aab9,
                limb3: 0xf15447c32824e62b21f34b5
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x8029d37c26633fecba10b996,
                limb1: 0xe1f25729d1255c8d742ddc08,
                limb2: 0x3f833e10585b79b2165445c4,
                limb3: 0x7d06b8684501913949aad7d
            },
            y: u384 {
                limb0: 0xd3e5d4724cf651d62763f672,
                limb1: 0xc4c2c11e9407313cf77a0522,
                limb2: 0x463c07808e93ebb16dcc62a7,
                limb3: 0xbdeac40be3612a84cf3c2d1
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x88de293a325f1141a74360ce,
                limb1: 0xef3e0b47347c9d61ae81e492,
                limb2: 0xd245c601d72a0594f749f875,
                limb3: 0x157597b006d64f7d95ea30cc
            },
            y: u384 {
                limb0: 0xc309a3b53e0f37ee4bc9be27,
                limb1: 0xda9a220ee5d5983c4b9f3df0,
                limb2: 0x3251279f4429b450d7644a86,
                limb3: 0x10546ab9cbd0cd7da1b617c1
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x5bbb4592d191a9d648597fba,
                    limb1: 0xa020cd0ae598bc4519956299,
                    limb2: 0x6a121fd731f41f0cc021d45c,
                    limb3: 0x19bd050d1f162d9d5714b5ed
                },
                u384 {
                    limb0: 0x4218322917023780c194fbf9,
                    limb1: 0x6730d2a0f6b0f622760feb33,
                    limb2: 0x434bacd764774b84f38512bf,
                    limb3: 0x1a0111ea397fe69a4b1ba7b6
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xe6f10a7f3d3f2c80d2d0b91b,
                    limb1: 0x73fb1bed2a7e9a08e943fa58,
                    limb2: 0xf2ebb4c0e2c217ea6f89a54c,
                    limb3: 0x76cb4d31d5d019de6798dbd
                },
                u384 {
                    limb0: 0x1c2f1619da1c24530ad78ba0,
                    limb1: 0xefa1ee38cbc1d667ae325f2e,
                    limb2: 0x604481a3b667485c3415c166,
                    limb3: 0x7d1ff65d2ed79c85f48dcdc
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x744c5a7f20a849005f07f24f,
                    limb1: 0x2ccd7ca2f87b01f747c0e22d,
                    limb2: 0x67cbef0a4788b682af564d9,
                    limb3: 0x31e523eee3c85768dfb6eda
                },
                u384 {
                    limb0: 0x5cbd91ae09a0cf322682c2ec,
                    limb1: 0x77b6fd7e3fcd73cbb1799d2a,
                    limb2: 0x83b7220cb83e1b91778060ef,
                    limb3: 0xa435b291e78928528fb4f21
                },
                u384 {
                    limb0: 0xac1e102bc6a450b29e163921,
                    limb1: 0xa4c6670e54a4aef956b360cb,
                    limb2: 0xa5c1c01719b6d4a7789eb42f,
                    limb3: 0xd3f98e9300a77cf027fc31a
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xea7029fd3afdb2034b4339c1,
                    limb1: 0x68bb9d13b34971ff8663e964,
                    limb2: 0x8863262c26911424caa18272,
                    limb3: 0x3b1c1623bf41fdd4eca8f41
                },
                u384 {
                    limb0: 0xbf685867ae71914c2b5e83d5,
                    limb1: 0x5756e6423856637a9a1d7cb9,
                    limb2: 0x3dc659b77525d5ebdcd1f2dc,
                    limb3: 0x546ebad123600873207cbbb
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xe6f10a7f3d3f2c80d2d0b91b,
                    limb1: 0x73fb1bed2a7e9a08e943fa58,
                    limb2: 0xf2ebb4c0e2c217ea6f89a54c,
                    limb3: 0x76cb4d31d5d019de6798dbd
                },
                u384 {
                    limb0: 0x1c2f1619da1c24530ad78ba0,
                    limb1: 0xefa1ee38cbc1d667ae325f2e,
                    limb2: 0x604481a3b667485c3415c166,
                    limb3: 0x7d1ff65d2ed79c85f48dcdc
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xfa7bafcce93bf5b0e76a0603,
                    limb1: 0xcbb43e10a2895b89500a35bb,
                    limb2: 0x7404d9eebf9df5905bc2757a,
                    limb3: 0xd1209f429d78f235e9e6ee3
                },
                u384 {
                    limb0: 0xc9785a080e9908673db51898,
                    limb1: 0xb39869507b587b12c41e6b3e,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x22e1a8ec6823b8b14ce1764b,
                    limb1: 0xc4d634275c7184f941b7fb88,
                    limb2: 0xb84ccd8aee15331cbd8d2a97,
                    limb3: 0x450bcd819350b59f2e56c41
                },
                u384 {
                    limb0: 0xa07bcdbf1dbc12e3f12a19d9,
                    limb1: 0xa05c9e943fae812f852ce8a2,
                    limb2: 0x99162b6c7a120b536352c885,
                    limb3: 0xa9127c2a361a4df3a75f51d
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x71847553aa0ec69be025a2df,
                    limb1: 0xe07043202017e813666b6d68,
                    limb2: 0xf723473c4280ce24bd17f7b9,
                    limb3: 0x10b88e0ff4de64ee88c1bcf4
                },
                u384 {
                    limb0: 0x6f6328fe61d8de56112cb08d,
                    limb1: 0x63b83db435ee58eb98fc3ed7,
                    limb2: 0x60ec56d907bc6c155e2cd47c,
                    limb3: 0xda1fb0802ef486a4d2ee90e
                },
                u384 {
                    limb0: 0xb31846b0774c56479b6c508a,
                    limb1: 0x2ef03427708fb5d78c03c9a0,
                    limb2: 0x7ebd32604929f04aec546359,
                    limb3: 0x24a7b4f1a018900b429ab85
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x8b86a3b1a08ee2c53385d92c,
                    limb1: 0x1358d09d71c613e506dfee20,
                    limb2: 0xe133362bb854cc72f634aa5f,
                    limb3: 0x1142f36064d42d67cb95b106
                },
                u384 {
                    limb0: 0xd09b36fcbcf14b8fc4a8bcb9,
                    limb1: 0x1a41a7b008090e99f607a28b,
                    limb2: 0x210d00da83d0e1c899c60f57,
                    limb3: 0x10438d205406ace29ebc2cc0
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x22e1a8ec6823b8b14ce1764b,
                    limb1: 0xc4d634275c7184f941b7fb88,
                    limb2: 0xb84ccd8aee15331cbd8d2a97,
                    limb3: 0x450bcd819350b59f2e56c41
                },
                u384 {
                    limb0: 0xa07bcdbf1dbc12e3f12a19d9,
                    limb1: 0xa05c9e943fae812f852ce8a2,
                    limb2: 0x99162b6c7a120b536352c885,
                    limb3: 0xa9127c2a361a4df3a75f51d
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xfc0fd8f8c3bd222634c6c40b,
                    limb1: 0xf84d0dc86aaf43ff8742f90b,
                    limb2: 0x389f36dfa103a2ec68bcfd93,
                    limb3: 0x18afbbb14583bf6a183d27d8
                },
                u384 {
                    limb0: 0x302ea91a3b09524e7c49fbbb,
                    limb1: 0xb39869507b587b118b5d4593,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x8f80135f637ea41788171a79,
                    limb1: 0x486f6efd71894b17626aef65,
                    limb2: 0x1945f49e90dc1ad18786e378,
                    limb3: 0x39fe5dde393de516e7bc178
                },
                u384 {
                    limb0: 0x59a003491b3baed19eab3af2,
                    limb1: 0xfd3142d0e7bff2591aa83f62,
                    limb2: 0x74ce559c996917c2d96be743,
                    limb3: 0x16bc209de7d964a36bb27122
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x24bea6815391a99020816b90,
                    limb1: 0xeb01508a07493f3647630026,
                    limb2: 0xac2fbae62d4eb678715eb803,
                    limb3: 0x984234ab81b6053ffb1c23e
                },
                u384 {
                    limb0: 0x5ceb5ca837dd677a7d35bb06,
                    limb1: 0x68bcdbb687c197a8cebc2cc0,
                    limb2: 0x6e146d0982e00bb55e64d989,
                    limb3: 0x25a009ba748b3796fd2601
                },
                u384 {
                    limb0: 0xe48f0cbb97da36b7f0dbe298,
                    limb1: 0x35cac696e5fef184891d27a1,
                    limb2: 0x9bb04cb794a8e8283fa472ef,
                    limb3: 0xe0f0886ecbcbe92a22f0bfd
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x3e004d7d8dfa905e205c69e4,
                    limb1: 0x21bdbbf5c6252c5d89abbd96,
                    limb2: 0x6517d27a43706b461e1b8de1,
                    limb3: 0xe7f97778e4f7945b9ef05e0
                },
                u384 {
                    limb0: 0x52840d253ef1bb467aadebc7,
                    limb1: 0xbf329360baece6f80e9cfd8d,
                    limb2: 0x9564fec383e7c7c8b2064d1,
                    limb3: 0xced4cb8f2e5debecd76cd67
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x8f80135f637ea41788171a79,
                    limb1: 0x486f6efd71894b17626aef65,
                    limb2: 0x1945f49e90dc1ad18786e378,
                    limb3: 0x39fe5dde393de516e7bc178
                },
                u384 {
                    limb0: 0x59a003491b3baed19eab3af2,
                    limb1: 0xfd3142d0e7bff2591aa83f62,
                    limb2: 0x74ce559c996917c2d96be743,
                    limb3: 0x16bc209de7d964a36bb27122
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x38eb0e49052f87bcf10f5ebb,
            limb1: 0x5905cb5bb0ec15b7023efaf8,
            limb2: 0x6b4f52efb62a2c603b81e3b9,
            limb3: 0x9adb4c08794c617d0f5e70c
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0xdb8ad0fc929eb575ada32f09,
                limb1: 0xa234720bb2f457add55be7df,
                limb2: 0xe852e237d767d0d3add412f0,
                limb3: 0x42fad3e1cd8f8a2f3b0bea1
            },
            u384 {
                limb0: 0x46a9d73065d4b0b3f583f9a,
                limb1: 0xb2a7ac3c3e5eed4fb92f1b0f,
                limb2: 0x502139950b2feeb2bc00e88f,
                limb3: 0xa782cbfed92d503585ab533
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xddd6a84745c8e3f370208aef,
                    limb1: 0xe6704191de1938989b8adf6b,
                    limb2: 0x4aec90bfc2f5a82ce11d490f,
                    limb3: 0x3e0e1d994c908691096fe17
                },
                y: u384 {
                    limb0: 0x908ca62e9524a52c0264dc8d,
                    limb1: 0x1ac875439d3b04da2200ce21,
                    limb2: 0x1d172540f5bb1d053d75e0f9,
                    limb3: 0x795ec9d790a10e513f8e82f
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_1_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x2f6983e0d236d0346ab5fac,
                    limb1: 0x468cddf0a009031a0723bc05,
                    limb2: 0xe1a43b84c48835b8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x851987ea1e040a7e2008f98f,
                    limb1: 0xcee64ec2c11426433004d1bd,
                    limb2: 0xe3c28a89c698136,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x413770e27d7de1f57460d20d94b9cdb5, high: 0x56525ce03725bd0c79c45c38b440ffe0
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xb81939475ca5ede42585ce87,
                limb1: 0xa2bc9e85cb9356924bce5992,
                limb2: 0x145b704fed3cee46,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x5128f62555b0e9e879195e4d,
                limb1: 0x2b13b2c1ee00c1d29e2fe7b2,
                limb2: 0xcaac662595652a19,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xf5e8f18ac66afc2f38caaef8,
                limb1: 0x43db9a4ec3ee81f9f4b521b,
                limb2: 0x2d784fbb34f0fb6c,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xe9623fe98e93ba05686b3e76,
                limb1: 0x35aff5a8773fdc899c02dd0a,
                limb2: 0xb66605d277385ad7,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x4d5fc83b33f7123751a3567d,
                limb1: 0x89cb11d30450db78f98172bf,
                limb2: 0x860662b18feb402c,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x96630c20750fa49ebaaa1a0c,
                limb1: 0x283e26b777ba93b62a7bf138,
                limb2: 0x9415d3be9089cfae,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x5d4db8ca4640cd483be5b02,
                    limb1: 0x8482b8c7316f38d24fb0399f,
                    limb2: 0x9b88c1491c67f81f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x132443abd4e9dcc8515861f9, limb1: 0x2904141b, limb2: 0x0, limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x7d834505ab9b24ba2b178eed,
                    limb1: 0xa6962db36aa63277b8d7e10e,
                    limb2: 0xca3b9d57e1964ecf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x44f02e7a9636a51893ced1cc,
                    limb1: 0x16b683899463a653ad0dea69,
                    limb2: 0xa00542a4e3adc02,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xc487e79a6721d52867b4ff7d,
                    limb1: 0x4b3356380c3f5792050fdf4b,
                    limb2: 0x50bd064db1db02bc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcd74e38552ab8b1d11ffcffb,
                    limb1: 0xcf943f3bd2054f7f9e674630,
                    limb2: 0x6072be5bb63da138,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x75c278e36ef664fe0d3198a5,
                    limb1: 0xc949bccd4612b728a1d09b77,
                    limb2: 0x85c38c449f972d8c,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xf68806548e90e59995e8ab93,
                    limb1: 0xdc547c8a8eb701bc87b6d2b3,
                    limb2: 0xf43814b1422c6bd8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1b9672ca1386acd0f53637d7,
                    limb1: 0x1577f0719770350bd50879b3,
                    limb2: 0x9bf18dc1e75bc3b8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfd832586792a4cf46c65eae7,
                    limb1: 0x6fc832b8b96d93c15df34774,
                    limb2: 0x3cc53959bf89ffe1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7d834505ab9b24ba2b178eea,
                    limb1: 0xa6962db36aa63277b8d7e10e,
                    limb2: 0xca3b9d57e1964ecf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x44f02e7a9636a51893ced1cc,
                    limb1: 0x16b683899463a653ad0dea69,
                    limb2: 0xa00542a4e3adc02,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xe422920659531e5deeb37e1c,
                    limb1: 0xbeb485f97ab4a3d597a52007,
                    limb2: 0xb6c6b09151f97a57,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd902ced73042617def6d73f5,
                    limb1: 0x80000000000000002b539a75,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x6abeb82abd0800c34f3aa673,
                    limb1: 0xe8e5fa0ff1271a412c978390,
                    limb2: 0x28fc640e88018162,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x72076372c7196cd8089f15a,
                    limb1: 0xb535686a73b814c65990f1e1,
                    limb2: 0xf0e374be0686cedd,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xc82da806a5f5ac7705ba068c,
                    limb1: 0x61f7f18298a39d87481d7c7d,
                    limb2: 0x5a87da2993a9b51e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x957fe915a339603e4ee5a768,
                    limb1: 0x27c028ef515efb0577166ce4,
                    limb2: 0xf65d24050ec7f941,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf266a9d6b8556586672206d5,
                    limb1: 0x8d2d0041dbfb57af1aa43b24,
                    limb2: 0x555de7fe1920f52f,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xc92f5864a0c7ce968c74acd5,
                    limb1: 0x30990f62acde55d4cac672f,
                    limb2: 0x44a9e2a29038e3ee,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2ab1c63e4792bf460e8b5185,
                    limb1: 0xd5c615df829cc53a62e39221,
                    limb2: 0x20544a064aac8c85,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb6f24e50b67977d5a6348c3a,
                    limb1: 0x944b84161b704869586a3110,
                    limb2: 0x881bd79b96a62751,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6abeb82abd0800c34f3aa670,
                    limb1: 0xe8e5fa0ff1271a412c978390,
                    limb2: 0x28fc640e88018162,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x72076372c7196cd8089f15a,
                    limb1: 0xb535686a73b814c65990f1e1,
                    limb2: 0xf0e374be0686cedd,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x91507961703619154c1fefbc,
                    limb1: 0x83d4367afb57b490174e52e0,
                    limb2: 0xcc33e82e7a6edfa5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5784a91a5e09d24e7c4a2665,
                    limb1: 0x7fffffffffffffff7c074594,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x2df4e9767c427d113730ac48,
                    limb1: 0xf5ed0681f652df53f1856d51,
                    limb2: 0xfb555575f4f4c92f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbcb7463a059df1997591fa8a,
                    limb1: 0x71f734880f703c6767333b25,
                    limb2: 0x4c814d923b23c468,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xcc4541c9811ccef52044bc97,
                    limb1: 0xc6cfdfb398895029d3078a,
                    limb2: 0x9d3cb4a02178d0a0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x556d63025bf955bfb7e64269,
                    limb1: 0xd7c6f8328619c43e3995b76b,
                    limb2: 0xd853b0904ab71b45,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3bafdf9937cc2761bf7f7d1,
                    limb1: 0x78d4409bf47f381f5e0a02d6,
                    limb2: 0x5d44a27c1d312f4c,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x2fac6251ae7ceb54c7a2ecfb,
                    limb1: 0x54f715736e914e50c247f68d,
                    limb2: 0x876168ce10be7780,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf0d92ae0cdb4a004a1b5f41,
                    limb1: 0xe5c02af55112b25d135c51a9,
                    limb2: 0x1018f5cd44aa4e57,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x962dde482af46771c71c70ac,
                    limb1: 0x5e061fbd4847d1862f835540,
                    limb2: 0x75424d20f8cf46af,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2df4e9767c427d113730ac45,
                    limb1: 0xf5ed0681f652df53f1856d51,
                    limb2: 0xfb555575f4f4c92f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbcb7463a059df1997591fa8a,
                    limb1: 0x71f734880f703c6767333b25,
                    limb2: 0x4c814d923b23c468,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x166a414b133c2e9b5767a4b8,
            limb1: 0x83ca0637cb144455bd695bb1,
            limb2: 0x1d0cd9b6eba698af,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0xec6b455613941937cc324be3,
                limb1: 0x7b06c1c26218fb7fe3a1cee0,
                limb2: 0xd2224e110127f30,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xda5f66ce22dac9c84efc9dbd,
                    limb1: 0xae06b466e61bddd1ccba5d75,
                    limb2: 0x7aa028d173743fbc,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7a3f1d328ef5685fb1dbcd58,
                    limb1: 0x52b8493052a09c5d66df3eb8,
                    limb2: 0xdd831398f4ff1976,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_2_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x2da2e4ae31bd9ba45fbeb28d,
                    limb1: 0xebede750551f534c84b75fba,
                    limb2: 0x340c32f8df9e3002,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x805fcf08cf9f653955a2f282,
                    limb1: 0xa625d6f3079582f36cb44376,
                    limb2: 0xdecb967e6162c65f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2da2e4ae31bd9ba45fbeb28d,
                    limb1: 0xebede750551f534c84b75fba,
                    limb2: 0x340c32f8df9e3002,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x805fcf08cf9f653955a2f282,
                    limb1: 0xa625d6f3079582f36cb44376,
                    limb2: 0xdecb967e6162c65f,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x104dff6623f1b67e01d34690a795ac54, high: 0x38dfe76bae3582906d80ab08c963d148
            },
            u256 {
                low: 0x8ec9ea986581f9349bcfb1c4f87e3560, high: 0x315e80807425f4e93891aef5ebe0572c
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x2c23bc246757e273dcfac27f,
                limb1: 0x72d1ea7165867a1e87634a0e,
                limb2: 0x307a31f424a3f093,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x9b62f9bae3932400503635d2,
                limb1: 0x54fa3a5fd47c42dbd4df792,
                limb2: 0xe59613d7a8f1989,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x2dc93ccb6693ca26f70e1871,
                limb1: 0xc46d5c4f469226c34de5e8f6,
                limb2: 0x391e4b26c8020af3,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x758129b7aab9df36eecd5a96,
                limb1: 0x4fd05ad502822ae2e7bbc78c,
                limb2: 0x6718033ea0d8f410,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x912ad542b1777aa35140a312,
                limb1: 0xf5366c16251825c22d6ad25e,
                limb2: 0xc11225d867bef520,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xa605b363e5a7b8618a19e4d6,
                limb1: 0xc0d4e88d3e7cf2e0914e898d,
                limb2: 0x89baa33fcb50590f,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x5278915e981fb2a6bbe08619,
                    limb1: 0xfe0aa8740a44437fb3a90d35,
                    limb2: 0x29cb0b8d3b9c7838,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x892a61da844e7088087d4f5,
                    limb1: 0x800000000000000027e7f08b,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xe94774d31e572c935d338706,
                    limb1: 0xeb7c4e32d3d2c36120a0ffc3,
                    limb2: 0xf34a265c77b910fb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa6395f2d66ea81e7c3468af3,
                    limb1: 0xa1402e3e455a3294f3e55638,
                    limb2: 0x9b799b11fbbddf6a,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xd27c29cec20ffa490026ed3f,
                    limb1: 0xe317be0792557957660f3f9b,
                    limb2: 0xefeeb93e9ef249a7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x24a8d971fb61d888170f9a17,
                    limb1: 0x862e72d6c1784dec91d8e707,
                    limb2: 0x310e4b3ef1f45e1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x70df30823749d266d4cfeffc,
                    limb1: 0xa791e8a0660a5a4f0efaec0e,
                    limb2: 0x481e324b0bb6767f,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x4a32fe052a07763afa66adaa,
                    limb1: 0x3cde4eff571a83cf57beb1ad,
                    limb2: 0x93f719eeccb53e1f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x77d17e994c8956d5ba527df9,
                    limb1: 0x60f06f5122d6e11b2a0b7614,
                    limb2: 0xfe7391c6bdf7cc89,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd9a7936e070eb686ddfebf70,
                    limb1: 0xd02b329aa689eefd896d0408,
                    limb2: 0x885964a0b700f5a9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe94774d31e572c935d338703,
                    limb1: 0xeb7c4e32d3d2c36120a0ffc3,
                    limb2: 0xf34a265c77b910fb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa6395f2d66ea81e7c3468af3,
                    limb1: 0xa1402e3e455a3294f3e55638,
                    limb2: 0x9b799b11fbbddf6a,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x707489c5a9bba8bcc85d9d39,
                    limb1: 0xd2bfc22582c78010ea4f4b10,
                    limb2: 0xaa69c6c569790ac3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2412b69f0cd976e7f97812e3,
                    limb1: 0x80000000000000001d585197,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xde337114747990049b26f5a5,
                    limb1: 0xb7617fbedcfb65c234b66a89,
                    limb2: 0x2e0f6e3e0b8465c6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa493de8667ae9a34a9333501,
                    limb1: 0x4fa4bc60644e85f02d62b750,
                    limb2: 0x92d581df585fc50a,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x7c47a5856912c9855677a349,
                    limb1: 0x98586e4d04cf3781fae9462f,
                    limb2: 0xeac18ab3d120add3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x357b6c9c0f5ff47429aaeefa,
                    limb1: 0x4fd18bfbef43c52e6c1d1179,
                    limb2: 0xcad9ca2614d5362a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe38dea3efd47a9c8669ac194,
                    limb1: 0x71711ecd032854af82b2f840,
                    limb2: 0x3c25dbf667056182,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x2bb1ee598a9236549e0723d0,
                    limb1: 0xf0a5ab0ea1ab88d72ac18782,
                    limb2: 0x3eed2578630ca408,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9955568556c8e0441ac6ab38,
                    limb1: 0x581e6249ba523c9088aa4c1d,
                    limb2: 0x75562d09355f93fa,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xde98156304c26da02c38c146,
                    limb1: 0xc4fd883449acf4ebdcf4e0c0,
                    limb2: 0xa245b038a11b44ca,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xde337114747990049b26f5a2,
                    limb1: 0xb7617fbedcfb65c234b66a89,
                    limb2: 0x2e0f6e3e0b8465c6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa493de8667ae9a34a9333501,
                    limb1: 0x4fa4bc60644e85f02d62b750,
                    limb2: 0x92d581df585fc50a,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xe42df26e267993d3305b3826,
                    limb1: 0x2b52e94f10249d5643292914,
                    limb2: 0xce08bbbf09946408,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5784a91a5e09d24e7c4a2665,
                    limb1: 0x7fffffffffffffff7c074594,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xeb7cbe6f395c7b67b8fec239,
                    limb1: 0xd50246bb33873c9ce6f8b89e,
                    limb2: 0xe587d0131578581f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x410bedf1e7f4bb35b7b1447c,
                    limb1: 0x465c379a9455b37a84af44ac,
                    limb2: 0x5cf8effd03effec,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x6de06b13f1294d80ae6de26b,
                    limb1: 0x854e973355bb7af84a36db02,
                    limb2: 0x677ebe5e23c91218,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6c28da4c3615e6dc9c5248d7,
                    limb1: 0x1405e8e20bdcf43dd93c24f4,
                    limb2: 0x928069b3b59cba91,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6cc95d6aa807acc1522df920,
                    limb1: 0x692112f972ac42780b61dde7,
                    limb2: 0xc6f800d25cdb5702,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x7e406bdf331443d28d878a57,
                    limb1: 0x5d096590fda883abfba63651,
                    limb2: 0xba0bd695665296ee,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x38c173da212c7537f3d29bfe,
                    limb1: 0xb4695682c150df32ecd15492,
                    limb2: 0xb572d315ffc4583c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x92fe72083f00a9d00be92d7,
                    limb1: 0xe0d71685b9976c4cd70f38ac,
                    limb2: 0x495788d9397d9422,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xeb7cbe6f395c7b67b8fec236,
                    limb1: 0xd50246bb33873c9ce6f8b89e,
                    limb2: 0xe587d0131578581f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x410bedf1e7f4bb35b7b1447c,
                    limb1: 0x465c379a9455b37a84af44ac,
                    limb2: 0x5cf8effd03effec,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x1f45434226afe3490fb51e3e,
            limb1: 0x1d48665ede1a0fc2b82df1c2,
            limb2: 0x760470a52354a73e,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x7c07168a096eb76ab684807d,
                limb1: 0x8203b8c5ed97e46f11c7271a,
                limb2: 0x6937cb3c2af94dd0,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xc8cc2d6e39d1940098b235f7,
                    limb1: 0x3d687b93c9e7533afa8f1afd,
                    limb2: 0xd184e86be2927f5a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x205707f013a6fcfff8cf846c,
                    limb1: 0xf2b17d999e1f3e75705cf2c4,
                    limb2: 0xad3b3d814125204d,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_3_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x305af18a35428cb1ddc7441,
                    limb1: 0x41c2d47ae68e9e90a58edcd9,
                    limb2: 0xa02f6acdd0af0e2a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x29685ecc9c9706454d19dc5c,
                    limb1: 0x23943d9894d99e82cf8bcd04,
                    limb2: 0x1d08549fea8e0a10,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x305af18a35428cb1ddc7441,
                    limb1: 0x41c2d47ae68e9e90a58edcd9,
                    limb2: 0xa02f6acdd0af0e2a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x29685ecc9c9706454d19dc5c,
                    limb1: 0x23943d9894d99e82cf8bcd04,
                    limb2: 0x1d08549fea8e0a10,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x305af18a35428cb1ddc7441,
                    limb1: 0x41c2d47ae68e9e90a58edcd9,
                    limb2: 0xa02f6acdd0af0e2a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x29685ecc9c9706454d19dc5c,
                    limb1: 0x23943d9894d99e82cf8bcd04,
                    limb2: 0x1d08549fea8e0a10,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xe4bacd7874aba9fc8930d17952ab793f, high: 0x85a1282a0761585b4168705a533c9a31
            },
            u256 {
                low: 0x14827a895e6364c630ac79dd0b5aafef, high: 0x5882e3bb864696c1deb4e6c435a7c6ed
            },
            u256 {
                low: 0x4053b188339d78f5d658b1b33012ae1c, high: 0x4d236555bc5074acbaa172acac33f644
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x953f9dcd4ee1925f5d11fa6d,
                limb1: 0xe576ae2e97ca92c13d3fe1e8,
                limb2: 0x460ffb31999462fc,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x49fdde226eeab904d9fec1ba,
                limb1: 0x6d7a05f273d0cfd2e9e8114f,
                limb2: 0x6b96245a54315b7d,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x6d5ae37c13b77300bc92060e,
                limb1: 0x886a247bb6f523c90d0ca51e,
                limb2: 0x2eaeab5666e1c35f,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x50c2669e7d3f354d59eb6003,
                limb1: 0x48750686e307ac1dd95c8b94,
                limb2: 0x9832c78a7778d9e7,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xc7885e5af9b7dd24ac87b81a,
                limb1: 0x9c8779c59831e76beffbf3e,
                limb2: 0x9b1e8c421a862820,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x33a99f0f435eedcf17a40b46,
                limb1: 0x98a272e78433d811b883a25e,
                limb2: 0x92f38cb10a300ffd,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x117da4d8eaeabb889ac19f8e,
                    limb1: 0x6d4dee060f7384af4e17117c,
                    limb2: 0x8202658ae44acb2f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbb8628ac1e1443132a1c657f,
                    limb1: 0x7fffffffffffffffb0ec7f62,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x754f05490e85759f7c739ccc,
                    limb1: 0xfe42d7cfe695ebcc97dc2adc,
                    limb2: 0xecf6243911c3255e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x67bab31a0dca44d585119151,
                    limb1: 0xd8c67d5681a6ceae1d31413f,
                    limb2: 0x19c099ff95bc8ed9,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xb03cb9e50feb779505aadc2b,
                    limb1: 0x915dedf33a4e7b2e67cdbdab,
                    limb2: 0x1de7d403c62aad9f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x88ddae41fc0ba665b7ad5288,
                    limb1: 0xacc1711fc6dc108ec5416502,
                    limb2: 0x7c618f4059b243f9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3e41f227de745a507c620772,
                    limb1: 0x449dd452c2e1503fd004f4b8,
                    limb2: 0xe13eed4055109e71,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x47d1f8633a2156d4c1f865b2,
                    limb1: 0x1cd739e6fccc55aa81056e06,
                    limb2: 0x67254d35e881578b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6323e15d6e301db542955191,
                    limb1: 0x4f0e09ed16dbfa4cb3670905,
                    limb2: 0x84235fd305167350,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x952397a8126f6dbd989dac58,
                    limb1: 0x29984551f1a41ab20d8942f2,
                    limb2: 0xd8467d9e904e75a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x754f05490e85759f7c739cc9,
                    limb1: 0xfe42d7cfe695ebcc97dc2adc,
                    limb2: 0xecf6243911c3255e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x67bab31a0dca44d585119151,
                    limb1: 0xd8c67d5681a6ceae1d31413f,
                    limb2: 0x19c099ff95bc8ed9,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xca03f4a05d3a8eca1a0e6a17,
                    limb1: 0x842bc9bb4c8c2172152d3580,
                    limb2: 0x884d1582dad3d97,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd1331569838ace41e39b18a5,
                    limb1: 0x800000000000000078e941b8,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x671d06e7cb38451077c5051e,
                    limb1: 0x10f0a062d74d2c3897a889ed,
                    limb2: 0x8ebfd7d0a6dd350f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8f9f6d6b48f46434259185b0,
                    limb1: 0x35d30709627c3da64d647e09,
                    limb2: 0x3121e9dac86f2e77,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x33994ba1122efa9f22656e7c,
                    limb1: 0x6a918a41c32fc8521d5aa243,
                    limb2: 0xaad505e845f12e5b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x657436d75a0d2eb494224f9b,
                    limb1: 0x852022c39c50b54353bcdb4c,
                    limb2: 0x97f90903d0be6c5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xde7dadb214428edc209cb4b2,
                    limb1: 0x54a084362875dc1df29cb056,
                    limb2: 0x93195ad81f6d181f,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x8d0197e75a7348ae297e2889,
                    limb1: 0x1f5941fe29481071db3efe0e,
                    limb2: 0x3085ffecd1a4d87a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf06ac3bd0fd043073e7e37b6,
                    limb1: 0x6c6d5a5eecb5766d6599bc94,
                    limb2: 0x3da7861583e13bd7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1d7568b460f10fa1b71dcf3a,
                    limb1: 0x1272a8394f23cdc97cef8c95,
                    limb2: 0xc760784750ed0883,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x671d06e7cb38451077c5051b,
                    limb1: 0x10f0a062d74d2c3897a889ed,
                    limb2: 0x8ebfd7d0a6dd350f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8f9f6d6b48f46434259185b0,
                    limb1: 0x35d30709627c3da64d647e09,
                    limb2: 0x3121e9dac86f2e77,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x315dc18c0688a10c5e94ffbe,
                    limb1: 0x7d9c6d9f5bf0562cc98602da,
                    limb2: 0xebfb5833a2972094,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5784a91a5e09d24e7c4a2665,
                    limb1: 0x7fffffffffffffff7c074594,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xaf1605e666494e93ffc35098,
                    limb1: 0xb817798666de8aa1b80f2369,
                    limb2: 0x133457705f0d58f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcb1cbe28f290afda96e641d7,
                    limb1: 0x6dcd63e7ef87bdc033f39ba3,
                    limb2: 0x3632c8667e981481,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x484ecd8f289f3c49da33fb0f,
                    limb1: 0xec27664ec32880d6cdab23e3,
                    limb2: 0xd9f407e0230ef776,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8dc3b28771e7e9a511427d52,
                    limb1: 0xef5f028a52af89d82109141b,
                    limb2: 0x37c83aca78c7cb80,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd81de153e129369f0d44fef5,
                    limb1: 0x83bdab19e48439ac5653038c,
                    limb2: 0xa894e22330cd5a65,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x2dc6a8c0253ae90ac8898c4c,
                    limb1: 0xf82f158414efcee0d8483248,
                    limb2: 0xffea70135ab4d505,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc7556a5797fd28a5f415bbfd,
                    limb1: 0x6653d1b64aaf3cde61b0b65e,
                    limb2: 0xc6472f8c2b4dbb62,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6afd767b641c2cae631f9ac5,
                    limb1: 0x6a83919da8014d7bc94233c6,
                    limb2: 0xb82ddca42e725664,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xaf1605e666494e93ffc35095,
                    limb1: 0xb817798666de8aa1b80f2369,
                    limb2: 0x133457705f0d58f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcb1cbe28f290afda96e641d7,
                    limb1: 0x6dcd63e7ef87bdc033f39ba3,
                    limb2: 0x3632c8667e981481,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xae2d806cd7af3e48f2dd2c36,
            limb1: 0xfc85ac3036bc2e63afb27d20,
            limb2: 0x412bc2e01f831986,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xdb6ba3611b55a9dd39739cda,
                    limb1: 0x8be6b20700c6c850d40e166e,
                    limb2: 0xd26d3f60754e958e,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xce5e6db1ba836e0e453bb23c,
                    limb1: 0x1ff1a4271c32728eafc95fff,
                    limb2: 0x1c91583a1a00be1f,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_4_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x15869e4cf31a8fd6b4828493,
                    limb1: 0x127c9971cbf3c7c435178732,
                    limb2: 0x3257b9a3e9f12b04,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc37eae41de471bfb9e30afad,
                    limb1: 0x6a4cc77fbb6245e0465bf759,
                    limb2: 0xc439c17c03e00cef,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x15869e4cf31a8fd6b4828493,
                    limb1: 0x127c9971cbf3c7c435178732,
                    limb2: 0x3257b9a3e9f12b04,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc37eae41de471bfb9e30afad,
                    limb1: 0x6a4cc77fbb6245e0465bf759,
                    limb2: 0xc439c17c03e00cef,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x15869e4cf31a8fd6b4828493,
                    limb1: 0x127c9971cbf3c7c435178732,
                    limb2: 0x3257b9a3e9f12b04,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc37eae41de471bfb9e30afad,
                    limb1: 0x6a4cc77fbb6245e0465bf759,
                    limb2: 0xc439c17c03e00cef,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x15869e4cf31a8fd6b4828493,
                    limb1: 0x127c9971cbf3c7c435178732,
                    limb2: 0x3257b9a3e9f12b04,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc37eae41de471bfb9e30afad,
                    limb1: 0x6a4cc77fbb6245e0465bf759,
                    limb2: 0xc439c17c03e00cef,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x4e49df560b648acd3d6e2667b6651d6e, high: 0x25b7c5f1284b9d78d4e2753ef26a5b7
            },
            u256 {
                low: 0x702dc88ab97fb3bb7ecc040c75ff93f0, high: 0x6980b561cf1accc1eaca38110c26e5d9
            },
            u256 {
                low: 0x70aaf52575e417dd7e5b637dfa98c115, high: 0x3dbba3af14dbad2215eae9d21e3d59d0
            },
            u256 {
                low: 0x275f275cc3f3f74dd3861b58194665d3, high: 0x36a5be06eb52ee01e25e651269fcbef0
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x9d5b4406f678ad4d8b369056,
                limb1: 0x21a200bda9d6bbf88c43f06e,
                limb2: 0x4d38b8508f984fb3,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x845e249ffdb452273c2ec054,
                limb1: 0xea5f7f34fbe945d479132892,
                limb2: 0x26a33e52bac26df2,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xc421fde2b37983203f79564,
                limb1: 0x2bad8858432934bc6ba412ec,
                limb2: 0x63cb2430284e3b26,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xca06176ec5ba0009c3ae1df3,
                limb1: 0xc9f2b8e8ff6ec63600534b2,
                limb2: 0x641b87df91c64919,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x1ef0f894efbbbd35cdac9c53,
                limb1: 0x650c968f324f19a93ac1f2e8,
                limb2: 0x7ae4faf3f79a2ae7,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xb09aba183817b16084d6e3cd,
                limb1: 0x9ad686f9ade7aad8722bfe32,
                limb2: 0xa23c1694783b4594,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xe8f35102176b2a075c99de2e,
                    limb1: 0xade76788fc7d66ae244c64f3,
                    limb2: 0x8b390a7a9204337d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdd40b2f686193fec98cdbf8c,
                    limb1: 0x80000000000000007f3bcea9,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xe3cb66b299ec7e62dd892907,
                    limb1: 0x27aa1763adf9fbb76cdeabd2,
                    limb2: 0xf41ab2e3cee6f4f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4d1e1dac166cc2dbc046eb16,
                    limb1: 0xcbe165d08a357c433ea48860,
                    limb2: 0x806f8e0a86768549,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x29e15ae28da24771e4b87f45,
                    limb1: 0xe1df7cf8109340a357272ddc,
                    limb2: 0x4d3808edf983b6de,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x288d1cc15b9789c802e10d48,
                    limb1: 0x7953c4517dd359be618e2a35,
                    limb2: 0x16e0e70066611116,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa8a878533217535ec1ad0125,
                    limb1: 0x208d7c7087ec2738fd1f8183,
                    limb2: 0xcb320432a35838ab,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xf6c3bf385f02c7f6a8f20f7e,
                    limb1: 0xb2130ea177a72e4f130e8684,
                    limb2: 0x979b22192e63af1f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x546834b5c29137a996dd9319,
                    limb1: 0x8930f02fe5561343ae90713a,
                    limb2: 0x39db5d8b83813d5d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe4f957f1f887f3aae6fd9f07,
                    limb1: 0x50478be3d7f811f2a92f6d91,
                    limb2: 0xd9778bb716d7040c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe3cb66b299ec7e62dd892904,
                    limb1: 0x27aa1763adf9fbb76cdeabd2,
                    limb2: 0xf41ab2e3cee6f4f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4d1e1dac166cc2dbc046eb16,
                    limb1: 0xcbe165d08a357c433ea48860,
                    limb2: 0x806f8e0a86768549,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x6e24f10c3ed3e832c9dc23e7,
                    limb1: 0x1e069dbce4d20bcfa4dda6e2,
                    limb2: 0x5f8777f001774b70,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe2c9eeca50be5807ef93da95,
                    limb1: 0x800000000000000051f9b2dd,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xba56f58935576c469f852182,
                    limb1: 0x7166f374d165db18f1bcec5b,
                    limb2: 0xe6288147360a28c8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xde3741d4e1add7f74785e608,
                    limb1: 0xc1d5de35f0e3037f5f4465e2,
                    limb2: 0x69dd222aedc099d6,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xfee6295c3a1f013fbebb770e,
                    limb1: 0x41acb324e38b5245c5664959,
                    limb2: 0xa616f29f20ae4e3f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8522e1aa60371f063c8d2e7,
                    limb1: 0x89953c7415d67f81f47ffd38,
                    limb2: 0x6a5f1028615c06b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xaffa28cc0d13bbafd72cfa26,
                    limb1: 0x96ccc213905c86b4642b4c13,
                    limb2: 0x79d97415d91b7324,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x71bfb69efd7225420a27cc7e,
                    limb1: 0xe4480503566b369d211ac3a8,
                    limb2: 0xdf0deac59a7d50ae,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcaeb446cc30870bf58ef68aa,
                    limb1: 0x2d598f4109ad98368f762620,
                    limb2: 0x681c50554695d97b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x31adeb7796c4b4585140ae32,
                    limb1: 0x6e6a22b3a3ef7c3e474fd509,
                    limb2: 0x1d2ecf56e0f8c664,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xba56f58935576c469f85217f,
                    limb1: 0x7166f374d165db18f1bcec5b,
                    limb2: 0xe6288147360a28c8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xde3741d4e1add7f74785e608,
                    limb1: 0xc1d5de35f0e3037f5f4465e2,
                    limb2: 0x69dd222aedc099d6,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xe324e79a049ae693e383086d,
                    limb1: 0xa2157a4267ed7fb0b38299de,
                    limb2: 0xa1ba75cdec039ad5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5784a91a5e09d24e7c4a2665,
                    limb1: 0x7fffffffffffffff7c074594,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x2ffe9e618335e394ac3eb74f,
                    limb1: 0x11223b778cfaddc5050707aa,
                    limb2: 0xd0f94ae73520379,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd4cce78ce50caa982e5bce48,
                    limb1: 0x6f45e1188a87b19a5999fa2c,
                    limb2: 0x214fe0dae01799f3,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x50c0156a91d79c5bd243599b,
                    limb1: 0x545f0543ccd5fd2379f1fa35,
                    limb2: 0x1c95edbcc4f7875e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x128e4468250f1fffbcd31adc,
                    limb1: 0x2c8b226969a334803a397f28,
                    limb2: 0x9c036f97e1939cf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5c9138e7093bc73148e8497d,
                    limb1: 0xde4906c74b419ec90fed7074,
                    limb2: 0x6e8a4fa4556506b9,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xf722dd5b5addafc2dc0eed16,
                    limb1: 0xa23698be1306c6fcafe7650b,
                    limb2: 0xd2cd6f6acb9a7217,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa7e1e5c653c7fe4e16a8bf03,
                    limb1: 0x4c5a9c814f0830b06bf9ba9c,
                    limb2: 0xf173e0203ef3971f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4decfa4f8ca83c759cbef572,
                    limb1: 0x661a1a0bd70171ed584f182b,
                    limb2: 0xf6d6934709f3c60e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2ffe9e618335e394ac3eb74c,
                    limb1: 0x11223b778cfaddc5050707aa,
                    limb2: 0xd0f94ae73520379,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd4cce78ce50caa982e5bce48,
                    limb1: 0x6f45e1188a87b19a5999fa2c,
                    limb2: 0x214fe0dae01799f3,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xcd5da1373717b7ad4df582f9,
            limb1: 0xa8e7887bd54fcf8a6f84161d,
            limb2: 0x767a72b4c02ef3af,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x28fa0036e1e0f20589cdf2bc,
                    limb1: 0x5999ba7bc3fca40e24469fe5,
                    limb2: 0xcfc9050550d15821,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb4262c2230cfeaefadcac46d,
                    limb1: 0x3b2a551dc9ccf20fa417c5fd,
                    limb2: 0x81345ca1132ee252,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_5_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x7b771521bdc55694333d6d3a,
                    limb1: 0xd795997443e0c51c619f14ca,
                    limb2: 0xdfc007ca349d35a8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc1a9948ac8b52f10892fca4e,
                    limb1: 0xa8ca4fdaf866db1fd0268f3,
                    limb2: 0x4a7fa0a5a44949d0,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x7b771521bdc55694333d6d3a,
                    limb1: 0xd795997443e0c51c619f14ca,
                    limb2: 0xdfc007ca349d35a8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc1a9948ac8b52f10892fca4e,
                    limb1: 0xa8ca4fdaf866db1fd0268f3,
                    limb2: 0x4a7fa0a5a44949d0,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x7b771521bdc55694333d6d3a,
                    limb1: 0xd795997443e0c51c619f14ca,
                    limb2: 0xdfc007ca349d35a8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc1a9948ac8b52f10892fca4e,
                    limb1: 0xa8ca4fdaf866db1fd0268f3,
                    limb2: 0x4a7fa0a5a44949d0,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x7b771521bdc55694333d6d3a,
                    limb1: 0xd795997443e0c51c619f14ca,
                    limb2: 0xdfc007ca349d35a8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc1a9948ac8b52f10892fca4e,
                    limb1: 0xa8ca4fdaf866db1fd0268f3,
                    limb2: 0x4a7fa0a5a44949d0,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x7b771521bdc55694333d6d3a,
                    limb1: 0xd795997443e0c51c619f14ca,
                    limb2: 0xdfc007ca349d35a8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc1a9948ac8b52f10892fca4e,
                    limb1: 0xa8ca4fdaf866db1fd0268f3,
                    limb2: 0x4a7fa0a5a44949d0,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xf57b8a920a12f3b364fc0dbad44f85e7, high: 0x38553ac87d7185913fee2fc72e2dffdf
            },
            u256 {
                low: 0x476c4878deffed7ad728525620ca35ab, high: 0xfea2a33a51d11bcd5a23754bef38d426
            },
            u256 {
                low: 0xe64ddd918e9b185e1b770deb6f51ea78, high: 0xc9fe60368a83efc89c2e55624916e844
            },
            u256 {
                low: 0xc707e77b4bf0ae53b6088c973380dcfc, high: 0x764ab5109acba5888397d4127118bb71
            },
            u256 {
                low: 0x45c596d442d01ba3a2652c9e89421c6d, high: 0x9d683a9e1e651ac1043d2c473b56735e
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xccd0054e32d7c02470d2af50,
                limb1: 0xda6114ae092429285c7914c,
                limb2: 0x3e06c0f71dda41c2,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x769672f758c214cf21701788,
                limb1: 0x2d32c60aabda5bd77a28865e,
                limb2: 0xab6834dfd2aa6262,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xe3ecf62acbccf48d76649dfd,
                limb1: 0x3e506d4b56b21d9835b2e6a,
                limb2: 0xf02cc74a64651555,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x622ef94a149d86e989623ed4,
                limb1: 0x5e5129905056dab942709123,
                limb2: 0xa53db23e4086a9bb,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x4169f126b635ba0e11d45e33,
                limb1: 0xa4b4792a16fe5b56322d3418,
                limb2: 0x5396b052340ed7cc,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x636b63de35db98b5f89596f0,
                limb1: 0x569b50b3a649f8b7c539f872,
                limb2: 0xb7b1a5b1ab7f1a79,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x55351b41f8bbe9596f6b7c8d,
                    limb1: 0x5e81f3cb10822f087ca9386f,
                    limb2: 0x1790a653459ac622,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xad46090ed419d8dba2c255c3,
                    limb1: 0xfffffffffffffffee5535b88,
                    limb2: 0xffffffff00000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xfa2c882bb23b91a34b8fee36,
                    limb1: 0xaf84c496d5272cd53031dd40,
                    limb2: 0xace2615620f8cbe8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb7b8e5900f62e9475befe374,
                    limb1: 0x1ac45540db8cf851189959ea,
                    limb2: 0xe239373cad888897,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xed49991b03e7b5781303098d,
                    limb1: 0xffd9e6a849564edeb7c3f02c,
                    limb2: 0x658b2d6d31eb58ab,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7e47a84e984c596eeb7e15e7,
                    limb1: 0xe0d43c80cb29a962ea887273,
                    limb2: 0x25b1a3b3cac89e97,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7805e8cf02436229f984d,
                    limb1: 0xfb1924a313ade4632e67c571,
                    limb2: 0xbbbb7ebde0cf2f08,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x6ecc9364c86ceca21d187b4e,
                    limb1: 0xe07b5ad0c75feb89bf765333,
                    limb2: 0xc12f72b2b8e65aa8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x201bae14047a6f41c47e48a,
                    limb1: 0xef1e55b77f9befec9e79cee3,
                    limb2: 0x5e7356565e559d7b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa52900460da580681402b5ec,
                    limb1: 0x639ebd92e3f19dc91b50f8f3,
                    limb2: 0xb41a901fa1a0fa25,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfa2c882bb23b91a34b8fee33,
                    limb1: 0xaf84c496d5272cd53031dd40,
                    limb2: 0xace2615620f8cbe8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb7b8e5900f62e9475befe374,
                    limb1: 0x1ac45540db8cf851189959ea,
                    limb2: 0xe239373cad888897,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x72a0bcd824cb4531279bcfa8,
                    limb1: 0xcca72e8f7bea394db2c70a8,
                    limb2: 0x124b62bc943dce36,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9171cf7e7596e57952dd5903,
                    limb1: 0x7fffffffffffffff8f1e210b,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xcc675348a5814d82486efeb,
                    limb1: 0xaf7bd49ab05d866d13491700,
                    limb2: 0x8ad72a88e75b8637,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa09bf4b3766db4de565df4c7,
                    limb1: 0x24855fb706b4190a1b05bccc,
                    limb2: 0x301330e966fdb504,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xcac8f41d123880f2de61062d,
                    limb1: 0x205759295e1f90f08c2a3a2,
                    limb2: 0xc3e0eed768f4488f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9cca62438f76f9400d80096d,
                    limb1: 0xc5e557fc2a92f9d9b1f02928,
                    limb2: 0xea9e0db332f2b03b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xaa537f56d360a004399d73a8,
                    limb1: 0xc2b0d72133e4641842bd13ae,
                    limb2: 0x8af765614bfa4052,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xcd87f5f83859573e6cf797b4,
                    limb1: 0xb1ba961f312bfec8fd5f1f8,
                    limb2: 0x55d3900a4691aaae,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa25c0f3db0fce4f84457ec26,
                    limb1: 0xe0c747ebb6bd8eed8ce6b047,
                    limb2: 0x56e100a59f0d2042,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xea7fd2dbd8851da324b881f5,
                    limb1: 0x465b9e30627c3b9e140bd04b,
                    limb2: 0xca8ca31b754174dc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcc675348a5814d82486efe8,
                    limb1: 0xaf7bd49ab05d866d13491700,
                    limb2: 0x8ad72a88e75b8637,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa09bf4b3766db4de565df4c7,
                    limb1: 0x24855fb706b4190a1b05bccc,
                    limb2: 0x301330e966fdb504,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x332c2582d31be2ed9dca8c8f,
                    limb1: 0x870e3644d15915be400bd3ea,
                    limb2: 0x1acdcb167570b852,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5784a91a5e09d24e7c4a2665,
                    limb1: 0x7fffffffffffffff7c074594,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xbeb1d3da0347e54935a4c528,
                    limb1: 0xe3c70f37e815c6b6a2a4853,
                    limb2: 0x142cbc45e3aa35ef,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdaa918ae7dfd516477c703ce,
                    limb1: 0x57668001339682d04a779d7e,
                    limb2: 0xbc3c8861678c12e0,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xa01bd94cd910eecd8bd9d592,
                    limb1: 0x26e9eb3b00d252f29f61be9b,
                    limb2: 0x3d12ba5b1efcbd52,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x586a21241ff88d928cba0203,
                    limb1: 0x77292307500381b6bccf46c9,
                    limb2: 0xc333f71764b96426,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbd6a5361b83a30acf4286314,
                    limb1: 0x9c45d9dae961c812700ed5f9,
                    limb2: 0x7f42c62d2fd395d,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x6979f75ef2c8757bba58899a,
                    limb1: 0xf7e8d0da944d52e3a9c899aa,
                    limb2: 0xe3fa3a60675434a8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x774efc4363a7ef74f96f039e,
                    limb1: 0x874ecf1cb525b23cd2492d4a,
                    limb2: 0x19ca0779edbd882b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3c5866eac1d64810c07d54df,
                    limb1: 0xadb83d51dbd4fe4b85b62e36,
                    limb2: 0x26109cb273965b48,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbeb1d3da0347e54935a4c525,
                    limb1: 0xe3c70f37e815c6b6a2a4853,
                    limb2: 0x142cbc45e3aa35ef,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdaa918ae7dfd516477c703ce,
                    limb1: 0x57668001339682d04a779d7e,
                    limb2: 0xbc3c8861678c12e0,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xc316be017e25c6367e128fd1,
            limb1: 0x49a8aaab4f8f2216baabdf2e,
            limb2: 0x7eba083cac882220,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0xf270785cb58ff13f1beb5ff1,
                limb1: 0x6fb7ef0e8474cf6ba1ee8b1c,
                limb2: 0x219bde15b30b1bfc,
                limb3: 0x0
            },
            u384 {
                limb0: 0x5cad0af4c4c9dce456c6cb18,
                limb1: 0x42edc5fdaddfbbace7fa1f1d,
                limb2: 0x7dffbda1f8dcb21c,
                limb3: 0x0
            },
            u384 {
                limb0: 0xd3a766daf8791dffe3d6f2fe,
                limb1: 0xd700d5b4fa7c4918669a93fe,
                limb2: 0x75bf0aae36e6aaea,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x2548228b41a10f09696a3854,
                    limb1: 0x7afdad898d8b3814aba32560,
                    limb2: 0x8ab5bb11212f56b2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5158efa3fb5288e50d2102d1,
                    limb1: 0x6d28ef879425ab084a16ddfe,
                    limb2: 0x839a12e6feba16d6,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_6_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x725e5d708c1fdbf6ed1ae883,
                    limb1: 0x6dfcf5cb3f9766c01189584d,
                    limb2: 0x58cf9ce968475d1c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x44d192b2ef8e4ef9391d0121,
                    limb1: 0x24a7db88dc914efe07efc588,
                    limb2: 0x272440b691a945a6,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x725e5d708c1fdbf6ed1ae883,
                    limb1: 0x6dfcf5cb3f9766c01189584d,
                    limb2: 0x58cf9ce968475d1c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x44d192b2ef8e4ef9391d0121,
                    limb1: 0x24a7db88dc914efe07efc588,
                    limb2: 0x272440b691a945a6,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x725e5d708c1fdbf6ed1ae883,
                    limb1: 0x6dfcf5cb3f9766c01189584d,
                    limb2: 0x58cf9ce968475d1c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x44d192b2ef8e4ef9391d0121,
                    limb1: 0x24a7db88dc914efe07efc588,
                    limb2: 0x272440b691a945a6,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x725e5d708c1fdbf6ed1ae883,
                    limb1: 0x6dfcf5cb3f9766c01189584d,
                    limb2: 0x58cf9ce968475d1c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x44d192b2ef8e4ef9391d0121,
                    limb1: 0x24a7db88dc914efe07efc588,
                    limb2: 0x272440b691a945a6,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x725e5d708c1fdbf6ed1ae883,
                    limb1: 0x6dfcf5cb3f9766c01189584d,
                    limb2: 0x58cf9ce968475d1c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x44d192b2ef8e4ef9391d0121,
                    limb1: 0x24a7db88dc914efe07efc588,
                    limb2: 0x272440b691a945a6,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x725e5d708c1fdbf6ed1ae883,
                    limb1: 0x6dfcf5cb3f9766c01189584d,
                    limb2: 0x58cf9ce968475d1c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x44d192b2ef8e4ef9391d0121,
                    limb1: 0x24a7db88dc914efe07efc588,
                    limb2: 0x272440b691a945a6,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xff4533febc6ff6ace139d15d48d8b9ef, high: 0x89181ba3bdee923101a6009ea8dce886
            },
            u256 {
                low: 0xcbdc014dbedb42e6da313e783e9973b, high: 0x45c190a8a52ba0ce627b585f1f2de275
            },
            u256 {
                low: 0x908e0372bcbe9a42f89d3fda1e454241, high: 0xb76fc5b2acc512df3ac49efa5be12d09
            },
            u256 {
                low: 0x483c1a4ea91da2cd8bf06f64b4178592, high: 0xe6cd3595d4f0d65dbd6817b638b80611
            },
            u256 {
                low: 0x4eb9876884a5b1c31095e4973d798f0b, high: 0x5f89d54d3bcd6aec53ca8c05acb5959f
            },
            u256 {
                low: 0x9501e917496dc27b7af2f402a0e624f1, high: 0x3f7ba05cf4bb31523254d812bdfb727
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x39abeb6c0a2b21eddd327ae7,
                limb1: 0x877d01cf1cb56d791955303b,
                limb2: 0x63a6d8b2bc44b3ed,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x6d9c949614f7340da37e1005,
                limb1: 0x3c192ec60e70c9ff5e0cde52,
                limb2: 0x9f7c7e99581b97f,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x4d93806fd33406a5b832eebf,
                limb1: 0x173258097a8ffb3e29a1416,
                limb2: 0x9e9e0cf7873d221f,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xf32818f230b922a3a23cf5f,
                limb1: 0x25e486c3412429244bd2a0d,
                limb2: 0xf6f010f1c729c7c,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x331dc925fce81c797b479641,
                limb1: 0x5aac9dad4e9dd78cd1f384df,
                limb2: 0x3208555ae1b2c119,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xa8677fe23e9dd7068b5836f7,
                limb1: 0x66d9e3aab695db79abfec082,
                limb2: 0x80b5d4bb1c164dba,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xd45227208e9ea7f2ffb40960,
                    limb1: 0x4fd30b3a808bb7e9b97bf24d,
                    limb2: 0xb07c01699b807133,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8000bf4ca39aeaf9f985f055, limb1: 0x12c650cd, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xa7c955def82022669af1694e,
                    limb1: 0x72d83c16122c62b22c2aa316,
                    limb2: 0x6760710349b2fad0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x53f5b72369b5021b35b29c95,
                    limb1: 0xa860865a3b32bc6d5217778,
                    limb2: 0x43898a62db73eef7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x24348da5dec0764194afc997,
                    limb1: 0xf52fdda64d6a65e9e8d68526,
                    limb2: 0xbca472f38d542ba7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x46d17a21df6575ba300d221a,
                    limb1: 0xad9a563b3a6d199844a008b0,
                    limb2: 0xc5ead4c4a6ca83fd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd2d343a9e4ece9e6d6e08735,
                    limb1: 0xb48d7fcbe41ee27967dcc063,
                    limb2: 0xb4d310a049057df0,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xcb48d2d5c66978061f7be0ab,
                    limb1: 0x6984c6f8a63b61f636127221,
                    limb2: 0xd5cb2207a6afc62a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x761839c3a01b67fe8ebe829,
                    limb1: 0x1b76a9c4ab838ad59828907a,
                    limb2: 0xa8b6b7bc132eff45,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd0728b8bfeaf35ec86ba8a8b,
                    limb1: 0x9459a4248b7f0367e5b8a048,
                    limb2: 0x902996af17dec703,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa7c955def82022669af1694b,
                    limb1: 0x72d83c16122c62b22c2aa316,
                    limb2: 0x6760710349b2fad0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x53f5b72369b5021b35b29c95,
                    limb1: 0xa860865a3b32bc6d5217778,
                    limb2: 0x43898a62db73eef7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x679b63180b83e540747d7f1a,
                    limb1: 0x714290893a49632ae9a05004,
                    limb2: 0x7ed56b0b0275f964,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x180bbc46057dadb1588d5714,
                    limb1: 0xffffffffffffffff9cc562fd,
                    limb2: 0xffffffff00000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xbe798efff81ff755466b9de7,
                    limb1: 0x6057ee967418c18ddad79f7d,
                    limb2: 0x7acf1ed198b0d52d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x400e221fa0ac1d635ab228bd,
                    limb1: 0x908fe4b428bf998c0bdc939d,
                    limb2: 0x892561e107b80c5,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xe49ccdaa5ce6290f4242196e,
                    limb1: 0x88c286ba6ea0f3b850cfc8d5,
                    limb2: 0x2c62de2070978162,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5781350345b703d75b3df777,
                    limb1: 0x68932750562428881b0888a6,
                    limb2: 0x29f30c395d835cad,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x95ba817b9a21452289a3c9f1,
                    limb1: 0x96c7bbd2efb5c63a66a758be,
                    limb2: 0xd1dd28492f231fce,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x4bb4d8094905e0b44dc30328,
                    limb1: 0x804cb5ef65f95294e5645f13,
                    limb2: 0x1c32b51525f3659b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xec40970ed3ca9cc202211214,
                    limb1: 0xca5fe85221227caffdc6776d,
                    limb2: 0xc18e6e9a6523082e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc294a9759c9e41417bbe614,
                    limb1: 0x23c0f38fc59ba1841874bd9,
                    limb2: 0x410f337e78c81197,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbe798efff81ff755466b9de4,
                    limb1: 0x6057ee967418c18ddad79f7d,
                    limb2: 0x7acf1ed198b0d52d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x400e221fa0ac1d635ab228bd,
                    limb1: 0x908fe4b428bf998c0bdc939d,
                    limb2: 0x892561e107b80c5,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xca4c09bfc0c78a140090a60d,
                    limb1: 0x8772b18692cef80b4934e495,
                    limb2: 0xab632a882c98b0dc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5784a91a5e09d24e7c4a2665,
                    limb1: 0x7fffffffffffffff7c074594,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x3f45e6c93830d28a987062d1,
                    limb1: 0xdc6eb96f5e74917726acfdbb,
                    limb2: 0x1f4359d3f5c2f6e4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7f4eb66a2fe3dce0cc857aff,
                    limb1: 0xa3e03cd219b928bf4b72670b,
                    limb2: 0x2f599dac97101cc8,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x97099672d771b3dbdea3f9ae,
                    limb1: 0x6d64bf245f52b03a84b7a9b5,
                    limb2: 0x78b1c327d616659a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x37498b32db26ef5e4f2f4fff,
                    limb1: 0x906a44a3e1a1e14f6905fa96,
                    limb2: 0x55b898bebeb2ed22,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x78bee00b44152d28d660dff9,
                    limb1: 0xa01642359e1ca1ee3d2f0e17,
                    limb2: 0x376d1276458c3631,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x61c126fc38e3872061c95abe,
                    limb1: 0xfc74118da897eabd05b7d612,
                    limb2: 0x43b0860e102e357e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf703bb16a4baaa741c7ac380,
                    limb1: 0xc9aa0c1e902946324f680b43,
                    limb2: 0x8c426488c3c8b1a7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4e678db7ac22a59bc241ef4d,
                    limb1: 0xc84b06df296d0c7e82c5d18f,
                    limb2: 0xccb95cd1e50a3d8e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3f45e6c93830d28a987062ce,
                    limb1: 0xdc6eb96f5e74917726acfdbb,
                    limb2: 0x1f4359d3f5c2f6e4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7f4eb66a2fe3dce0cc857aff,
                    limb1: 0xa3e03cd219b928bf4b72670b,
                    limb2: 0x2f599dac97101cc8,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xf3766ee144c0f01041304351,
            limb1: 0x31329f276a5bbcffaca6ce76,
            limb2: 0x46f2dce0d7afaeb1,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xa9e06454284ed85642f70f7b,
                    limb1: 0xc9c065a65f5704b5d45cfe85,
                    limb2: 0x3610ae820cf59d8d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc67b83c8679a0c3c03fef109,
                    limb1: 0xd29b8c3cf9189032b16faa92,
                    limb2: 0xec74e42cb7b333c4,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_7_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xc0d179a47f9f4b145bfb9b3f,
                    limb1: 0x3e56a715b97dc65716d71ced,
                    limb2: 0x9055dc9b8af3e859,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd719e4bbfd513d81cfb77cbc,
                    limb1: 0x1dce9e8a32d14ed9a0f1fc88,
                    limb2: 0xac62d5f999ba7a98,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xc0d179a47f9f4b145bfb9b3f,
                    limb1: 0x3e56a715b97dc65716d71ced,
                    limb2: 0x9055dc9b8af3e859,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd719e4bbfd513d81cfb77cbc,
                    limb1: 0x1dce9e8a32d14ed9a0f1fc88,
                    limb2: 0xac62d5f999ba7a98,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xc0d179a47f9f4b145bfb9b3f,
                    limb1: 0x3e56a715b97dc65716d71ced,
                    limb2: 0x9055dc9b8af3e859,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd719e4bbfd513d81cfb77cbc,
                    limb1: 0x1dce9e8a32d14ed9a0f1fc88,
                    limb2: 0xac62d5f999ba7a98,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xc0d179a47f9f4b145bfb9b3f,
                    limb1: 0x3e56a715b97dc65716d71ced,
                    limb2: 0x9055dc9b8af3e859,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd719e4bbfd513d81cfb77cbc,
                    limb1: 0x1dce9e8a32d14ed9a0f1fc88,
                    limb2: 0xac62d5f999ba7a98,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xc0d179a47f9f4b145bfb9b3f,
                    limb1: 0x3e56a715b97dc65716d71ced,
                    limb2: 0x9055dc9b8af3e859,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd719e4bbfd513d81cfb77cbc,
                    limb1: 0x1dce9e8a32d14ed9a0f1fc88,
                    limb2: 0xac62d5f999ba7a98,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xc0d179a47f9f4b145bfb9b3f,
                    limb1: 0x3e56a715b97dc65716d71ced,
                    limb2: 0x9055dc9b8af3e859,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd719e4bbfd513d81cfb77cbc,
                    limb1: 0x1dce9e8a32d14ed9a0f1fc88,
                    limb2: 0xac62d5f999ba7a98,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xc0d179a47f9f4b145bfb9b3f,
                    limb1: 0x3e56a715b97dc65716d71ced,
                    limb2: 0x9055dc9b8af3e859,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd719e4bbfd513d81cfb77cbc,
                    limb1: 0x1dce9e8a32d14ed9a0f1fc88,
                    limb2: 0xac62d5f999ba7a98,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x27be03816544c97de0789f97213c121c, high: 0xfdc1293082ae752f2d4076bcf9cb2ee8
            },
            u256 {
                low: 0x34dd7624c3d9b3b022b56be11392a255, high: 0x7f2a2e65c6596f7fea455fc7c80cb483
            },
            u256 {
                low: 0xf8247e70b2194ff3c46ac0d691ca9f9e, high: 0x21d32e24bb8917463c3da91136a52df9
            },
            u256 {
                low: 0x62759469c28d2ad53bd3147dd0f0c75d, high: 0x21ee302e974d9d499bc698825a7c831a
            },
            u256 {
                low: 0xeaf94919e69b79717f9b76efa1057256, high: 0x6a8e22fd57caf0d9db3466d1ba6cc61
            },
            u256 {
                low: 0x7d3c279b5bce228b989bb03086c47b06, high: 0xf568c9c6033c14694f06ea1874a26444
            },
            u256 {
                low: 0x29bccee9a71b80ef8e36b82f3856be31, high: 0xcf2a21987ea496f5e10b4aada92d6b05
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x38d12d13f935f3b41dc6a4,
                limb1: 0x1ec94243b143ee4d733e0690,
                limb2: 0xb79b12734ec0d787,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x7f2204387ab8f23e80f9f2aa,
                limb1: 0xb11c7a620b718801a9f13278,
                limb2: 0x168f2bfb4429464c,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x17f538c6ae2d45a27716626d,
                limb1: 0x6db02d1360c9d4a38c5eefb5,
                limb2: 0xdb0fd3ebef78207b,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x6aa9d46ee663117766d68418,
                limb1: 0x5eb6e53f8241cca5989965ce,
                limb2: 0x29338a1d55c57a05,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x330bcf3958618b1bedf49408,
                limb1: 0x19f629461003a63c47d51a23,
                limb2: 0x1c57a9a425c3cb9f,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x6b4b7060a116c9193728c02,
                limb1: 0x38dfcde1c4835bb9199f8bee,
                limb2: 0x3ff852bbd5356b49,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x684315b601982f71c062d859,
                    limb1: 0x2f740af97cc267aacd37828f,
                    limb2: 0xae1ae4ce942a4f78,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf7b78f220a0059e7f200aaf0,
                    limb1: 0xffffffffffffffff608fe7f4,
                    limb2: 0xffffffff00000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x57aecf1851c8cb5413d4728f,
                    limb1: 0x983d3c8e6121e1150c59f384,
                    limb2: 0x5ed6c03090c443ca,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3ef5b52e6c677ef7efe69e1b,
                    limb1: 0xa2e016a6953e4b5b75eadc84,
                    limb2: 0xb80f10ef264b4021,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xc7946ccd0cc30a76526cf96f,
                    limb1: 0x7dcc4c534a7567265d793873,
                    limb2: 0x5de64a1783fb5699,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x83ff2b1ffed27f94c020d979,
                    limb1: 0x55eef5ed81a5b8da311c8e4c,
                    limb2: 0x317c8d48697bc5a8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x35d5136f2547f05519b5a39d,
                    limb1: 0xe64994e6963de295ab818157,
                    limb2: 0x94fe646e20961c28,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xc9320c113b5c7117ebc3cd1b,
                    limb1: 0x172a6814c8291559ae3a79f6,
                    limb2: 0x3e5b05488e05dffa,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x623010de2938c334d72a1113,
                    limb1: 0x239057048b605816caeffa13,
                    limb2: 0x6bbbe1a979bb92bc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf72916af697bf56581e85f8,
                    limb1: 0xcb4b7961b6dda4aa035c7126,
                    limb2: 0x329903093758d384,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x57aecf1851c8cb5413d4728c,
                    limb1: 0x983d3c8e6121e1150c59f384,
                    limb2: 0x5ed6c03090c443ca,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3ef5b52e6c677ef7efe69e1b,
                    limb1: 0xa2e016a6953e4b5b75eadc84,
                    limb2: 0xb80f10ef264b4021,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x5f379464c1ae088998baed48,
                    limb1: 0x74181a8c24d3ddd048111969,
                    limb2: 0xfa7b4fd2ce663d20,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2ae5ab21aba3875cbfe4a187,
                    limb1: 0x7ffffffffffffffeafa4a11d,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xf886b65a4f64c825c7c7e3f0,
                    limb1: 0xd3387f45807ba3a7156feb07,
                    limb2: 0x30e0e129ce6df8d5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x27394d94d2336f492cee0252,
                    limb1: 0x53f92bd6e5b865055cc9f35f,
                    limb2: 0x949a4f768593f72d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x1fb0dced3a3f8b0095bb1af9,
                    limb1: 0x76936cdb1867811cd2e42f78,
                    limb2: 0xa7632b2d8aa02b03,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9d4aeca1b7c7bebe8fd57d19,
                    limb1: 0xed5215d52b2b3c176796b6d8,
                    limb2: 0x138a8f335ba8bc8b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2abcc0d1db9f31849224f98b,
                    limb1: 0x158bfe0615e8304f33667679,
                    limb2: 0x4ee8ee5bbeb6cf73,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x7fd33f9bebf550ddd02c5ef4,
                    limb1: 0xda692c41f89e940690c2b578,
                    limb2: 0x2d5e955a5b4cf011,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf0908e1363bcc680dbff8a2c,
                    limb1: 0x38d9728d4eca9ef2554d8906,
                    limb2: 0x766eab448e2aa7d7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x56a7c837c533ee62a1085953,
                    limb1: 0xb80039d0c56f57ac4ebf2c95,
                    limb2: 0x9cf74773197eae61,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf886b65a4f64c825c7c7e3ed,
                    limb1: 0xd3387f45807ba3a7156feb07,
                    limb2: 0x30e0e129ce6df8d5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x27394d94d2336f492cee0252,
                    limb1: 0x53f92bd6e5b865055cc9f35f,
                    limb2: 0x949a4f768593f72d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xae02e5ff315702c7f3953f00,
                    limb1: 0x9db4e738546cce440d0ff476,
                    limb2: 0xdd9710f2e8ee60c6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5784a91a5e09d24e7c4a2665,
                    limb1: 0x7fffffffffffffff7c074594,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x160bb374e9dc1f90a1e1efa3,
                    limb1: 0xa4a75da2bf48a54366f7e30c,
                    limb2: 0xe56e847724ebba9f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb4fef7fff9712f419af5098a,
                    limb1: 0x7859a9a68f3285202bcbf628,
                    limb2: 0x898826eeac413e6,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xf2fc9d7658829b1b8c1a4e76,
                    limb1: 0x10ed2d28dc90c2ef31ee7af5,
                    limb2: 0xf4eb3449e3157679,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3b9ef71d3a00a55383510709,
                    limb1: 0x1f635fb97777e35dbaa01f18,
                    limb2: 0x1eea3e4d791bff55,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb186ab11df2a75b36b4b73c,
                    limb1: 0xb7890abd916675c1432b7c4b,
                    limb2: 0x1544d65940c7f809,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xd74a7c44bba0e236d507f02f,
                    limb1: 0x62c0183fccd8c5c0f1a8405b,
                    limb2: 0x156a92dd9039785a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x95fc4fcd2ab35cf3dc22476c,
                    limb1: 0x1005726406c601a818ff9273,
                    limb2: 0x1df3c67a1818d62,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xad56c8f64f7aae7956f343ad,
                    limb1: 0x4adec061c900f75be1b92436,
                    limb2: 0x40fcae8be9ee5834,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x160bb374e9dc1f90a1e1efa0,
                    limb1: 0xa4a75da2bf48a54366f7e30c,
                    limb2: 0xe56e847724ebba9f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb4fef7fff9712f419af5098a,
                    limb1: 0x7859a9a68f3285202bcbf628,
                    limb2: 0x898826eeac413e6,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x9a898f21eaa5498f6c1714d3,
            limb1: 0xa82110c2049c5085469c2ddf,
            limb2: 0x1bb75d1c15e49a50,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x48924d6fae06cd57a0dbae85,
                    limb1: 0x145967f291efee7f53399153,
                    limb2: 0xb4b367673c9172bb,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x8d44bb57861701634f6d6405,
                    limb1: 0xac4608e2aad67edf9229e0ce,
                    limb2: 0x10eb30a1abe43836,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_8_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x1fea06c81bb219cb6c79b4b5,
                    limb1: 0x686df687ebf6c6b85be3e99c,
                    limb2: 0x251cc11856f078f4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xffde95e0a13828ce4f649bdb,
                    limb1: 0x70c37ccfcd462279d778cf91,
                    limb2: 0x450e1b1c0e6dded6,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1fea06c81bb219cb6c79b4b5,
                    limb1: 0x686df687ebf6c6b85be3e99c,
                    limb2: 0x251cc11856f078f4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xffde95e0a13828ce4f649bdb,
                    limb1: 0x70c37ccfcd462279d778cf91,
                    limb2: 0x450e1b1c0e6dded6,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1fea06c81bb219cb6c79b4b5,
                    limb1: 0x686df687ebf6c6b85be3e99c,
                    limb2: 0x251cc11856f078f4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xffde95e0a13828ce4f649bdb,
                    limb1: 0x70c37ccfcd462279d778cf91,
                    limb2: 0x450e1b1c0e6dded6,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1fea06c81bb219cb6c79b4b5,
                    limb1: 0x686df687ebf6c6b85be3e99c,
                    limb2: 0x251cc11856f078f4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xffde95e0a13828ce4f649bdb,
                    limb1: 0x70c37ccfcd462279d778cf91,
                    limb2: 0x450e1b1c0e6dded6,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1fea06c81bb219cb6c79b4b5,
                    limb1: 0x686df687ebf6c6b85be3e99c,
                    limb2: 0x251cc11856f078f4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xffde95e0a13828ce4f649bdb,
                    limb1: 0x70c37ccfcd462279d778cf91,
                    limb2: 0x450e1b1c0e6dded6,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1fea06c81bb219cb6c79b4b5,
                    limb1: 0x686df687ebf6c6b85be3e99c,
                    limb2: 0x251cc11856f078f4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xffde95e0a13828ce4f649bdb,
                    limb1: 0x70c37ccfcd462279d778cf91,
                    limb2: 0x450e1b1c0e6dded6,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1fea06c81bb219cb6c79b4b5,
                    limb1: 0x686df687ebf6c6b85be3e99c,
                    limb2: 0x251cc11856f078f4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xffde95e0a13828ce4f649bdb,
                    limb1: 0x70c37ccfcd462279d778cf91,
                    limb2: 0x450e1b1c0e6dded6,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1fea06c81bb219cb6c79b4b5,
                    limb1: 0x686df687ebf6c6b85be3e99c,
                    limb2: 0x251cc11856f078f4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xffde95e0a13828ce4f649bdb,
                    limb1: 0x70c37ccfcd462279d778cf91,
                    limb2: 0x450e1b1c0e6dded6,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x66dfeb1e9ab3cc27232f8c5b425832c0, high: 0x5100f186d25ab04930e9be17b4134208
            },
            u256 {
                low: 0xf19b43da6253dfe34aaeb212c90ded29, high: 0x50ae265209cd3bdf356af7370f2670d2
            },
            u256 {
                low: 0x3fe65f90f631681ebf401e04b9f94ec6, high: 0xab1e679470f2297adceb201357d9af8d
            },
            u256 {
                low: 0x39d5b552a867a0f0a8e6a772b9cde60c, high: 0x298e9a79abecfc0b581ba30742965873
            },
            u256 {
                low: 0x92d6ff735b3a4595045892c14e0e15d3, high: 0xa1645f58bb78eb2d0ee5144d8a1d8b42
            },
            u256 {
                low: 0x7db931ce05a0f4215a79b46a26b61b06, high: 0x3dd0c8660649def50fb2de1ea0b976c2
            },
            u256 {
                low: 0xf20e8bda39cc6d88032f594d0b82b61c, high: 0xd22a3a621109197853a081a6a7647989
            },
            u256 {
                low: 0xa9fa4ea6f8db1a4d584d3c020ff9d318, high: 0xec071cf1e47638ec22c71d046c32faff
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xe7504b7a39f41057694d601d,
                limb1: 0x9bd81c08ffd28aa6f0babd7d,
                limb2: 0x62d17f67abfa670e,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xe4c925d1077dc59e75402ad6,
                limb1: 0xd54cc1d934376a203d983c1a,
                limb2: 0xd76bd7d71dbbdcbd,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x2811b41f780d8ca2c51d1644,
                limb1: 0x271bf1bac0f3739343c57c01,
                limb2: 0x974ee09254bfd611,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xc853b1669e743257e56123c7,
                limb1: 0x1c83ec5340764272833626b,
                limb2: 0x7dc51c9e8bfbde58,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xebe8cf7faa9bfce74d781dad,
                limb1: 0x935bb527dc9047254a55565e,
                limb2: 0xa4f5116533d87e92,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xb6c614863afd229c2c753c91,
                limb1: 0xad2ca9db697fc2007371c8c8,
                limb2: 0x93b3d289f3d7268d,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x48b259ef4bdbe3498e9c2a22,
                    limb1: 0xe45a3723e0b8891b9be1cf89,
                    limb2: 0x84e7a3e33633c374,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9b758b0e2eb0cc3bd3acc14f,
                    limb1: 0x7fffffffffffffff798f3ee7,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x841d487098add434cbd8b0b1,
                    limb1: 0xc97f161263f82fe2d0d05f11,
                    limb2: 0xbb80a0ea630ced58,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf8c5adbdaa59d5dd2a38eb2d,
                    limb1: 0xfbb9ed6f1436aea0b36158e6,
                    limb2: 0x7811bf7efd151ffd,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xae256cd7ac080e41735d0e64,
                    limb1: 0xdc1cff0910d990d89d47b340,
                    limb2: 0x29e46633eacd0ae1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf9b98c499841ae1b838183f8,
                    limb1: 0xce7cea87a27d0bcba9ce9d56,
                    limb2: 0x38735e0b0a0341c8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x92303bb0243509e431aebae9,
                    limb1: 0xb9e74964e7d08f1bf514db27,
                    limb2: 0xe95c04ece2925066,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x5e9569dc903c425d0ac66a83,
                    limb1: 0x4f91f0cb9386844f0023cad7,
                    limb2: 0xbcc6978712315f18,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2ba7a1d528a3e95253b46736,
                    limb1: 0x566cb0da658a2bfecc862c04,
                    limb2: 0xbca36de9aa056d45,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe202a7bd3cc0baa6a9279ec2,
                    limb1: 0xc0bdf50839f47ada4af8fbfd,
                    limb2: 0xf290f759b2fb33ef,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x841d487098add434cbd8b0ae,
                    limb1: 0xc97f161263f82fe2d0d05f11,
                    limb2: 0xbb80a0ea630ced58,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf8c5adbdaa59d5dd2a38eb2d,
                    limb1: 0xfbb9ed6f1436aea0b36158e6,
                    limb2: 0x7811bf7efd151ffd,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xb9b02af0ac2f6586983b98fa,
                    limb1: 0x9003e1bfb313a774991a2617,
                    limb2: 0x507f3d2def7a1f9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xef1f051d3b33c09b853f2ebf,
                    limb1: 0x7fffffffffffffff497970b1,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x4354f6263e66a379b585f2e0,
                    limb1: 0xa881058e0f73d93886dfa17a,
                    limb2: 0xcd320485ab5208b3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb80445186c405991ce693506,
                    limb1: 0x707617bd5315c5b460569a63,
                    limb2: 0x43945e54544fb0fb,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xa45fec79f36ce2fe352fa7d7,
                    limb1: 0x40cdd8b8084f3cf1355513a4,
                    limb2: 0x4d1583c00679bcb9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3dfebc2ec2d411104250bd28,
                    limb1: 0x6a2005c38ded3668aa63c4f0,
                    limb2: 0xc0dd4a9a73db6f86,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4ab2e1c4ffde986c6014159d,
                    limb1: 0xc603425f02ed93be1c99f0ef,
                    limb2: 0x3fe790ab9ea2ea81,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x46420503ffd145d65c606675,
                    limb1: 0x446ce2636e11ab24d74e9cbc,
                    limb2: 0xdafd0c5eb7c3369e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x56e2831b7fc8988ce0cfe703,
                    limb1: 0x6589774b5707ffb73ced4c3f,
                    limb2: 0x6626da916bd7a0cc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa446e1acf70d2f88bc96c138,
                    limb1: 0x6289761d7d57359f44193786,
                    limb2: 0x90091adaad4b80f6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4354f6263e66a379b585f2dd,
                    limb1: 0xa881058e0f73d93886dfa17a,
                    limb2: 0xcd320485ab5208b3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb80445186c405991ce693506,
                    limb1: 0x707617bd5315c5b460569a63,
                    limb2: 0x43945e54544fb0fb,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x2beeefb29a03da811c19df96,
                    limb1: 0x547b10d9d90e89a80962e829,
                    limb2: 0x812c27762dbad576,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5784a91a5e09d24e7c4a2665,
                    limb1: 0x7fffffffffffffff7c074594,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x757cf6651cd704ce54c3dcb0,
                    limb1: 0xbe35a9f69aeb4c28e8c051f7,
                    limb2: 0x9770714872146e92,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xec057c60dd567675ed6acc0d,
                    limb1: 0x4588591d627c454771e52da1,
                    limb2: 0xc3bc0e067767ab5e,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xfef9137d0504b6459b64f674,
                    limb1: 0xb3fda9d6f2ed0c81bf72ad2a,
                    limb2: 0xdb05e89ebf3288,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8dc4d91470fd8f627ce3b895,
                    limb1: 0x91e430c7e8e2eb0abd37e876,
                    limb2: 0x9a7b7bf5b77cce4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x529b7e0b376c8d430319c5af,
                    limb1: 0x5115d0815f71915c156d30a,
                    limb2: 0x66f7e054010ad564,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xc61f7e04f49faa07a548754c,
                    limb1: 0xbc92e1afcaf09117b7fbedc7,
                    limb2: 0x607a8cdb8e00118c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x269bf38c054b2cf694a9fbbf,
                    limb1: 0x49f4464dc36fc57054f545a5,
                    limb2: 0xeb0c7a290c3de07a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8433bd3a3cad8dc5f91fc22,
                    limb1: 0xe352b1fd4f23b6e60f6d7dcd,
                    limb2: 0xf920bc3440391ce,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x757cf6651cd704ce54c3dcad,
                    limb1: 0xbe35a9f69aeb4c28e8c051f7,
                    limb2: 0x9770714872146e92,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xec057c60dd567675ed6acc0d,
                    limb1: 0x4588591d627c454771e52da1,
                    limb2: 0xc3bc0e067767ab5e,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x601ae9b1ecac7762191dbb42,
            limb1: 0xed9f52efaf24930588569b85,
            limb2: 0x69ba45361847b98,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x287e79f052a704bb35ed44,
                limb1: 0x46a351816a115294cf028079,
                limb2: 0x21980b2eec129f4a,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xf82a38e4991702e515ec6d93,
                    limb1: 0x777ba43a90365bf74c4cb7de,
                    limb2: 0x32a1dc2c23a5a62a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x92527a7efe083ae8342452be,
                    limb1: 0x1ffd3a9ae6d54904b58fb643,
                    limb2: 0x97c34bd2e2b96b6b,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_1_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xaf40a41e858cd462f8d20422,
                    limb1: 0xea5c48052716184f774cba2c,
                    limb2: 0x70f59d4ce237bca0,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2e398630a2e2de3f7e4a4217,
                    limb1: 0xf119d1c696a1718f92e128dc,
                    limb2: 0x47f825812ab1a7ca,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xc90853fdfc9ea692ba626aee542d19c0, high: 0x27752fe61f68c6e689c0559bf4fa4a3
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x1d078dc4ab28aedb3723ea9a,
                limb1: 0xfef048c16f49e8321a9ff637,
                limb2: 0x7916c8adfb7459a8,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x48366f647582307f97aabffb,
                limb1: 0x6adcbc292e78fdb9651ea584,
                limb2: 0x5806b883950a7019,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xf77f3f71a32621479d0e10aa,
                limb1: 0xaad4aa08d2c492d59f8e1c8b,
                limb2: 0xf0070850f276c83f,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x611a92682b304cc8b645bba0,
                limb1: 0xf8b66de5f2123c86d720caaa,
                limb2: 0x5df7f93cd6535c03,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xbab891f5351c95fb2f7bac0f,
                limb1: 0xdc9330c37a5dba49d57158d4,
                limb2: 0x4ee74909a1443934,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x6d1093759b7578e71b92459b,
                limb1: 0xeb4ac362e5ef7918dda706bd,
                limb2: 0x9e00a86f94912fb5,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xc108c23c8d82884542fd5531,
                    limb1: 0xc9852f282de52dca1d814602,
                    limb2: 0x4207957253b735ce,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x25ba8e8f3744fa215cad512f,
                    limb1: 0xffffffffffffffff82ecf37c,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x62b8de53b159739f8b520546,
                    limb1: 0x41c224ea4b5364f35194184d,
                    limb2: 0x28ff465e29574966,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x33b7ce1ccf4a7cc0d00a0d73,
                    limb1: 0x16b36f39699fff7e6e134f9c,
                    limb2: 0x15f39a052253e9b6,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x38c8f95275d6ba8dbf20d4d7,
                    limb1: 0xcfc852de94b138cd1e6f9cdf,
                    limb2: 0xb6ec1047d7bdfe75,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd8b4597c7090ca082a2482ae,
                    limb1: 0xd22fa0832c48f420d7c02c5a,
                    limb2: 0x89d6c875d5413d60,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3d09dadfd861a8e4b37c7e7d,
                    limb1: 0x4d5a053f2d8d156c06d35efa,
                    limb2: 0xd13bb4a9423e4099,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xb30e1449d972295dcf3e28bb,
                    limb1: 0xcc4f02680f47c2a73b0caa1d,
                    limb2: 0x1efaec93216301cb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6a06a2c9ab096945b0465e25,
                    limb1: 0x9ee80a91e35ffc7502872d45,
                    limb2: 0x99a93623f04b63fa,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x62b8de53b159739f8b520546,
                    limb1: 0x41c224ea4b5364f35194184d,
                    limb2: 0x28ff465e29574966,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x33b7ce1ccf4a7cc0d00a0d73,
                    limb1: 0x16b36f39699fff7e6e134f9c,
                    limb2: 0x15f39a052253e9b6,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xabe1ec321ab47dbc35ba987,
                    limb1: 0x6825116a310c5488b40aa8b7,
                    limb2: 0x2c1d826500cdf1b3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6875329ad8861fbc7cdd8ee3,
                    limb1: 0xfffffffffffffffffe74a1e3,
                    limb2: 0xffffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x6257eb544040b218018318fb,
                    limb1: 0x67a2a5bb26f27736fac0a4d2,
                    limb2: 0x42d5f44ddbb2e5a6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x59401c6fd74d0a536a1fe392,
                    limb1: 0x6acf0df2062554dae9252947,
                    limb2: 0x9f035a622b517b1f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xd76cb6defab34098b18c4817,
                    limb1: 0x12b4db94feab1c4cd43b9b91,
                    limb2: 0xe038effccf45fa7a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdea2c55ddac4f574a6d464f,
                    limb1: 0xfd06d3cae413908c2c908e65,
                    limb2: 0x2bea34a509fec5b7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6b6db717c4953aa62c652ac5,
                    limb1: 0xb0d0f17fbd9155792833e296,
                    limb2: 0x2b11263df5a563f3,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xb0676f4dc1c4dea90a95b2ae,
                    limb1: 0xd572881e10a14280db4481c0,
                    limb2: 0xd3d9ae2101e4478c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x70c0c70ee31b484be6df4842,
                    limb1: 0xeba9619e2b0551fc600420f3,
                    limb2: 0x591778af2f3a5ddb,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x6257eb544040b218018318fb,
                    limb1: 0x67a2a5bb26f27736fac0a4d2,
                    limb2: 0x42d5f44ddbb2e5a6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x59401c6fd74d0a536a1fe392,
                    limb1: 0x6acf0df2062554dae9252947,
                    limb2: 0x9f035a622b517b1f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x28ba7e7df7ba6d071986433c,
                    limb1: 0x31dad4fee81f520b2472ab3b,
                    limb2: 0x55bce8e8f93103c1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24dfc4a247d,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xf48da3a8836fbfb5f1a74038,
                    limb1: 0x2da39c5373c1257040a20617,
                    limb2: 0x89f6202d5501c0ab,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4dc82e9927bd48bb33763ba5,
                    limb1: 0x78982533b2ddb2e08b008a9f,
                    limb2: 0xc111aea56c44fe8b,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x9b8e6a4b5acf7f55ac5921cf,
                    limb1: 0x65c7a0a70487e9329109c987,
                    limb2: 0x779646281f119bd2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7a32bbe3b7ef404bc8b2133a,
                    limb1: 0x2b4b64617220fa8230bb043b,
                    limb2: 0xb717f906ee72f13f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9b764e4dfad61a177c3b6176,
                    limb1: 0x35abf894fef6f99ea3b36565,
                    limb2: 0x2ff765041ae9e6fd,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xafdf799b980e3dfc9b92ccfb,
                    limb1: 0x3f7946482a480611c46e2aa7,
                    limb2: 0xc5bae13d530c44ae,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x20794630162cfd23683bb498,
                    limb1: 0x4c290469e40fe423cd03ca5b,
                    limb2: 0x477bc685f5e2f5d0,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xf48da3a8836fbfb5f1a74038,
                    limb1: 0x2da39c5373c1257040a20617,
                    limb2: 0x89f6202d5501c0ab,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4dc82e9927bd48bb33763ba5,
                    limb1: 0x78982533b2ddb2e08b008a9f,
                    limb2: 0xc111aea56c44fe8b,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x8f8ff23f9254622771ce6a84,
            limb1: 0x738a24c7c5cda8600733caa,
            limb2: 0x231aa5944cb43765,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x6094455e5f588641793b265e,
                limb1: 0xff5815f19265e1ea52782570,
                limb2: 0x5a4ab3a27657191e,
                limb3: 0x0
            },
            u384 {
                limb0: 0x4898dafda1e3ed866cf3fef4,
                limb1: 0x39ca8660ac0c48c8a345788b,
                limb2: 0xf36296b37809dd4,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xf5b2e14dd1495cc7723f0ef6,
                    limb1: 0x89104ce7f88c60f1823dc703,
                    limb2: 0x450b2c1432395dd5,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x85973ca3b21a77c7311d50ff,
                    limb1: 0x1cdec7e52ded3e7bcd680b07,
                    limb2: 0x494681dc66a0578f,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_2_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x9208f4ed39cc6a59a1eef63f,
                    limb1: 0x6ad49cdca4c9b09b67d12c63,
                    limb2: 0xab22f3285e4dbe7e,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xec41d3087b8918e3ca23f5cf,
                    limb1: 0x911590555fca16c4ba821431,
                    limb2: 0xe9f5c813cd360bc9,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x9208f4ed39cc6a59a1eef63f,
                    limb1: 0x6ad49cdca4c9b09b67d12c63,
                    limb2: 0xab22f3285e4dbe7e,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xec41d3087b8918e3ca23f5cf,
                    limb1: 0x911590555fca16c4ba821431,
                    limb2: 0xe9f5c813cd360bc9,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xc253763876703835b476998dafc8128a, high: 0x1f626a97ebe7ef9190920b690abc847e
            },
            u256 {
                low: 0x2bdb572063eaa07ff436498e68afe2b8, high: 0x9f312acb2362dbc18024532000cbd313
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x5664e5b00fc370394c00323d,
                limb1: 0x9450209f8ab410e19b813b2,
                limb2: 0x97b790d3d522d584,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xcd293083ac8891b2a2a4e15e,
                limb1: 0x607fdc7cbd5a59dac2e5da73,
                limb2: 0x1e8df635c079df32,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xff8cee65d84e74b2d0d4b75d,
                limb1: 0x938cd2ac3f380748a79fc281,
                limb2: 0x33c3049506988751,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xfcc7daec36eaaa392433b635,
                limb1: 0x872473bd15532cde4ef4701d,
                limb2: 0x20900c5fe5304f2d,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xa0148bb44ac2fd8f95d03fb9,
                limb1: 0x4d857eadcae33b538467ac37,
                limb2: 0x16ff60dd2f52f809,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xc07d1ace6f12e28279105f08,
                limb1: 0xe92f78c0b3e327b4bc7df55d,
                limb2: 0xb4b5d909d4c78da7,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x626ace7632fdea645165ba10,
                    limb1: 0xb16648a8bc99644ece20629a,
                    limb2: 0x3ee218e4d588831c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3e429c3e184c76303a96536f,
                    limb1: 0xffffffffffffffff752b4fe3,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x4899acdb3a49e62c36c39cad,
                    limb1: 0x4d702093947e596178a92bc4,
                    limb2: 0xe322ae187dbb181f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x17922562b670256b1210cfe2,
                    limb1: 0x8be66119628b0e567e76bfea,
                    limb2: 0xbd257c03cc8f6bfd,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xa45ecb8c57f9d7d550436540,
                    limb1: 0x6b5d4f5f67f8c485049ad138,
                    limb2: 0xa02c1d27d5cb8667,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x56b7570e1793f8b4cc38edee,
                    limb1: 0x4aa0265c0018fc1426e13033,
                    limb2: 0x43eba8aac4d3180,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf8c33eb1e94a8f14f327225c,
                    limb1: 0x811c1730321001c7e90629ab,
                    limb2: 0x78826494d6591682,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xfc33b9fe98054b3b7f595fa1,
                    limb1: 0x1e10e4090f7471aa4ca0325d,
                    limb2: 0x35f2c2ab701da8db,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa4ff05b2fd1105f27e75c243,
                    limb1: 0xd34ca7b1b1cd645d753f3f66,
                    limb2: 0x2c06641a97ebf3ee,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x4899acdb3a49e62c36c39cad,
                    limb1: 0x4d702093947e596178a92bc4,
                    limb2: 0xe322ae187dbb181f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x17922562b670256b1210cfe2,
                    limb1: 0x8be66119628b0e567e76bfea,
                    limb2: 0xbd257c03cc8f6bfd,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x6d4a05a0475ba540ac6c100d,
                    limb1: 0xf68a71595d52468effcb1d59,
                    limb2: 0x76c0bf50f2cef8fa,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x453c7c20a89a3b54d9f0483d, limb1: 0x180d9bb9, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x6b4ad57e3cd93a3f7ea5c36a,
                    limb1: 0x88d4a0249b9e1f356e71fcd3,
                    limb2: 0xd53b7ac84f0ccdc4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6e6a1cacede520f28d3c4e93,
                    limb1: 0x19e90771bfe481bf08f111a,
                    limb2: 0x211a08429b19ba30,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xc6fa9638e4ffe8bcdca5c103,
                    limb1: 0x2493f435e4dc19f4a3cbc1bc,
                    limb2: 0x227bfd31d69ea921,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2c28b048e577d75c8d0d0c25,
                    limb1: 0xd5494f1ae41ad0535a07a270,
                    limb2: 0x7130d136d1b11fdf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5dabfd94fedb37b5603c493a,
                    limb1: 0x133420597a812b56daad435c,
                    limb2: 0x1c1d4904b5f0b8d6,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xef0bd673a9f097c176886afb,
                    limb1: 0xbdd061004152da76051de9c7,
                    limb2: 0xd4a05b7a2959a05f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4e6c8ba8143e6a1dca62605,
                    limb1: 0xb55f341c3f3f8c393e977b9,
                    limb2: 0xe7b639d23db41750,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x6b4ad57e3cd93a3f7ea5c36a,
                    limb1: 0x88d4a0249b9e1f356e71fcd3,
                    limb2: 0xd53b7ac84f0ccdc4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6e6a1cacede520f28d3c4e93,
                    limb1: 0x19e90771bfe481bf08f111a,
                    limb2: 0x211a08429b19ba30,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x2022d39c8a832e18093c90e5,
                    limb1: 0x529c771a05dde825f4b955eb,
                    limb2: 0x14e9d6668e478776,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24dfc4a247d,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x74a389b3b0a4ba87e1fcb3ab,
                    limb1: 0x1e2b1a418c560f545c5488fb,
                    limb2: 0x9896981e1de8f843,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x605e85e5dcee8dbc995b0519,
                    limb1: 0x1eedaea5f5e4bd63d3f89146,
                    limb2: 0xb53d9a8dca1480a5,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x5949246e8b7f94512f848b78,
                    limb1: 0xc66c3ddc4c5a635f91e1ca0b,
                    limb2: 0xf82148541b87b776,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6f3047d959ec843a9b9cc0fc,
                    limb1: 0xfd7307fb77459c6cacff6574,
                    limb2: 0x86094183d248ea5e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7a1046d55b515f999dc338,
                    limb1: 0xa7d9e45aa2a5e8c8e590b99b,
                    limb2: 0xe755cdcde19b1ac,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x3078c3e9d48119bb2de8f8f1,
                    limb1: 0xd32db7cad65a6b4e864fbee0,
                    limb2: 0x2c1e28d2d15ec9d5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa295a9490a85e02c317d32f3,
                    limb1: 0xd87fc689b9412dbacbcbf8ec,
                    limb2: 0xf4af39e0868f8483,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x74a389b3b0a4ba87e1fcb3ab,
                    limb1: 0x1e2b1a418c560f545c5488fb,
                    limb2: 0x9896981e1de8f843,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x605e85e5dcee8dbc995b0519,
                    limb1: 0x1eedaea5f5e4bd63d3f89146,
                    limb2: 0xb53d9a8dca1480a5,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xd1c58755ff8dacd2040b713d,
            limb1: 0x7f442f0eb71bd475afde3c2,
            limb2: 0x3f3fd70a1eee2f5d,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x929e1bf3194b4a230950bbdc,
                    limb1: 0x8b0127a40ae8e5538abca83c,
                    limb2: 0x659b96eb9efcbce7,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb9cf5b3887c842751a548acb,
                    limb1: 0x57161b4f718d354439232c22,
                    limb2: 0x3dde31aaa84f2ea1,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_3_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xbb8f12572ec84c7d98ecf1b6,
                    limb1: 0x462127cfd538ed0eb2337a3f,
                    limb2: 0xdddcd11a368b570d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x6b261bc529ba15f9fae31c9a,
                    limb1: 0xd0ffd0d5297bc0074cc434c4,
                    limb2: 0x3a054a84f4954c67,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xbb8f12572ec84c7d98ecf1b6,
                    limb1: 0x462127cfd538ed0eb2337a3f,
                    limb2: 0xdddcd11a368b570d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x6b261bc529ba15f9fae31c9a,
                    limb1: 0xd0ffd0d5297bc0074cc434c4,
                    limb2: 0x3a054a84f4954c67,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xbb8f12572ec84c7d98ecf1b6,
                    limb1: 0x462127cfd538ed0eb2337a3f,
                    limb2: 0xdddcd11a368b570d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x6b261bc529ba15f9fae31c9a,
                    limb1: 0xd0ffd0d5297bc0074cc434c4,
                    limb2: 0x3a054a84f4954c67,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xd4088ff7d71330613cc4f772547e3918, high: 0xf22a4fc63f2de8a82d20481ad216ad53
            },
            u256 {
                low: 0xe575ae93ce749e8af4e1680b05a02c72, high: 0xd69db137c9a57cd1be28e8c52b395c4e
            },
            u256 {
                low: 0xb7c144fb2b16ad048fb87c76af044a8d, high: 0xdd5aacc7ed7a6edf6d5b7d501417d4f9
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x6fdfd11195ad39ebcfecf5d3,
                limb1: 0x1b24168710679b44fe497126,
                limb2: 0x3fc58a74f3963220,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xbcf003d8a2b076a8e765d364,
                limb1: 0xe3c70e49af1aef09258758cd,
                limb2: 0x97b509960ce76dc1,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x5c7400dc842977f83e58e0fc,
                limb1: 0xe65f3343099589470ba4500e,
                limb2: 0x22c9457918606e06,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x8ab84a5f9b3359b0841b2a2f,
                limb1: 0xf5c7b566f30e014b70f177ac,
                limb2: 0xd71642685b3820e8,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x3395cdd535104b2a336547ff,
                limb1: 0x2f04ce1ece5ec7126f212276,
                limb2: 0xd52153d66019945d,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x7e7b5fc0ea458f270b4a2190,
                limb1: 0x36048c433a6ba5a3c2378ce3,
                limb2: 0x629c3437e0d8d73f,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x876773c10ec28b988c524403,
                    limb1: 0x78299ad80ef6d71c78b841fc,
                    limb2: 0xf4d3d5622b5902dd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc6d8107f91714d7abb204a97,
                    limb1: 0xfffffffffffffffeac2b5ac8,
                    limb2: 0xffffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x9c5a754e5376ff631ab8f069,
                    limb1: 0xcfa96ed3df81e6a6fcaa5488,
                    limb2: 0x6d87d850a4b0144e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd4911c973b8a7994972610d5,
                    limb1: 0x9ebac1a91a5f77ac4f831499,
                    limb2: 0xe25da470d5de76d2,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xa34f50483aeaadc947b79b02,
                    limb1: 0x153bab54cc62da697ffbcd94,
                    limb2: 0xd2fa3a4d1bb6d0fe,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa1c683282a5d2100107b3f8b,
                    limb1: 0x7ef29f6de1fe302c417f468b,
                    limb2: 0x7710cf676f2d6411,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6ca533186e9b05219b664ec,
                    limb1: 0xea3db50448b5a29ed62fbb0a,
                    limb2: 0x2ec32486599bebee,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x467935244840fbb7bb0e9a81,
                    limb1: 0xada207cb1c8d4e90e8a84fbc,
                    limb2: 0xfeb6ea3480d08e27,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcff7c822a0c95316220a8cb9,
                    limb1: 0x571b4b9fb89c45b62c959034,
                    limb2: 0x308f7f15d9153fc2,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x9c5a754e5376ff631ab8f069,
                    limb1: 0xcfa96ed3df81e6a6fcaa5488,
                    limb2: 0x6d87d850a4b0144e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd4911c973b8a7994972610d5,
                    limb1: 0x9ebac1a91a5f77ac4f831499,
                    limb2: 0xe25da470d5de76d2,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x709dc1e9e88ad79187b43546,
                    limb1: 0x945321b638309b9dd9efe832,
                    limb2: 0x8579892c9fd731d1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc063027e396e1b1de82f40e5,
                    limb1: 0xfffffffffffffffea8eed8ef,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xb2d40887f449b4d981718d5d,
                    limb1: 0x7084b8079e6c1c6777208d52,
                    limb2: 0x2a8adf0e5b1ff237,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe7fceccc4d0e3b8828ba25ac,
                    limb1: 0xd37fa4ed213189aa422835b1,
                    limb2: 0xff59e96cb1143aeb,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x6aa3a5c7cc6e1d2896d69740,
                    limb1: 0xec4c5bd46a171141ae8358da,
                    limb2: 0xb51c92d73949fbe7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3f665bccc8b4387ff67ac3d8,
                    limb1: 0x15ec9b59148aa53d35a2ee3f,
                    limb2: 0xd6a87712e2a9026f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf630fff0a17d60a9963fe704,
                    limb1: 0x6398fc823710cce56f47a65e,
                    limb2: 0xc17eaa28352b291c,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xe3cc3bb7ae03f1f38a1ae15c,
                    limb1: 0x13a1083554f4c6d441e3dd42,
                    limb2: 0x29cc19647ddf9f84,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x57ea79961b63a0bf1d171e9a,
                    limb1: 0xc87d827be85ac3a7cf1977dd,
                    limb2: 0xfb7561f8d78d9c72,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xb2d40887f449b4d981718d5d,
                    limb1: 0x7084b8079e6c1c6777208d52,
                    limb2: 0x2a8adf0e5b1ff237,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe7fceccc4d0e3b8828ba25ac,
                    limb1: 0xd37fa4ed213189aa422835b1,
                    limb2: 0xff59e96cb1143aeb,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xde4133741292ef707e8b25c2,
                    limb1: 0x7f787193cfa7383b39b7486c,
                    limb2: 0xb69b93f7fc009e8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24dfc4a247d,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xe9fa36c6b6a77ba586ab7d77,
                    limb1: 0xe76b0ec27d927725eb197cd3,
                    limb2: 0xa4df21407b36bb2f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6ff6314e46c63cdc8e41d334,
                    limb1: 0xea9bfe9e280bafa6853a8d7b,
                    limb2: 0x81566b08785fd9b,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x9acd5db0427f2d19b51a513e,
                    limb1: 0x4f169de0f21999b3c74a0834,
                    limb2: 0x7124334b9191489a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4f4dc433ba8a32382f649452,
                    limb1: 0xa0c677ec354c712cfeb943fa,
                    limb2: 0x1e83d5c5a51787a2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xca58f32b0bc963d5d41b14da,
                    limb1: 0x5f1a8b9e2d5e79f182536f88,
                    limb2: 0x2bd95b9b18a6bcd5,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x65d77f6efe94618aaeb07d85,
                    limb1: 0x53ed67516f0142096db269cb,
                    limb2: 0x8219e8c35e7f1e4f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfbb5923ef6baa07e3ccc66c,
                    limb1: 0x6a43f6531851cd8da499de60,
                    limb2: 0x3895ced3b4a9ef43,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xe9fa36c6b6a77ba586ab7d77,
                    limb1: 0xe76b0ec27d927725eb197cd3,
                    limb2: 0xa4df21407b36bb2f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6ff6314e46c63cdc8e41d334,
                    limb1: 0xea9bfe9e280bafa6853a8d7b,
                    limb2: 0x81566b08785fd9b,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x626c5e7b932e7347c9ed5d6c,
            limb1: 0xf8e569af9db0caf408db8626,
            limb2: 0x3e0f428941b863ec,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x4fff0e4d35c4e58309a6120d,
                    limb1: 0xa6c94404600f8b71f63f98c8,
                    limb2: 0xbc95eeb676a0e55f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x97cc5d8ac85623c73fee9f90,
                    limb1: 0xf20b85dd69d13a46d2194b06,
                    limb2: 0xab930e7fa61ce6c6,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_4_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x8ea3f7f3e59ea86c78202af2,
                    limb1: 0x246f4167cebf92020ef2f36,
                    limb2: 0x46f868e70853b9be,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf1df9a39503f85562c0fe26c,
                    limb1: 0xcf6a4198e133838e8aef94a,
                    limb2: 0xcef3d1ac6dae7b66,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x8ea3f7f3e59ea86c78202af2,
                    limb1: 0x246f4167cebf92020ef2f36,
                    limb2: 0x46f868e70853b9be,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf1df9a39503f85562c0fe26c,
                    limb1: 0xcf6a4198e133838e8aef94a,
                    limb2: 0xcef3d1ac6dae7b66,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x8ea3f7f3e59ea86c78202af2,
                    limb1: 0x246f4167cebf92020ef2f36,
                    limb2: 0x46f868e70853b9be,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf1df9a39503f85562c0fe26c,
                    limb1: 0xcf6a4198e133838e8aef94a,
                    limb2: 0xcef3d1ac6dae7b66,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x8ea3f7f3e59ea86c78202af2,
                    limb1: 0x246f4167cebf92020ef2f36,
                    limb2: 0x46f868e70853b9be,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf1df9a39503f85562c0fe26c,
                    limb1: 0xcf6a4198e133838e8aef94a,
                    limb2: 0xcef3d1ac6dae7b66,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x571aa4f640a210150a40a3799a1ab357, high: 0x606375b8bb937826bcee9d29ce4f1ca0
            },
            u256 {
                low: 0xe3b4df81eeb3462ca032149d06fafb60, high: 0x5bbdd1f416f14aad7f107645094c0230
            },
            u256 {
                low: 0x754724dd269b6c3babf0f4bd4af0a6fe, high: 0x298b7e5d5b1654ad81e774de3c740119
            },
            u256 {
                low: 0x566ff3ec679b29e8c0c32da9bc49b58e, high: 0xf1c58f447e083c1bcda6a326451437d6
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x8098c945eb1131fe76c2633b,
                limb1: 0xf0c06237ff51bd3f6c603526,
                limb2: 0x65db1669fdf35,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x3f22a685a928f3aabbee49eb,
                limb1: 0xa86dfd8ee05bfc62662762de,
                limb2: 0x6b2ba49059733a3c,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x8b8a1078933de88f534f0462,
                limb1: 0x27afecf1e276d843b4b10504,
                limb2: 0x4e746cff8fc3c96a,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xd2576d42dec4bb24e893e046,
                limb1: 0x1ca5dfd7f5558df26b9ad5e3,
                limb2: 0xa527822caf161cc7,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xfbd0f0f68d023731294940d1,
                limb1: 0xfabaf794237b6cb535551028,
                limb2: 0xc8ef50a8a5c65505,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x64277b27e1e03b552e3b2f74,
                limb1: 0xa5c1d2cb6bc7a8363372e159,
                limb2: 0x3fb22af3239f33fd,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x9a0ca19074ab51ced6d91e02,
                    limb1: 0xbe651ed7cdb95859a25015cb,
                    limb2: 0xdda8514aabf4493b,
                    limb3: 0x0
                },
                u384 { limb0: 0xa74ec2fc31d56ff2f9b156, limb1: 0x1bdf723b, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xb84ed5d25e6d17869e09abf5,
                    limb1: 0x811fbef26242c4cd1afe2313,
                    limb2: 0x8d5e645d8b2c447f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf0c33ec62f502594111d6e02,
                    limb1: 0xcf8a9b183c249a072b09ba2,
                    limb2: 0xb9013967910c670c,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x9a8e9a38505b7c78adf62853,
                    limb1: 0x6cb5db80f2e819cb9fb3a9a8,
                    limb2: 0x1c77cc9ff907f1c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe070c06102ad64630fcd3782,
                    limb1: 0xa1fee4e7aeff689c4e0d28b6,
                    limb2: 0x76ca69e742778e06,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x34322b3d4e909efa7f5c3012,
                    limb1: 0xa1fdf63d2f3018eea13a1eb5,
                    limb2: 0x591c2f802cf6fe66,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xa27d8c094fba4b15243bf26,
                    limb1: 0x87de38a0afd3619bbcf2f58a,
                    limb2: 0xdd94be8ece35df7c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9556b76b4b31071177ce1523,
                    limb1: 0x5acca3da9a50036322d44174,
                    limb2: 0xf0891d4f756d154,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xb84ed5d25e6d17869e09abf5,
                    limb1: 0x811fbef26242c4cd1afe2313,
                    limb2: 0x8d5e645d8b2c447f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf0c33ec62f502594111d6e02,
                    limb1: 0xcf8a9b183c249a072b09ba2,
                    limb2: 0xb9013967910c670c,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x6ae27c34ebfc07601d7b5c26,
                    limb1: 0x46a05d2a04e0338b2d842f3,
                    limb2: 0xa9a6c74a7dc0c495,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x53989af6b988f1f4626ebb25,
                    limb1: 0xffffffffffffffffd45708c2,
                    limb2: 0xffffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xf330ecca9ce3ab3e5c337e25,
                    limb1: 0x634d507e389675b621db5480,
                    limb2: 0xe4d0f509d1265b4f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe5d1f79387236f033490ccdb,
                    limb1: 0xd6091ef7a09d2e9c2a5fcbc4,
                    limb2: 0x6a932a1967e87cd7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x2f70ac6b43769789bbeda6f,
                    limb1: 0x587faadf2d4aa8e6dbf74afe,
                    limb2: 0xd518889445431829,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xecc656f55d4c216490e1cb8a,
                    limb1: 0xfa62ec44746de6fb4b89505e,
                    limb2: 0xcba511aaad64941b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1f5ba0cdaa89dc339256c3a4,
                    limb1: 0x51d0d93ffcf134c891d4dd6f,
                    limb2: 0x1cb4468c80cb5d36,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xa656798a4a39aeba856889e9,
                    limb1: 0xb71d33738c1d37faecff4f86,
                    limb2: 0x41b6b344b80c7f2b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x48bdc508b1f809186ff5a19f,
                    limb1: 0xda3fd8c5644c4645289e9262,
                    limb2: 0xea0626b1d75b69e6,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xf330ecca9ce3ab3e5c337e25,
                    limb1: 0x634d507e389675b621db5480,
                    limb2: 0xe4d0f509d1265b4f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe5d1f79387236f033490ccdb,
                    limb1: 0xd6091ef7a09d2e9c2a5fcbc4,
                    limb2: 0x6a932a1967e87cd7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x921ca66bcebdf12e2751863e,
                    limb1: 0xd003e6e8c12da5945ffe5eac,
                    limb2: 0x83a4ea08dac60855,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24dfc4a247d,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x9955c525bbd64c107d5641dc,
                    limb1: 0x2d30de1f3805f5556f62d943,
                    limb2: 0x6edaba0ab200cf44,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x78a4fe90dfbfe03d8367b32b,
                    limb1: 0xdd951b79fa0dbb0715f9ead2,
                    limb2: 0xe89c4257ca75e18f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x44e58309185e0106d64c773f,
                    limb1: 0x76c53b744abb545e199c73cc,
                    limb2: 0x8af3005c7fdff68c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa3193792d3aa255cc63c8231,
                    limb1: 0xa47e3c0354de3ed90bef88a6,
                    limb2: 0x3ea52798414317d0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa15a3bff967e723f9bf36484,
                    limb1: 0x7a72bc878d7c7c6aab133de3,
                    limb2: 0x2035e0d749f0544d,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x3158640822dc14766d5bd877,
                    limb1: 0x3c5612da8829b5560bb3f0d9,
                    limb2: 0x7fb164ade05aadd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4c82f5f61e3f21b497d5fd13,
                    limb1: 0xf13c055d6601d3199d56bc1,
                    limb2: 0x5c45d06689392aef,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x9955c525bbd64c107d5641dc,
                    limb1: 0x2d30de1f3805f5556f62d943,
                    limb2: 0x6edaba0ab200cf44,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x78a4fe90dfbfe03d8367b32b,
                    limb1: 0xdd951b79fa0dbb0715f9ead2,
                    limb2: 0xe89c4257ca75e18f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xc1c4ca7c81514f74592c3bdf,
            limb1: 0x2cdccbc60641b0bf85eb4fd5,
            limb2: 0xefd8874dca17293,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x827ff27df2674a01f0e6826a,
                    limb1: 0x28552d77a3dce84903f4689,
                    limb2: 0x42b618c26015143b,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5b1e2f45459a0e54f3d27999,
                    limb1: 0x3804751c14fcebc618ad64c8,
                    limb2: 0x282a80a406b06aba,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_5_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xa05cb1bfa8d6033bfd77cd41,
                    limb1: 0x2cd8a4c9624c269564eb7769,
                    limb2: 0x168ce0db0106369c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1d281499f5251796a09e46e8,
                    limb1: 0xc97716b5fd4513b383c51794,
                    limb2: 0x572b63d8a81f3cc8,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xa05cb1bfa8d6033bfd77cd41,
                    limb1: 0x2cd8a4c9624c269564eb7769,
                    limb2: 0x168ce0db0106369c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1d281499f5251796a09e46e8,
                    limb1: 0xc97716b5fd4513b383c51794,
                    limb2: 0x572b63d8a81f3cc8,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xa05cb1bfa8d6033bfd77cd41,
                    limb1: 0x2cd8a4c9624c269564eb7769,
                    limb2: 0x168ce0db0106369c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1d281499f5251796a09e46e8,
                    limb1: 0xc97716b5fd4513b383c51794,
                    limb2: 0x572b63d8a81f3cc8,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xa05cb1bfa8d6033bfd77cd41,
                    limb1: 0x2cd8a4c9624c269564eb7769,
                    limb2: 0x168ce0db0106369c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1d281499f5251796a09e46e8,
                    limb1: 0xc97716b5fd4513b383c51794,
                    limb2: 0x572b63d8a81f3cc8,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xa05cb1bfa8d6033bfd77cd41,
                    limb1: 0x2cd8a4c9624c269564eb7769,
                    limb2: 0x168ce0db0106369c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1d281499f5251796a09e46e8,
                    limb1: 0xc97716b5fd4513b383c51794,
                    limb2: 0x572b63d8a81f3cc8,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x88239867c5dd967b08f1100bfa3222c4, high: 0xef208346432fb3088d56206d920c3de9
            },
            u256 {
                low: 0x6522ff4674b7061c09ce15a8afd4fc7b, high: 0x58ba0bf3675e0c521eb95739b8acdd81
            },
            u256 {
                low: 0x45e695b1054b88160d18533e7efa2faf, high: 0x4100e66508c626a9fee4e6bcbd6deb92
            },
            u256 {
                low: 0xb3e4bd3a94fe31a0ae2e45a4ae4404d7, high: 0xfeb46b244a2edd41eddb0263c6a2894d
            },
            u256 {
                low: 0xc33993f235045f77c317c3d4afa4f554, high: 0x62d59938571c9d788429aeae877e5ea1
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x571be7cdd4b95097f57fae3e,
                limb1: 0xd644c94f81b198cb11daacf,
                limb2: 0x3888379952f277a7,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x9fd759577c4130eae5627e4d,
                limb1: 0xe53623078e328385570171c2,
                limb2: 0xd506566d62701f5f,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x9524b69388c21da1aa4b60ed,
                limb1: 0x2244b309fab5c7e57a90b8fc,
                limb2: 0xc74e15ad24665370,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x5dabe9a5b12a35b22eca1e51,
                limb1: 0xd628402452172076065e0397,
                limb2: 0x13eadb2f4bda6c1e,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x2e45d97585beb19fb31d2921,
                limb1: 0xfa6b7cdff40725b99b97cb52,
                limb2: 0x3e2f922add034501,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x700e280ef48c4cb583c1037f,
                limb1: 0x3f3df621f2128de986678494,
                limb2: 0x590af8b4da829d01,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xee42b89296ebbd411c2cc3d6,
                    limb1: 0x8b3bf56c7e655685e493089d,
                    limb2: 0x668f3fe15187d6a5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x299344fb9ec4d4c5e6c20cdc,
                    limb1: 0xffffffffffffffff8a1ae129,
                    limb2: 0xffffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x183c553f1938f31acd8a6bde,
                    limb1: 0x2a6070d4b8969a8bad38be27,
                    limb2: 0xa696c16095f6e8ac,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x88766728270ac2b0d0880b0,
                    limb1: 0xc5c30ea1a598bfdde9f6ddc7,
                    limb2: 0xb0eae78bac0751bc,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x589c132ffee1f917c41988d2,
                    limb1: 0x2c0625d51ac93d8eccc42457,
                    limb2: 0xc84e2c12d16846ef,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5b0db5cfe694baf6be80bbb6,
                    limb1: 0x6c475251ab6f76fad6b81913,
                    limb2: 0x4632f2c3076be3a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x118c8c83305de65cc360c8ef,
                    limb1: 0xac65db4543881434c0d84b16,
                    limb2: 0xe10409045b2ed63f,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xa9a654b9b08ea5bf9ec90256,
                    limb1: 0x28a315d10c1e39d1bc8d3311,
                    limb2: 0x8e1f49a419c05cb5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3bb3cd219114b5315b3b9414,
                    limb1: 0x6855666b872d3f1165c01071,
                    limb2: 0xd66c54d1b4333c29,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x183c553f1938f31acd8a6bde,
                    limb1: 0x2a6070d4b8969a8bad38be27,
                    limb2: 0xa696c16095f6e8ac,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x88766728270ac2b0d0880b0,
                    limb1: 0xc5c30ea1a598bfdde9f6ddc7,
                    limb2: 0xb0eae78bac0751bc,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x753b58e56571bca7860fa636,
                    limb1: 0x35026a975454b0bc75244a7b,
                    limb2: 0x2ec5446f1b691b8a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb23d4e80fe52b90175bf0840,
                    limb1: 0xffffffffffffffffa1d3edd6,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x83f89839bc6edcf27cedce74,
                    limb1: 0x3c57ec66c1022ddb7557b0a5,
                    limb2: 0x4da16d6d3b24,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xca7e97acce67df21583cce01,
                    limb1: 0xb0e2a82ca2fe11852083cf99,
                    limb2: 0x22250977da9375f3,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x1327e4cae4ab3d09fbb1ac8f,
                    limb1: 0x929c6536dcfe685dc683a52b,
                    limb2: 0x30ef1071f1ef24f7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5e8409eee615378c0cf18587,
                    limb1: 0x8db02f0629bccc66426fd54f,
                    limb2: 0x5b5c5c515550f9cd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1d4b7b0bb30a7e2ba7041880,
                    limb1: 0x150ac0a1917823f8b6d6fbcc,
                    limb2: 0xbbce3a15b7c9f4b0,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x9bcc299427080aa16a80a52c,
                    limb1: 0xa66776cf470f41003565d486,
                    limb2: 0x21f69fdfc9dfd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x897625b9a4d719e969a9a207,
                    limb1: 0xd632993874f27aa3e39aad34,
                    limb2: 0xef034246fa0839a9,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x83f89839bc6edcf27cedce74,
                    limb1: 0x3c57ec66c1022ddb7557b0a5,
                    limb2: 0x4da16d6d3b24,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xca7e97acce67df21583cce01,
                    limb1: 0xb0e2a82ca2fe11852083cf99,
                    limb2: 0x22250977da9375f3,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x8a2eb6f6dddb7171a8a392cd,
                    limb1: 0x4c5ae1ae64639d6848809de7,
                    limb2: 0x14eb8160775fae37,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24dfc4a247d,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xd64b90131ebf02de7a460594,
                    limb1: 0xd0e19dc6e3510b94ba3e46df,
                    limb2: 0x5a142d349afa49fd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3c956ff6f17f30bca2976e50,
                    limb1: 0xe34fd01611431260e9d77bb1,
                    limb2: 0xfa825827fe96678d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xba472ec403de23e03c53d014,
                    limb1: 0xef165f71ce662736ab41eae4,
                    limb2: 0x5285fd62773f7b1a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9d1e02401449ef4eb483c6d0,
                    limb1: 0x1b74341b49252dee32c6f7d9,
                    limb2: 0x81b62fa0baf79c87,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb870a084360d72a4eb4ff49c,
                    limb1: 0x8158d10aa2ab73d6dc6be281,
                    limb2: 0xd05fa4f712c6a162,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xdc10f085d739141757ea2eae,
                    limb1: 0xb62b50703737511117b3f01e,
                    limb2: 0x768d3c703cd805f0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa8160fc09a7a552e72241b16,
                    limb1: 0x372eb09a78d580a664e461d8,
                    limb2: 0xd9906917f61cd4e1,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xd64b90131ebf02de7a460594,
                    limb1: 0xd0e19dc6e3510b94ba3e46df,
                    limb2: 0x5a142d349afa49fd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3c956ff6f17f30bca2976e50,
                    limb1: 0xe34fd01611431260e9d77bb1,
                    limb2: 0xfa825827fe96678d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x8de3fdd9a48ab8dc1c7af958,
            limb1: 0x4b35a0d9633c6711c56c8595,
            limb2: 0x5d0a646c22c42938,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x6a7734dbf23ecdec0978b73d,
                limb1: 0x36528a5f9e869df9fe81df93,
                limb2: 0x3b2b40ab06728c61,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xb7a1e589a66a3c5f6a8e1574,
                    limb1: 0x4273470a7d30c46b029ad430,
                    limb2: 0x82c78e2caef15502,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x8d5701c37a867a474aa4488e,
                    limb1: 0xa3974aadf342286c7af353ec,
                    limb2: 0x933427c2a8f44762,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_6_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x2e99eca8b057d6da8ffb207e,
                    limb1: 0x4ecdba6efa5b7549824290d6,
                    limb2: 0x4e2408bb0fce290e,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x8c44db31c01fcad86a0f579d,
                    limb1: 0xc97b1084e5f624cc54012e4c,
                    limb2: 0x547de5824a54567a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2e99eca8b057d6da8ffb207e,
                    limb1: 0x4ecdba6efa5b7549824290d6,
                    limb2: 0x4e2408bb0fce290e,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x8c44db31c01fcad86a0f579d,
                    limb1: 0xc97b1084e5f624cc54012e4c,
                    limb2: 0x547de5824a54567a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2e99eca8b057d6da8ffb207e,
                    limb1: 0x4ecdba6efa5b7549824290d6,
                    limb2: 0x4e2408bb0fce290e,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x8c44db31c01fcad86a0f579d,
                    limb1: 0xc97b1084e5f624cc54012e4c,
                    limb2: 0x547de5824a54567a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2e99eca8b057d6da8ffb207e,
                    limb1: 0x4ecdba6efa5b7549824290d6,
                    limb2: 0x4e2408bb0fce290e,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x8c44db31c01fcad86a0f579d,
                    limb1: 0xc97b1084e5f624cc54012e4c,
                    limb2: 0x547de5824a54567a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2e99eca8b057d6da8ffb207e,
                    limb1: 0x4ecdba6efa5b7549824290d6,
                    limb2: 0x4e2408bb0fce290e,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x8c44db31c01fcad86a0f579d,
                    limb1: 0xc97b1084e5f624cc54012e4c,
                    limb2: 0x547de5824a54567a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2e99eca8b057d6da8ffb207e,
                    limb1: 0x4ecdba6efa5b7549824290d6,
                    limb2: 0x4e2408bb0fce290e,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x8c44db31c01fcad86a0f579d,
                    limb1: 0xc97b1084e5f624cc54012e4c,
                    limb2: 0x547de5824a54567a,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xf16f1487f7f21e5cce0755e354565b12, high: 0xac825818960da7883e1e165decadbb86
            },
            u256 {
                low: 0xe02a35e9ae6b4c8e88644581b8577478, high: 0xde386aebea96abe6299cf16b5a7583c0
            },
            u256 {
                low: 0xd8a1a54654a6087c272eaa36e642965c, high: 0x95be263b0253dc8cd1f0c570bf5545ce
            },
            u256 {
                low: 0x27fa8b8a909b471c0d1f0a7fd0fce922, high: 0x4a8b77da5cfa38b1583678eef3ca5f64
            },
            u256 {
                low: 0x7eaf167952b049944b1dd9fda02ebb76, high: 0x6e56627499c7abea6756264dc8649f78
            },
            u256 {
                low: 0xc9d0a7f400425fc62b8771dffccae6b8, high: 0x711fa10a0b2975c6918ff3582408c3c2
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x1cbbe53be5dca6eb36d35bab,
                limb1: 0x65a027224c51bab7f043f859,
                limb2: 0xee45db0a2f019142,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x866cda7e4997e2b75f4575d8,
                limb1: 0x22ca96ffc029426e04cc0c90,
                limb2: 0xce2c9518f4d0cab,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xdb78eeb008de8d27d9964d0f,
                limb1: 0xd645eef8cbfb0ef6b652e1e3,
                limb2: 0xef7077291fc10165,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x3485f6ae1a3b12f2e25bd09e,
                limb1: 0x66b2a93f8ba821ec156f8cd,
                limb2: 0x404bc97755db75b,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xae32c9af5ae93843ef49a98b,
                limb1: 0x2ba69203f7bd6af5b13c7b97,
                limb2: 0x77c7f24d013326da,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xf9f0201bd3014c02d42bb72d,
                limb1: 0x6208c0d9d59a2a0322ddb52a,
                limb2: 0xaf78c158111e3cbe,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xa5e005332fbc6657723c8c3,
                    limb1: 0x8751e187878567b201b12d95,
                    limb2: 0x5df3143f26e3eb22,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf3b4625feffb595544c5b887,
                    limb1: 0xfffffffffffffffe4e5b5707,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x772516b6d1dbf31993261cea,
                    limb1: 0xfa9ac19fdd1890cab35a7f1e,
                    limb2: 0xfd3320c82eeec5cf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb4aa2e1b69cb823839317c35,
                    limb1: 0x4b921e6eb952cffe8d7976d0,
                    limb2: 0xc3961c3ac13045af,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x1428dc5da29b746d78c32108,
                    limb1: 0x3f4deffc5147cac91c5d2c04,
                    limb2: 0x970c6c94fe7e54ed,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcf5f97c3a517809de2673302,
                    limb1: 0xbc211f7fe89233af92e5959e,
                    limb2: 0xa7ddf4113d879194,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe8726ab96c20350f90c677a5,
                    limb1: 0x9ec0dadd50835b6215af03c3,
                    limb2: 0xb7266b72ca117bd4,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x42039effbd03a5b9060ae14c,
                    limb1: 0xda3b4b5f0babf58ae77979d5,
                    limb2: 0xec65e579488768af,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf0a742bfe4908f8e905a7888,
                    limb1: 0x10fed5071143aff5de523fb4,
                    limb2: 0x591ac59b4851e7cb,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x772516b6d1dbf31993261cea,
                    limb1: 0xfa9ac19fdd1890cab35a7f1e,
                    limb2: 0xfd3320c82eeec5cf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb4aa2e1b69cb823839317c35,
                    limb1: 0x4b921e6eb952cffe8d7976d0,
                    limb2: 0xc3961c3ac13045af,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xacbc7c06e833b129389b686a,
                    limb1: 0xda775fdbbd8d21ca682f1493,
                    limb2: 0xfc75b445537a0436,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfde6f46e3b7558a42043b30a,
                    limb1: 0xffffffffffffffffcfdb2dd0,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x1dd17eef5823d99748998a16,
                    limb1: 0x37579b89372ae9098c69d161,
                    limb2: 0x7ae3ea26b306ec9d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf5ed24a746c99bfb966e8ad1,
                    limb1: 0xdaec569839a97bbfc76a8d45,
                    limb2: 0xc26b801bd070d58b,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x2af22c588a8573a75b3c08d3,
                    limb1: 0xc03b02836e2d820d33098bb4,
                    limb2: 0x4f229d948c82541,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb70b4ecea836e486a384a104,
                    limb1: 0x991948ba681a69f81b525e62,
                    limb2: 0xe98528b928139955,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6869c22fa3e4f49e863039e2,
                    limb1: 0x69493535197385d4916f0e73,
                    limb2: 0xfea0f4356004ab07,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xd0ba788b68faf325fc32d20d,
                    limb1: 0x836540c0822c5f42d6e4b9a7,
                    limb2: 0x5c3b670ee530784c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb97c0092ef8343e61d05decc,
                    limb1: 0xfc765e2993a2623e73e9dce9,
                    limb2: 0x50f080c2b315d6d2,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x1dd17eef5823d99748998a16,
                    limb1: 0x37579b89372ae9098c69d161,
                    limb2: 0x7ae3ea26b306ec9d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf5ed24a746c99bfb966e8ad1,
                    limb1: 0xdaec569839a97bbfc76a8d45,
                    limb2: 0xc26b801bd070d58b,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x1d9ae347993235167370f2a3,
                    limb1: 0x4e786f52588af26084760589,
                    limb2: 0x63168b46fd93cf1e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24dfc4a247d,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xf5765102a715d533fb33eeed,
                    limb1: 0x45689019893c69ad42f48730,
                    limb2: 0xa3b7687d62cd8303,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x765447a09c383a92372001c4,
                    limb1: 0xfe137f033c4786139870a284,
                    limb2: 0x98c79689df0bd7bf,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x502368ea69ebd57785eae64f,
                    limb1: 0x37508a83a2d1b5bf72b42841,
                    limb2: 0x4e6f774789fb56a1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd83b0dd14c06a670d0bd09b9,
                    limb1: 0x49bf3b9b031108230aa0fd62,
                    limb2: 0x76c8c06bcd46c03,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbdfdd30eee2a37bc605bcbe4,
                    limb1: 0x2939f973ad11aae47d0944d3,
                    limb2: 0xa49a066aa9455964,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xb63c37129198d46fde6b97bf,
                    limb1: 0xe5dbf0b2c0a6e3bcd4afb256,
                    limb2: 0x7a03db6db39e9516,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3c4df56445899a0381e01ba0,
                    limb1: 0xf2887916a5f4aa892b14719f,
                    limb2: 0x2d751dc51952e63f,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xf5765102a715d533fb33eeed,
                    limb1: 0x45689019893c69ad42f48730,
                    limb2: 0xa3b7687d62cd8303,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x765447a09c383a92372001c4,
                    limb1: 0xfe137f033c4786139870a284,
                    limb2: 0x98c79689df0bd7bf,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x343f59d4e86eb567cb83b5e9,
            limb1: 0x605bdfafca90c85b58a73506,
            limb2: 0x66e5285baa0a3261,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x21063713e00fba589081e453,
                limb1: 0xb795a4bdccee00445e6b6ebf,
                limb2: 0x40ae2e1759d4b8f4,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x5d192f8285a8a0a1d9f476f7,
                    limb1: 0x50692be08314cd01cf80a6e7,
                    limb2: 0x11c7720072214fd1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xad66bdc9338294609fb9fa8e,
                    limb1: 0xacb2f76cd6cd6335fc07891,
                    limb2: 0x69e2917dfe4ebcc9,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_7_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x806e8883fd02cd967f5357bf,
                    limb1: 0xcef534afc06bc100add222ba,
                    limb2: 0x11f29a28f83f79fc,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3fa54932fb548f77689185ad,
                    limb1: 0x43ca8c1a3205d324294c5a65,
                    limb2: 0x6d17428b4e93f58e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x806e8883fd02cd967f5357bf,
                    limb1: 0xcef534afc06bc100add222ba,
                    limb2: 0x11f29a28f83f79fc,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3fa54932fb548f77689185ad,
                    limb1: 0x43ca8c1a3205d324294c5a65,
                    limb2: 0x6d17428b4e93f58e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x806e8883fd02cd967f5357bf,
                    limb1: 0xcef534afc06bc100add222ba,
                    limb2: 0x11f29a28f83f79fc,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3fa54932fb548f77689185ad,
                    limb1: 0x43ca8c1a3205d324294c5a65,
                    limb2: 0x6d17428b4e93f58e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x806e8883fd02cd967f5357bf,
                    limb1: 0xcef534afc06bc100add222ba,
                    limb2: 0x11f29a28f83f79fc,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3fa54932fb548f77689185ad,
                    limb1: 0x43ca8c1a3205d324294c5a65,
                    limb2: 0x6d17428b4e93f58e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x806e8883fd02cd967f5357bf,
                    limb1: 0xcef534afc06bc100add222ba,
                    limb2: 0x11f29a28f83f79fc,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3fa54932fb548f77689185ad,
                    limb1: 0x43ca8c1a3205d324294c5a65,
                    limb2: 0x6d17428b4e93f58e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x806e8883fd02cd967f5357bf,
                    limb1: 0xcef534afc06bc100add222ba,
                    limb2: 0x11f29a28f83f79fc,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3fa54932fb548f77689185ad,
                    limb1: 0x43ca8c1a3205d324294c5a65,
                    limb2: 0x6d17428b4e93f58e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x806e8883fd02cd967f5357bf,
                    limb1: 0xcef534afc06bc100add222ba,
                    limb2: 0x11f29a28f83f79fc,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3fa54932fb548f77689185ad,
                    limb1: 0x43ca8c1a3205d324294c5a65,
                    limb2: 0x6d17428b4e93f58e,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xa9afa87ad181d9bfaa099a46f25a3c68, high: 0x9cb9f9aabf4ddeaa41f2005bc7537df5
            },
            u256 {
                low: 0xefa2ce128c83384811fba56e300a2187, high: 0xd48457dff3254f2d47595b016c835975
            },
            u256 {
                low: 0x103393102b7bde99878f40ed2c805ac7, high: 0x94665d45284b7bcda3af11d0a8ab29f1
            },
            u256 {
                low: 0xa1d3377281011c5bf110397a1c2c7a34, high: 0x627b9de79ae445e08b1dc2f8cbf1f93c
            },
            u256 {
                low: 0x4fb7c3bb4408c04c6f446806c1378e75, high: 0xc74dd25c6dbf859c037d975248f3531c
            },
            u256 {
                low: 0x47caf779b7c97da8d1db32f8fda834ea, high: 0x86fadb0e89b1e0d44218ca25f23db306
            },
            u256 {
                low: 0x579e9a46fd768f635163de1d8df7a267, high: 0x6e83a7b2c857d8c3b4a0697630a31251
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xac10ff31bf5e0e36667df663,
                limb1: 0xe9107f2662608e9a6e26b6,
                limb2: 0x220a9228a73cd46,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xfdeb674ecfce87a55c5e3b6,
                limb1: 0x2ff950734af53097e2ecb99c,
                limb2: 0x3f23b1798c39f175,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x670843a96b1dcf9034ef1ad6,
                limb1: 0xcc5814fce18a83feaaad75a6,
                limb2: 0x61e6cbceb592be39,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x1fa7823b9b99b945cc69849f,
                limb1: 0xe0a880569e038866d9ea2c45,
                limb2: 0x97ae00bb80eded27,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xb262d0b3c1ed730851e907bf,
                limb1: 0x26e9d23a5cbceb52a6cd25d3,
                limb2: 0x8af17db48c1a93c6,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x7514e051bb3929dc41acdc8c,
                limb1: 0x56a3b750f796961c9dc7f411,
                limb2: 0xf696a5b283e39898,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x15e7aa6fd7937c1c58a60e17,
                    limb1: 0xcb80d7877f94c1ff21286cc0,
                    limb2: 0xd7b60a1c886346f7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x987728c08a14f17c410df7fe,
                    limb1: 0xffffffffffffffffbb436824,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xdad8c4e8d70151e50cf0828c,
                    limb1: 0x6a3800315497bfa05c250ff8,
                    limb2: 0x62806491791a5b9f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd380784a439f24321a2eae0d,
                    limb1: 0x3021bad11931de70b7bfb68e,
                    limb2: 0xebecbcb47d4cb8bd,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x335f1325cd32da57b467c7df,
                    limb1: 0xc1d018e21172291733b6eada,
                    limb2: 0x88c13099e7ed6209,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xeddb411610b44096102b183a,
                    limb1: 0x3e848ae9dc79c95e3388e939,
                    limb2: 0xbe559c156d0d5121,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc568021374cd0ede1559cb55,
                    limb1: 0xae25d51a822da1831123ed47,
                    limb2: 0xeb0e4c743bcf99c2,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xfbed625de1093d455a939976,
                    limb1: 0xe788015950263d6285036fcd,
                    limb2: 0xb182bffa4fb8815b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc8834a07d959fd64b746d941,
                    limb1: 0x50ec1bb7b05d1515063dfde7,
                    limb2: 0x737928ef6d190d2c,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xdad8c4e8d70151e50cf0828c,
                    limb1: 0x6a3800315497bfa05c250ff8,
                    limb2: 0x62806491791a5b9f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd380784a439f24321a2eae0d,
                    limb1: 0x3021bad11931de70b7bfb68e,
                    limb2: 0xebecbcb47d4cb8bd,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x4cbe53bc9742a13c4f49b554,
                    limb1: 0x44c16e3933c7829eaad3e4f0,
                    limb2: 0x275cd41cedd552cc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x97349c9347879919a74cc325,
                    limb1: 0x986aa1b,
                    limb2: 0x8000000000000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xee1fcb194df45921b46eb1c6,
                    limb1: 0x52c02c546e84ba6b9ae14ed,
                    limb2: 0x1a7eb9725adbbef6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x188933d297df62d84bbd899a,
                    limb1: 0x64b2b6535e09bb00a780679f,
                    limb2: 0x8c269a08522dc7c9,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x75267f350a21c9266ba4374c,
                    limb1: 0xe19b8f05c3301ee5eb1a5403,
                    limb2: 0xa734a5e18acce5a0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa29a846b4af165c89d5a22e3,
                    limb1: 0x5568f6aae13f11be00c5029,
                    limb2: 0xe51a57b0f846921f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x52346d505d095173f19b0bf6,
                    limb1: 0xc99e7c401e120e63a90d33d,
                    limb2: 0x3898a37fcf514a13,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x82de8db121ae6febef06dc6a,
                    limb1: 0x24341364f05a118f13c29281,
                    limb2: 0xb97712207c0238ba,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xabc06ac2271bb3ed122ecea9,
                    limb1: 0xc0e2fc4792441d049482d559,
                    limb2: 0xd50e363a3f407681,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xee1fcb194df45921b46eb1c6,
                    limb1: 0x52c02c546e84ba6b9ae14ed,
                    limb2: 0x1a7eb9725adbbef6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x188933d297df62d84bbd899a,
                    limb1: 0x64b2b6535e09bb00a780679f,
                    limb2: 0x8c269a08522dc7c9,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xe89cff020f2050e5b654b079,
                    limb1: 0x66229fd8d6833a088b01851f,
                    limb2: 0x32d17e6167d261d2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24dfc4a247d,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xb85748922e0344ee2d32ede7,
                    limb1: 0xec33caa6639d44dad83385e2,
                    limb2: 0xdf660cae3b70556d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe694eba2d2f4bd667927d99a,
                    limb1: 0xcbe18c8c1b890aeae856485,
                    limb2: 0x1327b67cbe52ae00,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xa6e1027cdcbd55b62e4f4c66,
                    limb1: 0x9f38040db6e6c0d672a8cec,
                    limb2: 0x7406c1402272904c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc0c3a4c3aa46d99caa7e3a3b,
                    limb1: 0x6c9801c4eff7169666585c34,
                    limb2: 0xe49d41bfcf518f12,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x923eae84f5da2ef567c9585b,
                    limb1: 0xeb560d8b7843a767d01ba6e7,
                    limb2: 0x7bc7adef9530d55f,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xa62fbff4216e2893c649837,
                    limb1: 0x756a8a8cb94ce1fbe968a933,
                    limb2: 0x1bca58c3a0125601,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4e127173c4b12dcd5016f336,
                    limb1: 0x5932ad7d4c0bf4c6c5a5bfa9,
                    limb2: 0x8615fd693442c200,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xb85748922e0344ee2d32ede7,
                    limb1: 0xec33caa6639d44dad83385e2,
                    limb2: 0xdf660cae3b70556d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe694eba2d2f4bd667927d99a,
                    limb1: 0xcbe18c8c1b890aeae856485,
                    limb2: 0x1327b67cbe52ae00,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xb23cc4d93cb6c0ebacd318cf,
            limb1: 0x3c436926c4e60ada5b5a11b0,
            limb2: 0x64e31ec060f228a5,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x5def69b34305d53a9adbbed2,
                limb1: 0x491b23ecab5c4489454b2032,
                limb2: 0x6356c2a3774f75ca,
                limb3: 0x0
            },
            u384 {
                limb0: 0x614d240bf9ee66c610d817e1,
                limb1: 0x9a6e346fb9fcc49ba562c386,
                limb2: 0x35544e52ab96db83,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xd6589653c6cffc6e0ed3a844,
                    limb1: 0x997ccede9eb5419948bb8344,
                    limb2: 0x86ab438db4baaa6,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x29b10cc3dfdbf5421fcf6d18,
                    limb1: 0xc9bdf2ddc2cdc67a90e6843d,
                    limb2: 0x58e116c74e2e09d6,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_8_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xb7fbac678abbbc6850eeccd,
                    limb1: 0xf687d97f743c277829b21ec6,
                    limb2: 0xb1e21007b58bb4d2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xdbc29b64182f6ab6c0f4bb96,
                    limb1: 0x13a5c31d4b7cdf1e5d619df,
                    limb2: 0xef199910610e616c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb7fbac678abbbc6850eeccd,
                    limb1: 0xf687d97f743c277829b21ec6,
                    limb2: 0xb1e21007b58bb4d2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xdbc29b64182f6ab6c0f4bb96,
                    limb1: 0x13a5c31d4b7cdf1e5d619df,
                    limb2: 0xef199910610e616c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb7fbac678abbbc6850eeccd,
                    limb1: 0xf687d97f743c277829b21ec6,
                    limb2: 0xb1e21007b58bb4d2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xdbc29b64182f6ab6c0f4bb96,
                    limb1: 0x13a5c31d4b7cdf1e5d619df,
                    limb2: 0xef199910610e616c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb7fbac678abbbc6850eeccd,
                    limb1: 0xf687d97f743c277829b21ec6,
                    limb2: 0xb1e21007b58bb4d2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xdbc29b64182f6ab6c0f4bb96,
                    limb1: 0x13a5c31d4b7cdf1e5d619df,
                    limb2: 0xef199910610e616c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb7fbac678abbbc6850eeccd,
                    limb1: 0xf687d97f743c277829b21ec6,
                    limb2: 0xb1e21007b58bb4d2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xdbc29b64182f6ab6c0f4bb96,
                    limb1: 0x13a5c31d4b7cdf1e5d619df,
                    limb2: 0xef199910610e616c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb7fbac678abbbc6850eeccd,
                    limb1: 0xf687d97f743c277829b21ec6,
                    limb2: 0xb1e21007b58bb4d2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xdbc29b64182f6ab6c0f4bb96,
                    limb1: 0x13a5c31d4b7cdf1e5d619df,
                    limb2: 0xef199910610e616c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb7fbac678abbbc6850eeccd,
                    limb1: 0xf687d97f743c277829b21ec6,
                    limb2: 0xb1e21007b58bb4d2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xdbc29b64182f6ab6c0f4bb96,
                    limb1: 0x13a5c31d4b7cdf1e5d619df,
                    limb2: 0xef199910610e616c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb7fbac678abbbc6850eeccd,
                    limb1: 0xf687d97f743c277829b21ec6,
                    limb2: 0xb1e21007b58bb4d2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xdbc29b64182f6ab6c0f4bb96,
                    limb1: 0x13a5c31d4b7cdf1e5d619df,
                    limb2: 0xef199910610e616c,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xc81236e6ec77cfc8b38e5adba93fa902, high: 0x76d142d05c66a9bb62574c5a903374bf
            },
            u256 {
                low: 0xe994f3e68fc4edd3094f7d5af313c0b0, high: 0xcc68fd3f9d37da5ca2fc7fe3696100ac
            },
            u256 {
                low: 0xe65a3ae43a72017dc29ed120cddb2316, high: 0xfb46ed398772c3475cba9be3040464c0
            },
            u256 {
                low: 0x31cb5e8eae2562ca28948b4cf0fcccc6, high: 0xb3390a6ea0b87e455abec113a1832fdb
            },
            u256 {
                low: 0xbc39e1b3bb1d867704e6748a7f3ab7dc, high: 0x3df8eeefe44a01f69251ad083fcb34fa
            },
            u256 {
                low: 0xc2112edaf1e7ea9b2f6570d74643d705, high: 0x92b9573113f2dc866b83f00fed2ee36f
            },
            u256 {
                low: 0xb6bca2a2be7929653c9a923672bbe7b3, high: 0xe51c0cdb824734dfdd1f8e30731c877a
            },
            u256 {
                low: 0x19b53b7fb47a5dcecf709452ce8c037e, high: 0x70c455a92a1bc11230331476f53fc3dd
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xe5c5128ac7041fd7a1bc2bb9,
                limb1: 0x3ff780b6dc3c5ed8508288f3,
                limb2: 0x18096af08b488d5b,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x8aa2d71a3bc4960289504741,
                limb1: 0x312d2abc1c06e4d3fdaa598,
                limb2: 0xf08a95f46ff6c15a,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xf84e42422975ebc8a1902e9,
                limb1: 0xcbc3d39d25dff800a941701,
                limb2: 0xedde192255317d34,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xe32ec0f8cac9c586098c024f,
                limb1: 0x2dd24902292d3286eaaf0322,
                limb2: 0x897f4bd2f6e34ea,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x18780048b418d96590509451,
                limb1: 0xdada99b9dbcba4333ba9b1fd,
                limb2: 0xbe2cab4703e2d30c,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x449d68036dc0da4c63c2221e,
                limb1: 0xe52593760b84c558df4e0c2,
                limb2: 0x15e37feaee0f8861,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x863b57ec08f829a3ad731e29,
                    limb1: 0xe7420ad2731ba1178053fc59,
                    limb2: 0x498f083097b37d47,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x86f95bc7335b7833f4fd6a4e,
                    limb1: 0xfffffffffffffffd131899b5,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x663de49bdeeae49c6667ff31,
                    limb1: 0xd515c67908dc81a524ee5119,
                    limb2: 0x776c1f9167c74b25,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xebb32aec0502460d934e3a9,
                    limb1: 0xc980a5c9af8779af85cb5846,
                    limb2: 0x36148507bf2bbdd1,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x601dd32b1eb22b871c1df51f,
                    limb1: 0xd500da44374398bfc1cba31,
                    limb2: 0xdc5901dca0fd1503,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x93fdf15b4df8be61035b817e,
                    limb1: 0x5893302cc49f9023067fa15c,
                    limb2: 0xe9f071ab36780272,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xadbf63aa674b7dffd462125a,
                    limb1: 0x47954ec7138d28bd80de02eb,
                    limb2: 0xa1059f2c1291ef57,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xcbb14043186c4049ccd805ca,
                    limb1: 0xd3986d4f3e078b84028437b1,
                    limb2: 0x43f4dcf9d6730e08,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x671e62c74230fea6f0723d70,
                    limb1: 0x82848883ccb453cca88f69ea,
                    limb2: 0x7a8fa3363a3230bc,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x663de49bdeeae49c6667ff31,
                    limb1: 0xd515c67908dc81a524ee5119,
                    limb2: 0x776c1f9167c74b25,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xebb32aec0502460d934e3a9,
                    limb1: 0xc980a5c9af8779af85cb5846,
                    limb2: 0x36148507bf2bbdd1,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x5bacb6a7dbc9d7a4dd5fee47,
                    limb1: 0x6490500af035a7308cf41110,
                    limb2: 0x847d0fc6b488353f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa6956420071be375489476b0,
                    limb1: 0xfffffffffffffffeef803dcc,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xc2ccf7b758eff516bf83e588,
                    limb1: 0xcee0144d1ec5064e5d977164,
                    limb2: 0xf39ddfc6c93bc00b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe4fb611564bce57af0d808a8,
                    limb1: 0xfcbbe946b965d907cbb9ca38,
                    limb2: 0x603fd6d5f542cdf8,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x43eb76cd50c523e02fd630d9,
                    limb1: 0x238db585b33c6350540009e4,
                    limb2: 0x555dc4ac1a69a6e7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x794ee226ef667c59296aee04,
                    limb1: 0x77bc81a15491eceafa1e17d,
                    limb2: 0x97af3517ce52d74e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6085389f30f004f623021d7f,
                    limb1: 0xba440f3a6229ccabba57b212,
                    limb2: 0x758845b43d7b07fb,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x539ac6036e8fb3a53c9b5d9e,
                    limb1: 0xa8208e1bd7632c248f2419c1,
                    limb2: 0xa9511e6f80a24052,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x42dfa795c12a465e95e8443a,
                    limb1: 0xe92360ef11c8ef369214878e,
                    limb2: 0xa1bedfd9b4d3a1ce,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xc2ccf7b758eff516bf83e588,
                    limb1: 0xcee0144d1ec5064e5d977164,
                    limb2: 0xf39ddfc6c93bc00b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe4fb611564bce57af0d808a8,
                    limb1: 0xfcbbe946b965d907cbb9ca38,
                    limb2: 0x603fd6d5f542cdf8,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xc9fc365f5006cb458473164,
                    limb1: 0xc8089351137daca8dcacdbd9,
                    limb2: 0x29e2338ee97232c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24dfc4a247d,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xf4bbea2d04c345d503068fd5,
                    limb1: 0xdc1c6ff714297168bb678812,
                    limb2: 0x7ec20fd6985b8ec3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd8031b93294fc7dbe5966124,
                    limb1: 0x1869290c51d65c4cb9c23701,
                    limb2: 0x53f53b96a6ebafbf,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x75d000dcb9095cd4415f6ba5,
                    limb1: 0x428eb3bbab39b2b89dc8c6da,
                    limb2: 0x690cc7aabad1af6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x54983b488009250f57d636d7,
                    limb1: 0x49fa27624265d3b438d87209,
                    limb2: 0x3541f15fd0b59121,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe33d7b04414d9425114ddbb5,
                    limb1: 0x831201a1a52cbcd3295a764,
                    limb2: 0x3caf40c24b3c7a21,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xb123673b2156e8d6152dfa46,
                    limb1: 0x4c70fc18d2219dd1fd4b884,
                    limb2: 0x774e6ede2a80e75b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe815c106212e7705471caf9e,
                    limb1: 0xaae01f563cdc8619144f810c,
                    limb2: 0x4bb4a11e9071ce39,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xf4bbea2d04c345d503068fd5,
                    limb1: 0xdc1c6ff714297168bb678812,
                    limb2: 0x7ec20fd6985b8ec3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd8031b93294fc7dbe5966124,
                    limb1: 0x1869290c51d65c4cb9c23701,
                    limb2: 0x53f53b96a6ebafbf,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xb7d6e9cdaf38cb2fae025149,
            limb1: 0x1f15b86e7efdbf36e41856d3,
            limb2: 0x30d4189a152e1bf7,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xf23b9e64976222fed5b50488,
                    limb1: 0xad3c494feb2f6173d0d8b62c,
                    limb2: 0xbcd143d95b1b805,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1116fcfbf8265ecaa150df71,
                    limb1: 0xf283a0c4f2818a1b00874959,
                    limb2: 0xca78e93a47281929,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_X25519_1_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x8a0c2f97941e6e87ce4df3c7,
                    limb1: 0x3eb3b32966e81c7080dc240f,
                    limb2: 0x83ccbdc827202a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd680c863d06ef8b9cced22e0,
                    limb1: 0x406d5b46edc36831e4a1275a,
                    limb2: 0x70d7484512788cd6,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xc1fa924ee1bccfb26fed6cc540b000a4, high: 0xa7d06cc9c14940d5b2d81ccc602bd20
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xd9fa636d22137662528e6f10,
                limb1: 0xa6b702489e43c58546eb4877,
                limb2: 0x4866123ecdf63329,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x7a328e78209305f18a46addf,
                limb1: 0xc00e5e9b854fb54d0acc5b6d,
                limb2: 0x36d166268859580c,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xd3d5bd052919214c0d4a34b3,
                limb1: 0x77ddb5fec2f7bcb652c84365,
                limb2: 0x62c879cb246edf56,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x32ffc46f5445e92d7d8d8f2d,
                limb1: 0xdf151dd73fdc6129e111b5d8,
                limb2: 0xb8fc04489129779,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x5d6965beac9d9188da07b756,
                limb1: 0x1148b7cf8a20d69dd902b3d1,
                limb2: 0x5ec58e17e2481db7,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xafc6e21a2fb128e880447176,
                limb1: 0x55254f5e320d020198f311a4,
                limb2: 0x1824e4a8d2f333ff,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xee7fdf402a90c70a7392d3fe,
                    limb1: 0x11a4b88e46c2c40cc0a2b517,
                    limb2: 0x3823785f8147a1f4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdd3227bce4585b00fea567d9,
                    limb1: 0xffffffffffffffff82214589,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x698ac18c4b74058a4001c744,
                    limb1: 0x59d4423aef9037d9adbf78e7,
                    limb2: 0x598d39e2c554317f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9bf96cfb49ce1b15df239d16,
                    limb1: 0x1a954a8dfad41e0a38389378,
                    limb2: 0x3716210369e2acac,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x10b7257d0e1dc473c9bfd48e,
                    limb1: 0x7547d87d7bb80812c791d7aa,
                    limb2: 0x3a44aa72de3f6f5f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x44b2eb9d594c17b8179a6274,
                    limb1: 0xd5f535e8f2d7feecb9284910,
                    limb2: 0x3a2cde929329f6b1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe3e08c4ac50f357a2870972f,
                    limb1: 0x9766b41f2d39046f31277775,
                    limb2: 0x360c93530a3d4975,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x58328b43b2ad1205bed3f74d,
                    limb1: 0x887a5dab45bae1d7705a86d8,
                    limb2: 0x16e156fd208e930f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x66bad5236137d4fc85da9a2d,
                    limb1: 0x7805b960f15eb523d395a6c8,
                    limb2: 0x4b3ce63bf3d597d1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfb182ba648551f0390d73bff,
                    limb1: 0xaade6cbc8b1d4ad15f41849c,
                    limb2: 0xf0bc17685ec66da,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x14356c36f61eb0228916689b,
                    limb1: 0x47eece59a3ae284586a2392,
                    limb2: 0x437e48d6ffedc2a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9bf96cfb49ce1b15df239d16,
                    limb1: 0x1a954a8dfad41e0a38389378,
                    limb2: 0x3716210369e2acac,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xb77c534b75a49c242dc49948,
                    limb1: 0xc0d355eb111d72a1272920c0,
                    limb2: 0x118dff525eb67461,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc78d8e15e337baa4d83376e,
                    limb1: 0x69e7e12,
                    limb2: 0x4000000000000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xc06a1df03d6749cef9b137ae,
                    limb1: 0x9f158297ac05c84286600dab,
                    limb2: 0x71e62e8c3942d74e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa21e136342c8702c2467d773,
                    limb1: 0x496e96d7d62026d92c5b988a,
                    limb2: 0x1cb3b977136a007f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x5577b56e92ed14474a20043d,
                    limb1: 0x73c98edb2bc5787e0bd0d01f,
                    limb2: 0x2234af92c4fa444f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc6f473a34ff0a7d415a13ab1,
                    limb1: 0x3d8452820d0338d04e54214f,
                    limb2: 0x31cf6218ce5f85e3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6c72f2b1542d359d956380b0,
                    limb1: 0x39a0be67576f8a42a6803739,
                    limb2: 0x15813050ed830823,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x3bfdfaf7de208d1622390f94,
                    limb1: 0xaace779b9c2dbc54eb76d432,
                    limb2: 0x142d9f43b2666930,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x36f9fadfe855650d41b6c90,
                    limb1: 0xd98392ed40ec0cf2b98cbf87,
                    limb2: 0xae73e518eb320d4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf9972cf3f5b71cd95267264d,
                    limb1: 0xf6093275f04c06fbb4c474c6,
                    limb2: 0x3531d1688af2f350,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6b14c89ae811f46742c5d905,
                    limb1: 0x49c02d4256b072ed310ab856,
                    limb2: 0x1c90d936e3ed81f9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa21e136342c8702c2467d773,
                    limb1: 0x496e96d7d62026d92c5b988a,
                    limb2: 0x1cb3b977136a007f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xc03db8be92d18c034b02289c,
                    limb1: 0x135d09ee8cc97d00b3018551,
                    limb2: 0x59107aeb5c703876,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24e7c4a265c,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x7d85f3742277f6a9403e907,
                    limb1: 0x8bc6832d2b31e6febd53a9a7,
                    limb2: 0x72c9c6c7028758f0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcec0dd3c2a494d2b18ae13d1,
                    limb1: 0x76d99231b2e76cabd43508c8,
                    limb2: 0x3e71f81cf94902f2,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x8057e1ac94cdb8c29d5d573e,
                    limb1: 0x190bf491e8a08dee5dd71bdd,
                    limb2: 0x56f24fd4559d091b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x501d67c49df9ed4d129b8f55,
                    limb1: 0x7ec13495ec8bff35ec54f6c2,
                    limb2: 0x2a08fa10f81c139f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1621205978a9a9af613830fd,
                    limb1: 0xd3ef839574037346de08923,
                    limb2: 0x16feec96272dcc77,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x7a0dc455b30be93fc24c85f5,
                    limb1: 0x8dd32f82141809a1c3e6e6de,
                    limb2: 0x5aa8d79ef691648e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7d6f86bb5346c4f8f3f9e209,
                    limb1: 0x4c844a64cc149fe18b839a7a,
                    limb2: 0x70840f7b7573401b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x635d95060b92555335adaf6a,
                    limb1: 0x429f57daa789622c1a35ac07,
                    limb2: 0x421561de990f2878,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb28309e1ecd22a02dd188a5e,
                    limb1: 0x36712dd7d5dc91a967fe5451,
                    limb2: 0x1d747171ad32039b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcec0dd3c2a494d2b18ae13d1,
                    limb1: 0x76d99231b2e76cabd43508c8,
                    limb2: 0x3e71f81cf94902f2,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x71d718abd1dc1185383ba9ec,
            limb1: 0x399989a341646feaf596021e,
            limb2: 0x30f52ad5e562077a,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x6ecf12ac79db5686e6a61077,
                    limb1: 0x1cd6154ce2817b7e1d20a8d5,
                    limb2: 0x5702ffcde24a374f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xafd5ba0b8d607f1b47ad45f6,
                    limb1: 0x224ddba7382c606390f28e66,
                    limb2: 0x61aa682b7d9e0d14,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_X25519_2_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xd81e8da19aef1f9cff8dd083,
                    limb1: 0x5af275335d12fde7dd3dd075,
                    limb2: 0x6f72853e8993b324,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb16be908249e202a451674ce,
                    limb1: 0xf00c23de276a0a5e13a7f496,
                    limb2: 0x308368240c901981,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd81e8da19aef1f9cff8dd083,
                    limb1: 0x5af275335d12fde7dd3dd075,
                    limb2: 0x6f72853e8993b324,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb16be908249e202a451674ce,
                    limb1: 0xf00c23de276a0a5e13a7f496,
                    limb2: 0x308368240c901981,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xd2928f4be1514a0db27516ea63a6aae9, high: 0xb58be9e771ec087952b1ee109d5b64f
            },
            u256 {
                low: 0xebc16f697946097865e9675306389bd3, high: 0x29b80370aa5658322a5a421858da7da
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x80aad6fa5eff2e82ed8854f6,
                limb1: 0x15fb7daff9323085ac87a189,
                limb2: 0x1c096a09cb81973b,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x6b5bb8ec014790992556967c,
                limb1: 0xe31339cfb31aae7252a51806,
                limb2: 0x730a1713ec86e49,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x25b41a2fce597aae973790da,
                limb1: 0x39d7ca81b4b85547e5c81a99,
                limb2: 0x17d393a81c4757c1,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x830546648f6d5e9694a63ffb,
                limb1: 0xde47026999873efcc614e54d,
                limb2: 0x2a99241b4ae67da4,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xf688179d4fc1cf449ac23475,
                limb1: 0x11619aff8869ffb3c63c87c6,
                limb2: 0x51df2b47742693ed,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xa4237b3fba80ec0efbc4a082,
                limb1: 0xe179165fb92b3b80dab0c1c9,
                limb2: 0x6e4b175e616f357b,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x8b11cae632bd0ee43b36c99b,
                    limb1: 0x101bc563cb854abf2725d45d,
                    limb2: 0x27ccc55cf1c40d6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x21683c75c3ecff25fff16d09,
                    limb1: 0xffffffffffffffff2e3a3da9,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x4e13bc40a5163aaf2769f15f,
                    limb1: 0x676ca7e6033be5f2b1c5382a,
                    limb2: 0x7c3316414f49e0af,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa7369b640611b1e012e9da61,
                    limb1: 0x8f120d1ca9bad192763a8e00,
                    limb2: 0x748410b7aaeab5a0,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xc0538ee695fffcd5a739ddf,
                    limb1: 0x218fbbfe1faa131f937f12a,
                    limb2: 0x4853321395e9e631,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9610b7e35697fd22dd4a82c3,
                    limb1: 0xb12373b3dd2550e71b68fbb5,
                    limb2: 0x5ae6efc1e2f9454e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe9729bcb4796640babcc7dbe,
                    limb1: 0x794426061bfb164eafb8ed98,
                    limb2: 0x3107a09b06411249,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xd515b8ef958206f8a3996d32,
                    limb1: 0x447cf753d52e534c38aad561,
                    limb2: 0x450fefca7a504cb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x13fc920fe842335e2533439,
                    limb1: 0x282329d5076c0e8c820b3ace,
                    limb2: 0x2cd43d16a36d6aa3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd1a6d5a9c93ad7212c931028,
                    limb1: 0xc0fc581d1b313f0cd5c36de4,
                    limb2: 0x166d1b0eb4c5e5ea,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf8be66eb4fc0e547707e92b6,
                    limb1: 0x12175290ade6909d5c6fe2d4,
                    limb2: 0x26ddc0ebf9f48b5a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa7369b640611b1e012e9da61,
                    limb1: 0x8f120d1ca9bad192763a8e00,
                    limb2: 0x748410b7aaeab5a0,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xc6d6f901786d2fa0bd609e39,
                    limb1: 0x1981d3368fdcc8a8cfaf3c7,
                    limb2: 0x9dcd362f58a10ea,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xce5ed4bebd864a85c0e1dcef, limb1: 0x5658505, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x2071c044d052f31be24eb681,
                    limb1: 0x1e094de39664310e184d9c9d,
                    limb2: 0x15a637b1e891a712,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x22d582e96b765b4693a9e7d,
                    limb1: 0x6b35c04aee34acd03cfa14f1,
                    limb2: 0x78b9e7195a24f51a,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x66b905bdacbcdd54f38690af,
                    limb1: 0x73dcd88b7d31c721489b23db,
                    limb2: 0x3b029efecb657efa,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfd231daf0008e0ccc3ab4a8f,
                    limb1: 0x7ad3e473b4ec5c3d93d8acdd,
                    limb2: 0x284fb0aa44c10857,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe7ae2fbc266a88debdaedf0f,
                    limb1: 0xab8489787a1c67a0edc05359,
                    limb2: 0x48a93b5b27adb6b8,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x6d9eb93b1036a7708ce52080,
                    limb1: 0x80d06be0a7d8180440d4c521,
                    limb2: 0x77799cae2520997b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb1458cf63a627fae95b6cc35,
                    limb1: 0x66eec2b9d5b020eaa8f27fe3,
                    limb2: 0x20e1e518a3d9a4fa,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5f047c86a2c0bce1840bdf37,
                    limb1: 0xfdf63f7ae0a8ba3b1ca1cde6,
                    limb2: 0x7ee720638aa19d41,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcb1c6aef7afd9db42b6357c5,
                    limb1: 0xc8b3f88e410edbb8c2f84747,
                    limb2: 0x4050e25c933c51bc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x22d582e96b765b4693a9e7d,
                    limb1: 0x6b35c04aee34acd03cfa14f1,
                    limb2: 0x78b9e7195a24f51a,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x9462294f022544ec5323c04c,
                    limb1: 0xf859e99836cbad744d9be798,
                    limb2: 0x31d5fd623c590dbb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24e7c4a265c,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xd43c5707662b594a83e330c6,
                    limb1: 0xbd88948c07c0e657f77e1c63,
                    limb2: 0x16e3e4950dfe8cda,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe3c3ce32e1e4b60cce063a9e,
                    limb1: 0xb4c69a7ec2ddab0453fb5d9f,
                    limb2: 0x164d41106f921451,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xceac96581c55ec364ea48b43,
                    limb1: 0x944e81e7633e369a1cb3f27e,
                    limb2: 0x72243665e47c3f93,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x68316bdace18ccb707dd3253,
                    limb1: 0x2646ddb7ec028b37dd760ab8,
                    limb2: 0x406d901ad25c5afc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x772b6d240a6ebdc8caa6c28d,
                    limb1: 0xddcc0908c3e6ac7f75c958ac,
                    limb2: 0x403307bc5d519750,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x5974ed36cc20ffdca8f2be7f,
                    limb1: 0x1a76a46eaf4c6c04bde7b97c,
                    limb2: 0x19849ca02f4f619b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5da6753e8d83f67ba3d5ddc4,
                    limb1: 0xd9991b1596a180def1534dd4,
                    limb2: 0x7f807a605409b0bf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x21100eb96de88c02529e4dc2,
                    limb1: 0x7049232a46cd2990b266d0fb,
                    limb2: 0x2d642800e5aeecab,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7ee701b210d603e2ccf7d20a,
                    limb1: 0x68333f36b26b9102a228c70e,
                    limb2: 0x418e8f3fb8a93785,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe3c3ce32e1e4b60cce063a9e,
                    limb1: 0xb4c69a7ec2ddab0453fb5d9f,
                    limb2: 0x164d41106f921451,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x670e271603cdc3b099361cc9,
            limb1: 0x564cdac8e1c8c1cf5a821858,
            limb2: 0x3148d21f5ca267f2,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x1f73ba0b48ff37c51afbf65e,
                limb1: 0x76ef00ac26cc366c1142afad,
                limb2: 0x2167c41e70b82ee0,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xc0ea1af2382dee68e5bc0b78,
                    limb1: 0x705c6c18bd4e5e2dd8a56343,
                    limb2: 0x41a36963830172,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x86dbe6f9b364248f2269f10e,
                    limb1: 0xa5971431297b1ecbcc6953f3,
                    limb2: 0x66868c4e4c22fb21,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_X25519_3_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xe41e67d9701ac4a3691a6868,
                    limb1: 0xf0ab898c0b6f23df87c42e84,
                    limb2: 0x303dcb115e1e7d5c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xadbe390d2f63ad2546553e07,
                    limb1: 0x25feaf2d3097539f3d02f21b,
                    limb2: 0x5e89e7541289a728,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xe41e67d9701ac4a3691a6868,
                    limb1: 0xf0ab898c0b6f23df87c42e84,
                    limb2: 0x303dcb115e1e7d5c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xadbe390d2f63ad2546553e07,
                    limb1: 0x25feaf2d3097539f3d02f21b,
                    limb2: 0x5e89e7541289a728,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xe41e67d9701ac4a3691a6868,
                    limb1: 0xf0ab898c0b6f23df87c42e84,
                    limb2: 0x303dcb115e1e7d5c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xadbe390d2f63ad2546553e07,
                    limb1: 0x25feaf2d3097539f3d02f21b,
                    limb2: 0x5e89e7541289a728,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xa2b4d215c3c5707dfe292238fbfbe602, high: 0x48c584eabbf66c7680aee2a466bd06f
            },
            u256 {
                low: 0xddda17a36779de0d25c1df67987d616d, high: 0x53692cc0f52361d82f1240d4e5c6dd2
            },
            u256 {
                low: 0xb2835498be80793eb0f1bb1d8e10fed6, high: 0x5c45fa7f31e24486323c57fa197b954
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x2cedeca9ee9965eed1c77a4c,
                limb1: 0x76c82b9cad9812334e4bbe04,
                limb2: 0x1eba29ff96f1d6c6,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xcc33d849b3cd57072db71408,
                limb1: 0x1488a463360b6d156baca4e8,
                limb2: 0x2db05d063ed3351,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x4fae63b10fa72d05cf282033,
                limb1: 0x90993b536a1a981c8581b205,
                limb2: 0x41c2ff92098111b,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x403721233742b9105ea74b1d,
                limb1: 0x4add7a2b3010b0f529dd4343,
                limb2: 0x22cfbc2b6711c506,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x5555a8e12d2f072f96ecde11,
                limb1: 0x61950be7785ff78d1b3221a8,
                limb2: 0x40d054f3b8b70494,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x3bc96d0de5b98ff274ff5831,
                limb1: 0x762cb7b4eccdeb66b0a997b4,
                limb2: 0x72deb342f75fdd5c,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x590a4b64be09bb59e165628b,
                    limb1: 0x1f77a1ca8abe6613b3a6a784,
                    limb2: 0x6b5b7ba68bd41f7a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1eef5a0fff6f7eaca0365e3c,
                    limb1: 0xffffffffffffffff3d5e0247,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xc4b018359ad55d37708114f3,
                    limb1: 0x2719e78cc7860ea8244c712a,
                    limb2: 0x627d1b5fdbf9854c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xeef3ab7ca14bd56dc51e1d39,
                    limb1: 0x988c4ad746f8c9ed29f01376,
                    limb2: 0x31080aef0aefabdc,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x9710e5e6cafd49f95081549f,
                    limb1: 0xa0ae3da3c96b90e2a8862366,
                    limb2: 0x74b84b9b13f25a9a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf5c86cd06b214d4bba7631e4,
                    limb1: 0x7ec1e60ce0ebe40700be59a,
                    limb2: 0x7899a6ead71ce6fd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7ccbc7b6b85743be4781091e,
                    limb1: 0xdcb407a9b5bc578a429d5436,
                    limb2: 0x2b9321c15671b0ae,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x4715fe31e0c7ee93fc5503e1,
                    limb1: 0x8ecc0ec924d8cea0e887dbbb,
                    limb2: 0x5d6d3a777f9fd536,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1ccb72468464592a9c332557,
                    limb1: 0x84e2edecc6ca23c533a65893,
                    limb2: 0x7f0b1ca3a13ae14d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2c9e6e1cf1e13b206593c8e2,
                    limb1: 0x9f337a3ce67923b019a69441,
                    limb2: 0x2a1f36bfb4e29585,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6f5ac2e0458007cfb995b64a,
                    limb1: 0xd1c492377230b952cef71bd5,
                    limb2: 0xd27c60a86a42ff6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xeef3ab7ca14bd56dc51e1d39,
                    limb1: 0x988c4ad746f8c9ed29f01376,
                    limb2: 0x31080aef0aefabdc,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x7c85372df5695a00ff648ab9,
                    limb1: 0x6222ea2f04223cd9bb1c4165,
                    limb2: 0x6f165398103975c2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x665cfabde37d7a549ab6698f,
                    limb1: 0xfffffffffffffffffa9a5e97,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x67ad2a33ea1d0246ba3af0a2,
                    limb1: 0xaf736b5040b0abff2b804142,
                    limb2: 0x2035ad209f7bb45e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcc333475803e0e56c7bd7752,
                    limb1: 0x7ebb3b208a764403f2ba1f75,
                    limb2: 0x4ba604f581497187,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x57ff83ac58a7f9e4ccbe71a,
                    limb1: 0x9d92740473590b8df013652d,
                    limb2: 0x20d0fcf78d541362,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb20672d553aace53da95028c,
                    limb1: 0xc8be87a02fa8541c635b871d,
                    limb2: 0x54a5a8847b753fe2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6e9894ef3b8e78f5746ce16,
                    limb1: 0x56e7a0d9e846ffdc0f9681bf,
                    limb2: 0x1e778fa8a2391edc,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x9e424b3715745724d14a4dbf,
                    limb1: 0x4fa4d4515fb3577564a6beee,
                    limb2: 0x778519b14c6c7baa,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6e5c70922f922bc9e9354bd1,
                    limb1: 0x5b01b8b09e567e4c24162e78,
                    limb2: 0x7540142afb9f227a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1e90b96ab700b477eb79e40d,
                    limb1: 0x636f243ecdfe588948e5c347,
                    limb2: 0x5346a44eebd54e6b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1257d4de94c7acdf034f91e6,
                    limb1: 0x5a1e15faeb5b56a9d62aebed,
                    limb2: 0x4ae057cb4a265f09,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcc333475803e0e56c7bd7752,
                    limb1: 0x7ebb3b208a764403f2ba1f75,
                    limb2: 0x4ba604f581497187,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x8b2ec42930e489cb8948a7c6,
                    limb1: 0xef515e958f949c3040ddbf2f,
                    limb2: 0x3d8b23b6ceea79b3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24e7c4a265c,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xdc45e539d78792855b90267b,
                    limb1: 0x7018d80aaf50db6ef4f81fa,
                    limb2: 0x7a86aea78b6bea0e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5afbf36dc329cbca99eb01a9,
                    limb1: 0xdd1b8c51d8570565f4c2c52,
                    limb2: 0x3b137b1326b0ea50,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x86a1ddf96484e3c409e36639,
                    limb1: 0x34951147071f4f35cdcb2d8e,
                    limb2: 0x50acfcced9fbb7a9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3352b7ccfd29275e279232bb,
                    limb1: 0xf6d01d51f81335b9253c8183,
                    limb2: 0x5bb3d87e93bd5449,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8b12954c61b3a8eaea90c9b5,
                    limb1: 0x5441b14b0bd92fe3c97297a1,
                    limb2: 0x486a16970d6d17de,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xb093e8440bc23da69ea38bbe,
                    limb1: 0x6c5e3136a6b8d3bd9084efb4,
                    limb2: 0x48752fee5bbec1ba,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x96863557f00390a839db34da,
                    limb1: 0xa5a668e134146331762cdc33,
                    limb2: 0x4237991647806285,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfee99c95e843357416c1dce7,
                    limb1: 0x1a55b5aa6e5b3e697b5eae7c,
                    limb2: 0x799d342ce200f0e5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x86f08fe482323d1da4a4c7d2,
                    limb1: 0xb1ac382b559fb86199fa2ca5,
                    limb2: 0x25315952361694b8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5afbf36dc329cbca99eb01a9,
                    limb1: 0xdd1b8c51d8570565f4c2c52,
                    limb2: 0x3b137b1326b0ea50,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xa5c3d5e59b7bea27ecce9c0e,
            limb1: 0x5d643e97737f5766a5c5ff64,
            limb2: 0x1f283075f9652822,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0xc717bf08351daaa6663ff4be,
                limb1: 0xb1926b0d4bc02da3f1611b9b,
                limb2: 0x266962f77c901493,
                limb3: 0x0
            },
            u384 {
                limb0: 0x65962559a03079e59eedcc3e,
                limb1: 0x7deb1b2925d18bfb4b34eca3,
                limb2: 0x2a672843fb00f093,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x7dfafd3464e95d9833571b9c,
                    limb1: 0xfeca6e22c774a24d34227d39,
                    limb2: 0x3ff0fd65c09d8bc0,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xab67a376582011a402a90077,
                    limb1: 0x4e0e0e698ac5124e0876a2ed,
                    limb2: 0x1247192273f80e7b,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_X25519_4_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xdc9f168cc42c92e6826463fa,
                    limb1: 0x25fa43f6a93458bc76f0a395,
                    limb2: 0x4d1f8e67532958c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd685292aed56b7fd3c5c9dc0,
                    limb1: 0x98b87bef3d8f5d2ca288d81e,
                    limb2: 0x772ebfedf5d17401,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xdc9f168cc42c92e6826463fa,
                    limb1: 0x25fa43f6a93458bc76f0a395,
                    limb2: 0x4d1f8e67532958c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd685292aed56b7fd3c5c9dc0,
                    limb1: 0x98b87bef3d8f5d2ca288d81e,
                    limb2: 0x772ebfedf5d17401,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xdc9f168cc42c92e6826463fa,
                    limb1: 0x25fa43f6a93458bc76f0a395,
                    limb2: 0x4d1f8e67532958c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd685292aed56b7fd3c5c9dc0,
                    limb1: 0x98b87bef3d8f5d2ca288d81e,
                    limb2: 0x772ebfedf5d17401,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xdc9f168cc42c92e6826463fa,
                    limb1: 0x25fa43f6a93458bc76f0a395,
                    limb2: 0x4d1f8e67532958c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd685292aed56b7fd3c5c9dc0,
                    limb1: 0x98b87bef3d8f5d2ca288d81e,
                    limb2: 0x772ebfedf5d17401,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x83210210a43c991d2d4da4ef95e38180, high: 0xa1d543ac1f8190be55e44b808a6d5b4
            },
            u256 {
                low: 0xc582644479faf5012287401ba7bbaa76, high: 0x2a328038b1f11370ea255e08e50c79a
            },
            u256 { low: 0xa1402e57e7ef7b848610cfd21276c2, high: 0x353d0a8147a08acc65d8e4ed01e488b },
            u256 {
                low: 0x91fd7d4a5a31a6a69b87cc5e6d7fe9b2, high: 0xc191cb4d560e64c55f7792a739ac9e2
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x32bfdbd76f72ecaa252c60eb,
                limb1: 0x34acc2f13c5e60084a0077,
                limb2: 0x2bb65a382faeb528,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x931c3fd9b56337b02f4b0b61,
                limb1: 0x5f894f6a31a4126767f005f7,
                limb2: 0x1fc6b9f4c56965cf,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x84b556e385bb09d768619cd7,
                limb1: 0x5759c7577fb2655d6f422890,
                limb2: 0x81d42abf903a74b,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x6243ad19e3b8210a1bf96dab,
                limb1: 0x691249ffa4a7d284a5b619a8,
                limb2: 0x3ff9a789400f297e,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x6acacb2cb34a913495b5219f,
                limb1: 0xd1a2504f597dd7510b5c00fe,
                limb2: 0x5fba8a2da863296b,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xe9e47aab66229ed07d930306,
                limb1: 0xc226050f3ca9e5e73e418834,
                limb2: 0x62047ecd81cfb741,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x3f9722942827129d74379074,
                    limb1: 0xaecc0878a44266cdd0aedc0f,
                    limb2: 0x56bbb7a0a90267a4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x35e9759afb4c2043c6e76cbd,
                    limb1: 0xffffffffffffffffd0dd1f6e,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x419dec021ee317c739d0a755,
                    limb1: 0x6c49dc1979398acf2d9d291a,
                    limb2: 0x5e2cae1e3d03437,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf0a10d9bcc60806f586f3b08,
                    limb1: 0xd9d10f46658f48e380c55bf2,
                    limb2: 0x4f77ace15b1eb54b,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x5ae5fe2e014afaa768f02e21,
                    limb1: 0xf54116fc84f67e59ebccb2a4,
                    limb2: 0x392082c59071f6ea,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9e33947c40a64d2f4fe03d6b,
                    limb1: 0x1436f8282a53d39c7cfa5d89,
                    limb2: 0x4a0c7ecee8352a0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfaba7b7a6ca904ba9d970c6f,
                    limb1: 0x4fe788aa753bc52626f7982b,
                    limb2: 0x15861ca52391df3f,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x3d47c426bbedce886e25c915,
                    limb1: 0x79c0ac23c93229ea3a9c6026,
                    limb2: 0x78683d9ae6afdc80,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfa4423d948e441aa9e9cd2d1,
                    limb1: 0x89616c850cbb2ecc4882a338,
                    limb2: 0x5919977fa3f56fbc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x72e2a5852fa501fc2a916931,
                    limb1: 0x4a78721298793f1daf06083c,
                    limb2: 0x1c6af3c9f0c402d3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xec4896acc98dc25f82e54899,
                    limb1: 0x16f486c423e43579d847d3c4,
                    limb2: 0x308d758c8e7adee2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf0a10d9bcc60806f586f3b08,
                    limb1: 0xd9d10f46658f48e380c55bf2,
                    limb2: 0x4f77ace15b1eb54b,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x83ac314f7bdd9887ce4dc1eb,
                    limb1: 0x6a44d948d1e069785e923e2d,
                    limb2: 0x291e317cecc8b129,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2ba3617d1fcf4afeb4526523, limb1: 0x7ad59ba, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x440de21361c8b8eb6f1b0e3a,
                    limb1: 0xbf83fa2b0871d095e92aefb1,
                    limb2: 0x4dd73d1def95c007,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9eab928fb61863421539ff1c,
                    limb1: 0x82abf4b1d71941e619cd33d9,
                    limb2: 0x7310c46d91c9c328,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x81cf99f5f93eac9e261b2d0a,
                    limb1: 0x95d99c9454d0a02eed107797,
                    limb2: 0x417047b8e99fafe9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x31140bd955ddf3651ef87a0f,
                    limb1: 0x3e5c2cdc1f902b5cb785dfc7,
                    limb2: 0xf1511b377177c36,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x23fb4d8de3708a61ea0eb975,
                    limb1: 0x471c1aa07e9214d12c9a5b7c,
                    limb2: 0x5d76e29d86c035c8,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x87950100c4d88488a6dcd04,
                    limb1: 0x8ef1b0b28f31990fec1c3efd,
                    limb2: 0x226ac9f99132d33c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc863eb555d1b4e76c1601054,
                    limb1: 0x2685e0b99af06118175e2bd0,
                    limb2: 0x50672b18cb57ccd0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7f83ce5813deac7dbba03fbb,
                    limb1: 0xef5b5b45b468a22301f75df4,
                    limb2: 0x3b1557716ae9b171,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xeeb88cbe0c736383b82faf7e,
                    limb1: 0x6a2ea4d5b31c7b4093d59a5b,
                    limb2: 0x7881e7c89a406ab2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9eab928fb61863421539ff1c,
                    limb1: 0x82abf4b1d71941e619cd33d9,
                    limb2: 0x7310c46d91c9c328,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xed53019d1c8a125480c9eda0,
                    limb1: 0x7e3bf3c2730f494b4f6127a5,
                    limb2: 0x1fe39c754449b324,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24e7c4a265c,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x64cff6d6d899490a0ae72524,
                    limb1: 0xc45e19de85433832864b25f1,
                    limb2: 0x732c3641c5a79c9c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x107fddefc6fa64f401e94177,
                    limb1: 0xd703e85926cfc3518561d671,
                    limb2: 0x182833265e992f48,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xecabe47515acff7bc9859f25,
                    limb1: 0xec39667abcffeaf6edbea18,
                    limb2: 0x12f35fd0adddb8f9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd514bc37845087aa9e85c6c3,
                    limb1: 0x342d8cd0d3c9a999b06210d1,
                    limb2: 0x176644754af3676c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe4b8e6f602909817fbdfef3b,
                    limb1: 0x85e0e443a40eef1a8948b57e,
                    limb2: 0x2538fdd179c5f9d4,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xbb9b1047c38b073f2cc27433,
                    limb1: 0xbd93a13aed1578dec60cefcf,
                    limb2: 0x75b2fbbf65368b6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe66c1c7e8d780dc397279145,
                    limb1: 0x92cf1deed0a73d71328fa092,
                    limb2: 0x3f4ef314e9590bbf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x72bc15b064d7079eda4325eb,
                    limb1: 0x14a7ea631b15e95fa30c197,
                    limb2: 0x7be74f96da4e5307,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf7aa1818343f3a253fbc67b,
                    limb1: 0x6f08c4892fede2dd30f5d09c,
                    limb2: 0x1dd6e0ec70524747,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x107fddefc6fa64f401e94177,
                    limb1: 0xd703e85926cfc3518561d671,
                    limb2: 0x182833265e992f48,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x174e0cf66ff30bc6d10de89f,
            limb1: 0x40776b4d41773dac29719668,
            limb2: 0xd2cb6c9adc84109,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xd59c8cc7ceebeac895ff5dc9,
                    limb1: 0xed894f89c1477e4ca5b1f14c,
                    limb2: 0x6a7df86e41fb2b3e,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1290c3525018c8ea10caa1f2,
                    limb1: 0x382cdec5c4c0d7e6266fbe28,
                    limb2: 0x7672948036c625e2,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_X25519_5_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x5497caaa31f0fdb6c6be0657,
                    limb1: 0x117f8b905f5008de9e7769cf,
                    limb2: 0x4d0e44e3c6a75188,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x794ea1e5a7c45b3357a2678e,
                    limb1: 0xa9bd52340cc65a627cbe9c8b,
                    limb2: 0x55b71987c2ef403b,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5497caaa31f0fdb6c6be0657,
                    limb1: 0x117f8b905f5008de9e7769cf,
                    limb2: 0x4d0e44e3c6a75188,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x794ea1e5a7c45b3357a2678e,
                    limb1: 0xa9bd52340cc65a627cbe9c8b,
                    limb2: 0x55b71987c2ef403b,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5497caaa31f0fdb6c6be0657,
                    limb1: 0x117f8b905f5008de9e7769cf,
                    limb2: 0x4d0e44e3c6a75188,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x794ea1e5a7c45b3357a2678e,
                    limb1: 0xa9bd52340cc65a627cbe9c8b,
                    limb2: 0x55b71987c2ef403b,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5497caaa31f0fdb6c6be0657,
                    limb1: 0x117f8b905f5008de9e7769cf,
                    limb2: 0x4d0e44e3c6a75188,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x794ea1e5a7c45b3357a2678e,
                    limb1: 0xa9bd52340cc65a627cbe9c8b,
                    limb2: 0x55b71987c2ef403b,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5497caaa31f0fdb6c6be0657,
                    limb1: 0x117f8b905f5008de9e7769cf,
                    limb2: 0x4d0e44e3c6a75188,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x794ea1e5a7c45b3357a2678e,
                    limb1: 0xa9bd52340cc65a627cbe9c8b,
                    limb2: 0x55b71987c2ef403b,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x2ebed37d05d156b6eceec38d511fcda9, high: 0xacffd8b04ea581d20068c1cbbd743b3
            },
            u256 {
                low: 0xeb1c3ba45b9e42d02b0c9fddb61b03e9, high: 0xd10303513d1ea49ed469bf4d5cf2dc4
            },
            u256 {
                low: 0x9aa909f15adffd0470d227180dd35d11, high: 0x82fbe9fc1a7de009ec12fa2e6df12ce
            },
            u256 {
                low: 0xd95e17e1900f72f74f4b4ed5ac1d02e8, high: 0x5c804a66987b05274219d3ecdc39412
            },
            u256 {
                low: 0x439f4b86cd6a5e0c7427965607db34e0, high: 0x20d0c3a633d9c54f30459cc30c42d61
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x442f060d34160d112302e892,
                limb1: 0x69f318b0ddc7841688bc6bcc,
                limb2: 0x314276c425d26319,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xda0db7e3e40247e562612f42,
                limb1: 0x3938a7fc22c22a80604eef2,
                limb2: 0x28877f411023252f,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xff46f46f813bf7ef53619943,
                limb1: 0x644d5118b2dc336bf973f332,
                limb2: 0x329152cf2f71b5a0,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xc3b0e0a9e16e884fc588cd36,
                limb1: 0xa1147a141ac7117daa4ad37d,
                limb2: 0x115338f0af2ab851,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x6d01d7bd5cb5894c6795179a,
                limb1: 0x96c8b652bb8ba5ac88595b6d,
                limb2: 0x15b39484698d1241,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xf4af1834d1c06083a49fb88d,
                limb1: 0x3b18e97d96212ff1f4606036,
                limb2: 0x64bf893855d6a6c1,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xf7423887e0d63c4f5d4142b3,
                    limb1: 0x95a95ff61d0e474b5e8400f,
                    limb2: 0x2f22dd2203d43aa7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x59ced3d795bf603d0f9a0680,
                    limb1: 0xffffffffffffffff6b986d0e,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x39b928a44a19b5e83b5ef68d,
                    limb1: 0x6b7210739627362a922df0b5,
                    limb2: 0x45b845151e7ff028,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x67392f4899f8f538163f1104,
                    limb1: 0x848d5bbec2e8730ad8cc2a64,
                    limb2: 0x1af445813864b5e,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xc42e6f82b81d57c21c36f802,
                    limb1: 0xa2d217f0fcbb840ed9ff03d1,
                    limb2: 0x5062188c513a6690,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5772c2e48e8e88561144fdc4,
                    limb1: 0xb292023cad141cc10466c54e,
                    limb2: 0x637acb409842f736,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfd99937c942beb44801449c0,
                    limb1: 0xf356e0abfa756e43c57c734f,
                    limb2: 0x7994c550864c3e7f,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xf0721e67ab7ed399a409b672,
                    limb1: 0x20de3a31cb74349ae7927069,
                    limb2: 0x34f060ba171b4ba1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4b17e5f63ed8470d8414326e,
                    limb1: 0x65ea12f97766f86203b5fd82,
                    limb2: 0x96579007a5b441b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcf3f74924a58a90620b28b15,
                    limb1: 0x7217a8d8dee2feb1b16c30fc,
                    limb2: 0x651f43c28ff91e07,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe463d34ef4c46080847397d1,
                    limb1: 0x161cbb1e40d1e0d53cd89b5f,
                    limb2: 0x7062efbfc92a9ad3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x67392f4899f8f538163f1104,
                    limb1: 0x848d5bbec2e8730ad8cc2a64,
                    limb2: 0x1af445813864b5e,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x4e2fc21676251cbf57aa4552,
                    limb1: 0x283a5a5d2d1d7d985d5bed98,
                    limb2: 0xc4ebfdf9759e273,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8d05f4debb66bb61ee6aa609,
                    limb1: 0x10ba122f,
                    limb2: 0x4000000000000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x43116ad68ec43bce3d72bd49,
                    limb1: 0x868cf7680d66566e14a8bcf5,
                    limb2: 0x3328f660664c072f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xac2140e64cd30a59e5e06053,
                    limb1: 0x8a332356edd3c3b56814a2fd,
                    limb2: 0x60684d09e6f8d7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x729a45bc3b8b548b295622c2,
                    limb1: 0x50df6933d9b276b03b635c68,
                    limb2: 0x6b56ef66aeb0e7a4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdd74ab244eb9a96718314517,
                    limb1: 0x4943bee7b6237789cbbd2674,
                    limb2: 0x3016b1704a3e3481,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd10acf18a46a9ea8b754cb02,
                    limb1: 0x634f534b4562f5bdec3e20a8,
                    limb2: 0x24d9c045bf4528ed,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xfdac0dc99ecbc4a892670567,
                    limb1: 0x1b1a75053b2c632d973e126e,
                    limb2: 0xa12ceae8c71f646,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6f66c849cb34e5094bddc203,
                    limb1: 0xcd86cd21ada8e461814e1695,
                    limb2: 0x17e93b1bf07cb90a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x12215e1b876129e47d91c4d1,
                    limb1: 0xde0e8da3d082bfdf4fade026,
                    limb2: 0x4883ee5d8dc96d28,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xedbc1581396ee66686875e8d,
                    limb1: 0x3137a212b8110118bf53679f,
                    limb2: 0x5dd3a10b10f6b1da,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xac2140e64cd30a59e5e06053,
                    limb1: 0x8a332356edd3c3b56814a2fd,
                    limb2: 0x60684d09e6f8d7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x3cd8b22338493719cbbf210f,
                    limb1: 0xa445881f24d486c838417a7d,
                    limb2: 0xc9e78e861a90361,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24e7c4a265c,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x702d051a49b6e21a35be97a4,
                    limb1: 0x5735877b5397f81019e09842,
                    limb2: 0x1ffbbf387ccedafc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x93b733d3220e7ec445094f10,
                    limb1: 0x4e9f894919826e77e32b15f,
                    limb2: 0x37bb18ac6701381e,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x8d5ca3ed352fb602d82e6187,
                    limb1: 0x5280862e91a680a11af40657,
                    limb2: 0x109205bff3e7141,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb884b35714fed4a588811686,
                    limb1: 0x72f142a3ed1f9480e3b82d7d,
                    limb2: 0x3bf72438d57f9d4f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbe15b8050435bcc9f5497f1e,
                    limb1: 0xca5761f65c78732fba7cc750,
                    limb2: 0x510ad8a84c4204cd,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xb90e9f312b93548d99a20be,
                    limb1: 0x4804e34c40a44fdc28b6d9b8,
                    limb2: 0x44e4faa5eb8567a8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb748dad028cb882c9236daa1,
                    limb1: 0x39139fc6e995511a3e79b632,
                    limb2: 0x726ae49632dcdb97,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x956b4ebafda6e4dd0b8ecc20,
                    limb1: 0xc772cc824b9d4d4d75346df0,
                    limb2: 0x3ddaede5855ea1ba,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1ad7afc4f4618cb27ed338e8,
                    limb1: 0x1e03225fe42a2bac48b42ed,
                    limb2: 0x4aa669e3277985a7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x93b733d3220e7ec445094f10,
                    limb1: 0x4e9f894919826e77e32b15f,
                    limb2: 0x37bb18ac6701381e,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xc09a2cbfdb31ade8a6cb3bbc,
            limb1: 0xda093dc612166483d91666f3,
            limb2: 0x297ad690792a6e98,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x6d7242917060cd5658614a74,
                limb1: 0x53d11f8a2ba70552eb9d8588,
                limb2: 0x741cd1332d1c0a1,
                limb3: 0x0
            },
            u384 {
                limb0: 0xef2cf18105e56bc6a1d71b6e,
                limb1: 0x19ba6c0ecb4abe8bb2aee997,
                limb2: 0x372f7de29f13ce34,
                limb3: 0x0
            },
            u384 {
                limb0: 0x5b10fdde5f820506690a51ab,
                limb1: 0x4c121b0b566ef9aef098fa2,
                limb2: 0x313f21601c0aa831,
                limb3: 0x0
            },
            u384 {
                limb0: 0x14e8b67e9726c57de2e14f41,
                limb1: 0xd998f385c228f98b800c38f6,
                limb2: 0x3d8be1db6c77f281,
                limb3: 0x0
            },
            u384 {
                limb0: 0xccbf5f85d12f21b51a5567c9,
                limb1: 0x82e77832bd95825132bd5081,
                limb2: 0x3423d903b725676e,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xb53cab7a6ed893335138aa29,
                    limb1: 0x7389d79ed5fe9ec261d623f6,
                    limb2: 0x1c3d90784b9ced30,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xeae0d0c3325dd5221b223f32,
                    limb1: 0x87786470264a2f2f9c26fe5c,
                    limb2: 0x488aeab8446c61a0,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_X25519_6_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x64169fe395c785dd39e951c0,
                    limb1: 0x9603c27ae769d8843a622911,
                    limb2: 0x2678c325c2c2278f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x80bb6079aac1b26c6286c4b5,
                    limb1: 0x4368077100cbf006ce5bf04f,
                    limb2: 0x65752ed9516d3a23,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x64169fe395c785dd39e951c0,
                    limb1: 0x9603c27ae769d8843a622911,
                    limb2: 0x2678c325c2c2278f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x80bb6079aac1b26c6286c4b5,
                    limb1: 0x4368077100cbf006ce5bf04f,
                    limb2: 0x65752ed9516d3a23,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x64169fe395c785dd39e951c0,
                    limb1: 0x9603c27ae769d8843a622911,
                    limb2: 0x2678c325c2c2278f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x80bb6079aac1b26c6286c4b5,
                    limb1: 0x4368077100cbf006ce5bf04f,
                    limb2: 0x65752ed9516d3a23,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x64169fe395c785dd39e951c0,
                    limb1: 0x9603c27ae769d8843a622911,
                    limb2: 0x2678c325c2c2278f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x80bb6079aac1b26c6286c4b5,
                    limb1: 0x4368077100cbf006ce5bf04f,
                    limb2: 0x65752ed9516d3a23,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x64169fe395c785dd39e951c0,
                    limb1: 0x9603c27ae769d8843a622911,
                    limb2: 0x2678c325c2c2278f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x80bb6079aac1b26c6286c4b5,
                    limb1: 0x4368077100cbf006ce5bf04f,
                    limb2: 0x65752ed9516d3a23,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x64169fe395c785dd39e951c0,
                    limb1: 0x9603c27ae769d8843a622911,
                    limb2: 0x2678c325c2c2278f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x80bb6079aac1b26c6286c4b5,
                    limb1: 0x4368077100cbf006ce5bf04f,
                    limb2: 0x65752ed9516d3a23,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x840fbb0ba5e327af071dade6432255ee, high: 0x2901e06d39a4bb0d62b68d41880fa4b
            },
            u256 {
                low: 0x19365f61f484878d5bc9e8895567a84c, high: 0x4efcb8308771fe6f7d870b678ac8704
            },
            u256 { low: 0xce03a34da022dfee843fb606e8b7e2da, high: 0x5f398096bfafff5b7751f497e28aa },
            u256 {
                low: 0xf1c51dda282803705672ebc7606e8502, high: 0x5234b15259a2b28b22b89748c5c192f
            },
            u256 {
                low: 0xf75a7e6f2b863694541d1a814815642c, high: 0x53c62d539ddc4775a220eb23cf9d1fe
            },
            u256 {
                low: 0x5d0057167680891b6bb6204ee0db22d3, high: 0xc5e4a522353d45590bccb66e0631450
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x52db61ef5ebf80a7dec632dd,
                limb1: 0x68bde24e1486f45f1acded66,
                limb2: 0x6435c4bca01cb392,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xf1093e22b345fc7c735ce6c7,
                limb1: 0x4b4dce7ef3aae93b3cbd50fe,
                limb2: 0x652b6c4dd15fc50e,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x5e0a3499c243fc2c946d136b,
                limb1: 0x97a89ac151520c02468abcf4,
                limb2: 0x7406f98836e4a0aa,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xf27dd09ec58c39018fa0df5,
                limb1: 0x59ef27d0949021338043fdeb,
                limb2: 0x2d291c29e46943eb,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x5655e8ebf5016728ac6dc710,
                limb1: 0x3f8cb37e5b87d38b05aeda91,
                limb2: 0x1553bb5a56472677,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x3562e095d379b0bf844eee47,
                limb1: 0x5c15cccf0908d881c0e35a68,
                limb2: 0x726965fee3889acd,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x494ae5f01c329fc748d1225f,
                    limb1: 0x7489faffcb6ac967c3c9b51,
                    limb2: 0x6447888e6397a80e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf7c73e200b8d4748adb7f175,
                    limb1: 0xfffffffffffffffef506dff2,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x4186144fe4fa7ee4c0fd6bc4,
                    limb1: 0x9b55c1d1382610a5d7e055cd,
                    limb2: 0x47263dd3cc5d3b41,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x490dfe2d0b78f97ae7507b3d,
                    limb1: 0x13e5b37040f331caacfe988,
                    limb2: 0x7551781d9d2124de,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x727b5744d1f3435c32464725,
                    limb1: 0x74708985efe5cb4b4537574f,
                    limb2: 0x6f6eef6701d49371,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6021dad52be46fec7bf6fab3,
                    limb1: 0x926121256809235d65415a43,
                    limb2: 0x3d93ee1ff1a690b2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbb4ccde9b7782f34e248ed4a,
                    limb1: 0x986fdfab9d5a66b2c483e89c,
                    limb2: 0x7a15ec1ec6f9a7fa,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xf2ca772faddd2096e659fd9b,
                    limb1: 0x2cd527a7b50647651217169b,
                    limb2: 0x464f74537d4cac9e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1c7812b05a4aa336a1a46bee,
                    limb1: 0xa4c1095504ab7884ae192342,
                    limb2: 0x5da09109a727b99f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xea5ded4b90c3cd2bd64a7fa3,
                    limb1: 0x21f79a3c994582cbba672a65,
                    limb2: 0x277e3e7b285508b5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xec30befa8fa5297d0a120d08,
                    limb1: 0x46006c7be2d0bb50828b0077,
                    limb2: 0x71d0e87e7707e5ec,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x490dfe2d0b78f97ae7507b3d,
                    limb1: 0x13e5b37040f331caacfe988,
                    limb2: 0x7551781d9d2124de,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x9932eb3a36362a445c4f1c8,
                    limb1: 0x45eda698eb0104e6d9c2b911,
                    limb2: 0x383d0f91c870fd09,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd06db38373a3aae072a39a49,
                    limb1: 0x38991c,
                    limb2: 0x4000000000000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xa88dc97a32b75f8586893a84,
                    limb1: 0x2a5cc0121cb7015316e9493b,
                    limb2: 0x3fb1ccc2ed7b5ed8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3ddf2b82a7f47df631a99aaf,
                    limb1: 0xd253a2c3c7441b797f1319fa,
                    limb2: 0x65804352065937c5,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x30d61de480e1de5b775bc9f9,
                    limb1: 0xb5dd9ab4f105f76a1fb35f00,
                    limb2: 0x3c1b984bd5b24f6e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc6f92c323d182b7c6d76656,
                    limb1: 0xbd4c921d749c51cc47a7860f,
                    limb2: 0x4fc046195d94fe32,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe23f1c28995f803c96fd3bfb,
                    limb1: 0x8e85c100249ba5c8a93b53a9,
                    limb2: 0x3ad85c6d47b3dd1a,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xfd94d072b338c03722f9521d,
                    limb1: 0x4f883f8a2d8ca8d4d72f49af,
                    limb2: 0x1158008af58c4382,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x985fadf6836c0f881b432334,
                    limb1: 0xff0f7aedd39bc8d4cf00ea12,
                    limb2: 0x5d97a5791140cb03,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1940b8011a486783989c3a9d,
                    limb1: 0x6347f72ab350e7aa0bd75e7b,
                    limb2: 0x78e30a684f59d550,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x53387424dd620a1dcf9ddbc8,
                    limb1: 0xd5076abcc761abfdc193f3e6,
                    limb2: 0x6a5c776d98260982,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3ddf2b82a7f47df631a99aaf,
                    limb1: 0xd253a2c3c7441b797f1319fa,
                    limb2: 0x65804352065937c5,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xb36f71348ae5bd9318187383,
                    limb1: 0xa989d7fcb34be6fd289926a7,
                    limb2: 0x31c97ddeb2af11f8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24e7c4a265c,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xab1e0ae1d3dd659b8ebceb02,
                    limb1: 0x8012afc730faf42a3d66e451,
                    limb2: 0x3b7770602ddecb87,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4b9fe27a48ba9caabf25255f,
                    limb1: 0x28cab1c053262072b3c6687a,
                    limb2: 0x76a54b1d72d438de,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x3a94c8c03f193177a4225b28,
                    limb1: 0x1ac772561a21f31da0cf72d4,
                    limb2: 0x3ef464a3601ad13b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x756ba6d48e927afb3157ed35,
                    limb1: 0xcc9f452ba90462c6d045ef3e,
                    limb2: 0x6fc0f21c0e913568,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe3a62e1d0a5ae2be316c47e4,
                    limb1: 0xaf570d2a06197b370c6aa3a4,
                    limb2: 0x62ecf36979184c91,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x904d0f1c2a615ab0c26e715e,
                    limb1: 0x7cd0444df38ceffb7f0ad629,
                    limb2: 0x4a0c5801840596a8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x98295d95ed80bef7e07a15f3,
                    limb1: 0x4e33fdc6fd894220046bc263,
                    limb2: 0x16869ad7d14238ed,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x79b1106b9e900a1a48d50451,
                    limb1: 0xb0bf7eb5677e998ec2d0b77c,
                    limb2: 0x1cbb602de34c6740,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x55c8b58c7e881033d7d18c46,
                    limb1: 0x2abd5a71dba59ed4e8118efc,
                    limb2: 0x66221b0ad8897632,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4b9fe27a48ba9caabf25255f,
                    limb1: 0x28cab1c053262072b3c6687a,
                    limb2: 0x76a54b1d72d438de,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xe707885fa9fb4c76981e7d50,
            limb1: 0xc3c8189bb49e7d148fa20e44,
            limb2: 0x398d2b10b854b016,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xdd0e8b93b1f5e3fc5ee3924,
                    limb1: 0x38aa250c72581dc2801af6f9,
                    limb2: 0x61d6c7b176e81291,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x90c01c9a9b81ba03694cb1ff,
                    limb1: 0x45c295e032f3c9f5b64e80c7,
                    limb2: 0x607cec839cfa80ab,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_X25519_7_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xef9f4608e5f13ca874eaba41,
                    limb1: 0x27dbaef206fb39160090ad32,
                    limb2: 0x66b61f4ebeab4f03,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf85083278c0796b2f9828f2a,
                    limb1: 0x8c9b3807cfd2afb30a485e88,
                    limb2: 0x464792ab4d546f5c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xef9f4608e5f13ca874eaba41,
                    limb1: 0x27dbaef206fb39160090ad32,
                    limb2: 0x66b61f4ebeab4f03,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf85083278c0796b2f9828f2a,
                    limb1: 0x8c9b3807cfd2afb30a485e88,
                    limb2: 0x464792ab4d546f5c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xef9f4608e5f13ca874eaba41,
                    limb1: 0x27dbaef206fb39160090ad32,
                    limb2: 0x66b61f4ebeab4f03,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf85083278c0796b2f9828f2a,
                    limb1: 0x8c9b3807cfd2afb30a485e88,
                    limb2: 0x464792ab4d546f5c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xef9f4608e5f13ca874eaba41,
                    limb1: 0x27dbaef206fb39160090ad32,
                    limb2: 0x66b61f4ebeab4f03,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf85083278c0796b2f9828f2a,
                    limb1: 0x8c9b3807cfd2afb30a485e88,
                    limb2: 0x464792ab4d546f5c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xef9f4608e5f13ca874eaba41,
                    limb1: 0x27dbaef206fb39160090ad32,
                    limb2: 0x66b61f4ebeab4f03,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf85083278c0796b2f9828f2a,
                    limb1: 0x8c9b3807cfd2afb30a485e88,
                    limb2: 0x464792ab4d546f5c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xef9f4608e5f13ca874eaba41,
                    limb1: 0x27dbaef206fb39160090ad32,
                    limb2: 0x66b61f4ebeab4f03,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf85083278c0796b2f9828f2a,
                    limb1: 0x8c9b3807cfd2afb30a485e88,
                    limb2: 0x464792ab4d546f5c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xef9f4608e5f13ca874eaba41,
                    limb1: 0x27dbaef206fb39160090ad32,
                    limb2: 0x66b61f4ebeab4f03,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf85083278c0796b2f9828f2a,
                    limb1: 0x8c9b3807cfd2afb30a485e88,
                    limb2: 0x464792ab4d546f5c,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xec2b5e213f7a38e0b6118bd6553a773a, high: 0x6eee6ee829fe7ba5d30db822348e1b7
            },
            u256 {
                low: 0x213a6ad812b34a24667fceeb8889832c, high: 0xb380e84a89f591690ec83746862dc24
            },
            u256 {
                low: 0xe54ce0de6e797a9218b7f1a2f74f1905, high: 0xc375f47789c3c723ee29e686fa00319
            },
            u256 {
                low: 0x9c684df10a515e8746ba68553cad275a, high: 0xc813be6cc4e66dade0989b952526d45
            },
            u256 {
                low: 0x88d3281a1b4e1428a0483bb2f6d080c4, high: 0x49d587e0c78c2f9da418b24e0acf9ff
            },
            u256 {
                low: 0x1ad566c3ecb03f486ed63ea464a2bc48, high: 0xec89a309aabd22d75ef8aabb693f4ef
            },
            u256 {
                low: 0xc30759a448a133abdd55daaffefc5b4a, high: 0xbc8f854eef671391ccdd34080e97f74
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xf8fa4f18ed0be1ae0e9c6e7b,
                limb1: 0xf69d8e31ad133954a39e9ebf,
                limb2: 0x9480878755a0535,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xdd7f16f7a831fcb94f4af738,
                limb1: 0x9b15e4f4df9b111a49b09c46,
                limb2: 0x47cae48a12fd2e4c,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x2c1ed75eff21be0391860f20,
                limb1: 0x104fde66be80e58cb012a0f9,
                limb2: 0x2b15eab3bb7427e6,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x361f939d34ef68c19eaab183,
                limb1: 0x40875718a494250ce37f3ea6,
                limb2: 0x2bd805f0991ee4be,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x2f8130388eecf93e8ad8b22b,
                limb1: 0xb44e1facce6264a91cd9a4b9,
                limb2: 0x1efd63355a5a4174,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x38f135109990678a77fbacf3,
                limb1: 0x170fc03b11654876910a06cb,
                limb2: 0x144dfc59420fd1fc,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x6c0caf679d39abec35c29fb1,
                    limb1: 0x67e6b9b6cea05142ccde9f29,
                    limb2: 0x66555a809b8f34b8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6bd4da242319e141798992c3,
                    limb1: 0xfffffffffffffffee2ae0b4b,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xa3877e4bb90967931bbdac4b,
                    limb1: 0xccb2421938d24d2619e8b079,
                    limb2: 0x3083ca3e5c885da5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x17666ade2d02e1a97c78d731,
                    limb1: 0xe186c2dc4bf18d955bd0b40d,
                    limb2: 0x1001d838cbfaabc6,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x9e645d09173aece47088fd4f,
                    limb1: 0x6ff4bf388ee7849e663137f9,
                    limb2: 0xdee9cdd80a64a80,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x13cdaf0c59bcc42fb68580d5,
                    limb1: 0x71954fa97bed3512ac4db315,
                    limb2: 0x3f68ba9dfaaee497,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe90ffc0fcb36f20a195f99e1,
                    limb1: 0x301379ae555453a4e62014e2,
                    limb2: 0x6aca5107bf2ece23,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x7e4f217c29ba8bf7e48b96c,
                    limb1: 0x40334bcbe5d1baa32f3976ff,
                    limb2: 0x51094a0008e8d623,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x32667d7e907443e073390243,
                    limb1: 0x1f27089c21cae3d9907c0b6c,
                    limb2: 0x3afc5eb9f6ddecfa,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xaa143c1294b9a47fb6d9a454,
                    limb1: 0xc769e01e6767f89e99c43c62,
                    limb2: 0x11a6e527d8af134,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4e3228f663b4122b64d24d8f,
                    limb1: 0x775cecc3e37cf7d0c4935b24,
                    limb2: 0x5b2e74e907330850,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x17666ade2d02e1a97c78d731,
                    limb1: 0xe186c2dc4bf18d955bd0b40d,
                    limb2: 0x1001d838cbfaabc6,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xd5edd22c6628b23861f8ca49,
                    limb1: 0xa8dc75a52119173c69ec342f,
                    limb2: 0x115d1b9210acf9ac,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x389c316d87be0436740bd203, limb1: 0x205a44aa, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xa69ab3801a9a188857b9f60,
                    limb1: 0xfb0e73e5e56a1c61af99c87c,
                    limb2: 0x39aeae829582c0ce,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe441e2981aed0553f98f3679,
                    limb1: 0xc7d472a73a83e15d4f5cb1d3,
                    limb2: 0x6e33f5fd85e08916,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x99abb5ba7b4448c67303f072,
                    limb1: 0x3575a2b79391822257e329d3,
                    limb2: 0x7ff7116d0dd4b794,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4e844a945abc521dfc3d43f9,
                    limb1: 0xa3a51e1b94438f8d409814bc,
                    limb2: 0x7f8414622d2a3c41,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x57387870a29d9d06abea3ed7,
                    limb1: 0xa4262d94c897eabbc10c9f43,
                    limb2: 0x1dfcbe1ac219c747,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x450bd4e09c7d99759115cf2c,
                    limb1: 0x7f156e7124ac32a724e0c947,
                    limb2: 0x1f579fba794b7888,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc500a61c1eb088a289b2f2d6,
                    limb1: 0x70cbeb15247866bac1172ad,
                    limb2: 0x21afb1c89df9c3d2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdd1059b7877fc1006785f2fb,
                    limb1: 0xb6be222881c7d2fc9aa0ceac,
                    limb2: 0x3dfebaee500e1cfa,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb51455e2ac544c20ce9040a4,
                    limb1: 0xa5b91e909014c70c5a447326,
                    limb2: 0x6459592d402d6b79,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe441e2981aed0553f98f3679,
                    limb1: 0xc7d472a73a83e15d4f5cb1d3,
                    limb2: 0x6e33f5fd85e08916,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x56005e84e08ee0c902c57dc6,
                    limb1: 0xd20ca6377d36c6e247b30dd2,
                    limb2: 0x676a2594f56b4f59,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24e7c4a265c,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xe572e56b4ad5715b42795af5,
                    limb1: 0x44ad8480bf9507b2205f3429,
                    limb2: 0x75dcbe9526365cfd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa45ff86871f148bde3a13ea2,
                    limb1: 0x3b6201ec731cb5ca3313ba4d,
                    limb2: 0x35ecb216ea3196a5,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x733a596422ca626c6eb822d8,
                    limb1: 0x85f21d389d1808d32402d0ba,
                    limb2: 0x21121660559ddb07,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdd10e4367a2485a35f7bead5,
                    limb1: 0xc8973221b8b5510dcf8f2fdd,
                    limb2: 0x6cea37dcb5934025,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1ae1c94ce090de20a5180420,
                    limb1: 0xd16ec97b361be0379ffbb48b,
                    limb2: 0x1906e6e3ad0d0483,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x51d1b0693a26b667f9fb0da2,
                    limb1: 0x208380c85d21a6ce900522a7,
                    limb2: 0x71152bed26a62798,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x46b7872a716a6e5c4349f355,
                    limb1: 0x48159dad2b35abac7fb18e6b,
                    limb2: 0x39d87c2aca08a4a5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x564c246fe0d71ba497b90379,
                    limb1: 0x6eafc7c26e83af5234df8090,
                    limb2: 0x33f1f1df00df95e1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x901d9015f5801bf38b8dfc4c,
                    limb1: 0xef582f2b6a3fb25ccb09ded4,
                    limb2: 0x2087693fd0e107a7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa45ff86871f148bde3a13ea2,
                    limb1: 0x3b6201ec731cb5ca3313ba4d,
                    limb2: 0x35ecb216ea3196a5,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xab8aee6b9b876304ad5374f5,
            limb1: 0xbecc023b244d25f85a6225fa,
            limb2: 0x14596e35b90cca72,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x2d92e7b26dedc66ea38832c5,
                limb1: 0x2545d871d8079ca1065e81f8,
                limb2: 0x1e4443e382579fe1,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x67f76a7013b5d03a271b652d,
                    limb1: 0xf0d14c8a9695590d43f97772,
                    limb2: 0x261580c05d579b04,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xa4fd68515166631dc3957c0c,
                    limb1: 0x1178dbbaacb0d77bbf83ae0c,
                    limb2: 0x7575cc7321272c62,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_X25519_8_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x5855f692a084b1394341e00c,
                    limb1: 0xd1ffa4831a9c9454a3526e7f,
                    limb2: 0x592db0455363cacb,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb6ccb683acecf6f4c8d6f1c9,
                    limb1: 0xd97061adfb840a267f7a92fe,
                    limb2: 0x354ef17d09a4344d,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5855f692a084b1394341e00c,
                    limb1: 0xd1ffa4831a9c9454a3526e7f,
                    limb2: 0x592db0455363cacb,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb6ccb683acecf6f4c8d6f1c9,
                    limb1: 0xd97061adfb840a267f7a92fe,
                    limb2: 0x354ef17d09a4344d,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5855f692a084b1394341e00c,
                    limb1: 0xd1ffa4831a9c9454a3526e7f,
                    limb2: 0x592db0455363cacb,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb6ccb683acecf6f4c8d6f1c9,
                    limb1: 0xd97061adfb840a267f7a92fe,
                    limb2: 0x354ef17d09a4344d,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5855f692a084b1394341e00c,
                    limb1: 0xd1ffa4831a9c9454a3526e7f,
                    limb2: 0x592db0455363cacb,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb6ccb683acecf6f4c8d6f1c9,
                    limb1: 0xd97061adfb840a267f7a92fe,
                    limb2: 0x354ef17d09a4344d,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5855f692a084b1394341e00c,
                    limb1: 0xd1ffa4831a9c9454a3526e7f,
                    limb2: 0x592db0455363cacb,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb6ccb683acecf6f4c8d6f1c9,
                    limb1: 0xd97061adfb840a267f7a92fe,
                    limb2: 0x354ef17d09a4344d,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5855f692a084b1394341e00c,
                    limb1: 0xd1ffa4831a9c9454a3526e7f,
                    limb2: 0x592db0455363cacb,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb6ccb683acecf6f4c8d6f1c9,
                    limb1: 0xd97061adfb840a267f7a92fe,
                    limb2: 0x354ef17d09a4344d,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5855f692a084b1394341e00c,
                    limb1: 0xd1ffa4831a9c9454a3526e7f,
                    limb2: 0x592db0455363cacb,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb6ccb683acecf6f4c8d6f1c9,
                    limb1: 0xd97061adfb840a267f7a92fe,
                    limb2: 0x354ef17d09a4344d,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5855f692a084b1394341e00c,
                    limb1: 0xd1ffa4831a9c9454a3526e7f,
                    limb2: 0x592db0455363cacb,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb6ccb683acecf6f4c8d6f1c9,
                    limb1: 0xd97061adfb840a267f7a92fe,
                    limb2: 0x354ef17d09a4344d,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x1c3c8d3521d4fb7e22587c8958ccf9b4, high: 0xffcd492a6f1e475b61f92b9cf600ec
            },
            u256 {
                low: 0x6ce8d7dcc71d92d613ec5718ae4a741a, high: 0x46cf5b38dcd7d64b9e8e4ee8b7f6d7a
            },
            u256 {
                low: 0x2a1ace85351c5aac2728ec952b52dab1, high: 0x45679c6867a4ac9079be4e53a6e8f12
            },
            u256 {
                low: 0xe65d1c735b62a7c97e3801afd1a8d7b0, high: 0x9379e95bc6284a89f93e802e1c25cd1
            },
            u256 {
                low: 0xc5fee48768ab9281d68d2bc2dac7c336, high: 0x510f475e63317c3430342c7dcfbde0a
            },
            u256 {
                low: 0xf7f1bb2780665563a0c30ce957ac59f2, high: 0x4a06747b1f5d7d0887b4cca54f02dc4
            },
            u256 {
                low: 0xbd637b3afc0b1519604aa4a2e983cc1d, high: 0x781529b4e245cf78e33dcabbe684e2b
            },
            u256 {
                low: 0x60e9bd79fe1c51e5ea31e67ae1680205, high: 0xf14abadf2ded00f63e8695158b5f052
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xfc4a30128b39e0138ac77da1,
                limb1: 0xf39ea82dbf9b79f5747d3bd,
                limb2: 0x73cf1946052bed7b,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xe60f095a5f32e69d21fa1480,
                limb1: 0x74260d82a34691ea9c32d1dd,
                limb2: 0x54033306c55d1456,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x54e38be76e7e922f4f55d772,
                limb1: 0xac75da328006bcfe78b4c60,
                limb2: 0x3f14fc7819cf328e,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x53abe79a626567a5c2424d2d,
                limb1: 0x2382d8156a7618fd1128ddcf,
                limb2: 0x4cf9b51f42edaf46,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x5112b55dc778db8b50ac8dfe,
                limb1: 0x8c5e137851922a902973174d,
                limb2: 0x5a454f3a729f260,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xeed53c6919eae32ef3d8664,
                limb1: 0x70a4a044ad71a5070da110b,
                limb2: 0x422993df7f608888,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x8fd54079dd5060e0a4dfdc4d,
                    limb1: 0xe5bc0840553f24a625ba9820,
                    limb2: 0x41cbee7da88b1de6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x23ba7a718569dc6e982c402f,
                    limb1: 0xfffffffffffffffe6bc743ca,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x1bc61d28c2674febd7e3693d,
                    limb1: 0xf6e97569ff0335e4d5a6e3ba,
                    limb2: 0x74b944220c0168b8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xab5fd95ad4416eb331f6a22d,
                    limb1: 0x1ec670fa0969b40c0565bdc2,
                    limb2: 0x33033674a77047b9,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x2d997c40e858fda95641cfaf,
                    limb1: 0x30626c690ac75bc39fde05a4,
                    limb2: 0x192ee65bbfef8b2b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd70bd6b9ed2980ce2f2ff33,
                    limb1: 0xd93ab28002138ef41d8aa759,
                    limb2: 0xe50b3712875e70f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8f519e5394a1b812cfa5e68e,
                    limb1: 0x3a6a82e5d45b6be2ae0c79f9,
                    limb2: 0x606cdc0e95cc1bac,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xb9ed2284b43476578ea37d74,
                    limb1: 0xe8447b1d1186dc008784475a,
                    limb2: 0x4252b6522cc4fb1b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7ab38cc62dab2eea8d734f3a,
                    limb1: 0xee4a95b8cd3e1debf7b5472d,
                    limb2: 0x51e752f5a676354f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7b86a9d85e429d6bbb54fae2,
                    limb1: 0x36aa0ff2cae923e5fc578c68,
                    limb2: 0x1fc76a61f8d92685,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc670c7d36d11fa8420f80a94,
                    limb1: 0xa1942014a9ade08f80518e64,
                    limb2: 0x1f63eeccb6ac1363,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xab5fd95ad4416eb331f6a22d,
                    limb1: 0x1ec670fa0969b40c0565bdc2,
                    limb2: 0x33033674a77047b9,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xca3c10b8f84add5414b94d1b,
                    limb1: 0x923884fd5c1112e76c7e2519,
                    limb2: 0x7934ba40aa73afa6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3f797442613616adbcbee447,
                    limb1: 0x6612dd2,
                    limb2: 0x4000000000000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x5e577f5a4c3846b2568b99ee,
                    limb1: 0x5282b1dc18c323ba4bfd6733,
                    limb2: 0x696dbb3171658950,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x52c67d85f0fcbc976d68485c,
                    limb1: 0x2338fdd9bd62ffdb75224520,
                    limb2: 0x67bd534292cd02a6,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x4c655c618c262535f80d5a95,
                    limb1: 0xa57afc3c9202af3fd9671124,
                    limb2: 0x4e665017470a55ae,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5c3bf2b3accd18a47dc0c5ab,
                    limb1: 0x1c3595056a80119b288f3467,
                    limb2: 0x282c831efecfa337,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9ae446335ae163c77bb03468,
                    limb1: 0x510574ab96ca8c5f78b4cc99,
                    limb2: 0x316e006e5f9c7fb2,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x7e461f5599ba8cc705d61ec0,
                    limb1: 0x9eee5b29dcd20e010c663856,
                    limb2: 0x2d30340afd93d75d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf03c6e81a505320053cfa042,
                    limb1: 0xecb007d10e3ebf704d8f8fb6,
                    limb2: 0x4e2e8a3e603f4833,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xaa7ac14d5720b35aa7ced09d,
                    limb1: 0x8d799c0f184be591bd1e213c,
                    limb2: 0x4a0ad1207f6e8ff2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9022a04f6e2f14a9fa03b45,
                    limb1: 0xfd2d5c86c36dce64f6a811de,
                    limb2: 0x141865dc1c1033fa,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x52c67d85f0fcbc976d68485c,
                    limb1: 0x2338fdd9bd62ffdb75224520,
                    limb2: 0x67bd534292cd02a6,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xa9b278ab0a5f6253766f2102,
                    limb1: 0x3435f927044d180b00269cf8,
                    limb2: 0x5a255902c015d1ab,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24e7c4a265c,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x4c0b8df199827eb8577e8021,
                    limb1: 0x6bd5ae0543e02916aaf88947,
                    limb2: 0x198db10a4214c856,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5a09bebaca0892455ffd9a7d,
                    limb1: 0x68da8ee4866d699fef019c52,
                    limb2: 0x3b46ae943f06db11,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x3c81bc1310315f91c4d00fd0,
                    limb1: 0x72b1f4748726028e92d863bf,
                    limb2: 0x20f6320050cedb56,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7dec1c1e4f634f458abadc95,
                    limb1: 0xadf250a6ef91c61f16f697f9,
                    limb2: 0x68402019434bc9e4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc8b9cf59ec85ac0e55006c1e,
                    limb1: 0x2e9510c96d280ed2464f01ff,
                    limb2: 0x4d40d04c5c367654,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xe58a13c98e622b490f95aca1,
                    limb1: 0xc1815782c6392a302a736fd9,
                    limb2: 0x2f7ca43e7cbda2cb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8f76f994ba10dc6adcf6463b,
                    limb1: 0x23abbcc27c3124bb04e0e2d1,
                    limb2: 0x6e1ac7b815efab04,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x68d757a7bf285a93cfccf302,
                    limb1: 0x2104789b6bfd05ee228c3c53,
                    limb2: 0x4ba18890f8ca7815,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf6b6389c442d2950a0932165,
                    limb1: 0x168058afee8ad3c155a333f1,
                    limb2: 0x44385bb4ecbf7301,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5a09bebaca0892455ffd9a7d,
                    limb1: 0x68da8ee4866d699fef019c52,
                    limb2: 0x3b46ae943f06db11,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x87bd874286a218df13d5f5b0,
            limb1: 0x985751c31ce34d9059a63b0b,
            limb2: 0x25d8377a75e158b2,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0xfe32aba2e0c88de74c68b14f,
                limb1: 0x824813427548b8231237aa91,
                limb2: 0x2eb8f2c63eddfbf,
                limb3: 0x0
            },
            u384 {
                limb0: 0xd776e0a5a18bc58f564c10de,
                limb1: 0xc7621e0ceb1b009377e6fd83,
                limb2: 0x250b9453983b5233,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x792fab4a72ae9070ab93a0b2,
                    limb1: 0x63b34ac56d7f1bf49e8907ef,
                    limb2: 0x391c85ea44fbc118,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x48e3d01ba782b5dc47fd5328,
                    limb1: 0xe7288d42488767696d59de5f,
                    limb2: 0x2759ef0fd5f0a757,
                    limb3: 0x0
                }
            }
        );
    }
}
